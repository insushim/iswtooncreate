const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-BagJdWa8.js","assets/ui-D_LkVF2r.js","assets/vendor-Vqvh67Lm.js","assets/Button-C3O7gUUW.js","assets/storage-BBQgdv-R.js","assets/DashboardPage-D28ZiuiF.js","assets/Badge-BSkIqIZk.js","assets/CreateProjectPage-DUsPC0Sf.js","assets/Dropdown-DWn6fHsO.js","assets/Slider-B58Hgk20.js","assets/GeminiService-IDDSi9dA.js","assets/ai-BpRkNtKl.js","assets/EditorPage-DZ593o9i.js","assets/PreviewPage-jGhxm1vT.js","assets/SettingsPage-Cehe4DIQ.js"])))=>i.map(i=>d[i]);
var De=Object.defineProperty;var Ee=(e,t,r)=>t in e?De(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var D=(e,t,r)=>Ee(e,typeof t!="symbol"?t+"":t,r);import{j as l,m as ke,A as ze}from"./ui-D_LkVF2r.js";import{a as Re,r as w,B as Le,R as Te,b as P,N as Me,d as k}from"./vendor-Vqvh67Lm.js";import{D as Fe}from"./storage-BBQgdv-R.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var Y={},de=Re;Y.createRoot=de.createRoot,Y.hydrateRoot=de.hydrateRoot;const Ue="modulepreload",Ge=function(e){return"/iswtooncreate/"+e},ue={},A=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=Ge(c),c in ue)return;ue[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":Ue,d||(p.as="script"),p.crossOrigin="",p.href=c,a&&p.setAttribute("nonce",a),document.head.appendChild(p),d)return new Promise((y,_)=>{p.addEventListener("load",y),p.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return s.then(i=>{for(const a of i||[])a.status==="rejected"&&o(a.reason);return t().catch(o)})},He=({message:e,type:t="info",duration:r=3e3,onClose:n})=>{w.useEffect(()=>{const i=setTimeout(n,r);return()=>clearTimeout(i)},[r,n]);const s={success:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),error:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),warning:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),info:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},o={success:"bg-green-500/20 border-green-500/50 text-green-400",error:"bg-red-500/20 border-red-500/50 text-red-400",warning:"bg-yellow-500/20 border-yellow-500/50 text-yellow-400",info:"bg-blue-500/20 border-blue-500/50 text-blue-400"};return l.jsxs(ke.div,{initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.9},className:`
        fixed bottom-4 right-4 z-50
        flex items-center gap-3 px-4 py-3
        rounded-lg border backdrop-blur-sm
        ${o[t]}
      `,children:[l.jsx("span",{className:"flex-shrink-0",children:s[t]}),l.jsx("span",{className:"text-sm font-medium",children:e}),l.jsx("button",{onClick:n,className:"flex-shrink-0 p-1 rounded hover:bg-white/10 transition-colors",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},$e=({size:e="md",color:t="primary",className:r=""})=>{const n={sm:"w-4 h-4 border-2",md:"w-8 h-8 border-2",lg:"w-12 h-12 border-3"},s={primary:"border-purple-500 border-t-transparent",white:"border-white border-t-transparent",gray:"border-gray-400 border-t-transparent"};return l.jsx("div",{className:`
        ${n[e]}
        ${s[t]}
        rounded-full animate-spin
        ${r}
      `,role:"status","aria-label":"Loading"})},Be=w.forwardRef(({label:e,error:t,helperText:r,icon:n,iconPosition:s="left",className:o="",...i},a)=>l.jsxs("div",{className:"w-full",children:[e&&l.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:e}),l.jsxs("div",{className:"relative",children:[n&&s==="left"&&l.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:n}),l.jsx("input",{ref:a,className:`
              w-full px-4 py-2.5 rounded-lg
              bg-gray-700 border border-gray-600
              text-white placeholder-gray-400
              transition-all duration-200
              focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500
              disabled:opacity-50 disabled:cursor-not-allowed
              ${n&&s==="left"?"pl-10":""}
              ${n&&s==="right"?"pr-10":""}
              ${t?"border-red-500 focus:ring-red-500 focus:border-red-500":""}
              ${o}
            `,...i}),n&&s==="right"&&l.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:n})]}),t&&l.jsx("p",{className:"mt-1 text-sm text-red-400",children:t}),r&&!t&&l.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]}));Be.displayName="Input";const We=w.forwardRef(({label:e,error:t,helperText:r,showCount:n=!1,maxLength:s,className:o="",value:i,...a},c)=>{const d=i?String(i).length:0;return l.jsxs("div",{className:"w-full",children:[e&&l.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:e}),l.jsx("div",{className:"relative",children:l.jsx("textarea",{ref:c,value:i,maxLength:s,className:`
              w-full px-4 py-3 rounded-lg
              bg-gray-700 border border-gray-600
              text-white placeholder-gray-400
              transition-all duration-200
              focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500
              disabled:opacity-50 disabled:cursor-not-allowed
              resize-none
              ${t?"border-red-500 focus:ring-red-500 focus:border-red-500":""}
              ${o}
            `,...a})}),l.jsxs("div",{className:"flex justify-between mt-1",children:[l.jsxs("div",{children:[t&&l.jsx("p",{className:"text-sm text-red-400",children:t}),r&&!t&&l.jsx("p",{className:"text-sm text-gray-500",children:r})]}),n&&s&&l.jsxs("p",{className:`text-sm ${d>=s?"text-red-400":"text-gray-500"}`,children:[d,"/",s]})]})]})});We.displayName="TextArea";const qe=({toasts:e,onClose:t})=>l.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2",children:l.jsx(ze,{children:e.map(r=>l.jsx(He,{message:r.message,type:r.type,onClose:()=>t(r.id)},r.id))})}),Ke=w.lazy(()=>A(()=>import("./HomePage-BagJdWa8.js"),__vite__mapDeps([0,1,2,3,4]))),Je=w.lazy(()=>A(()=>import("./DashboardPage-D28ZiuiF.js"),__vite__mapDeps([5,1,2,6,3,4]))),Xe=w.lazy(()=>A(()=>import("./CreateProjectPage-DUsPC0Sf.js"),__vite__mapDeps([7,1,2,8,9,3,10,11,4,6]))),Ze=w.lazy(()=>A(()=>import("./EditorPage-DZ593o9i.js"),__vite__mapDeps([12,1,2,3,8,10,11,4]))),fe=w.lazy(()=>A(()=>import("./PreviewPage-jGhxm1vT.js"),__vite__mapDeps([13,1,2,3,4]))),Qe=w.lazy(()=>A(()=>import("./SettingsPage-Cehe4DIQ.js"),__vite__mapDeps([14,1,2,3,9,10,11,4]))),Ye=()=>l.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:l.jsx($e,{size:"lg"})}),Ve=()=>l.jsx(Le,{basename:"/iswtooncreate",children:l.jsx(w.Suspense,{fallback:l.jsx(Ye,{}),children:l.jsxs(Te,{children:[l.jsx(P,{path:"/",element:l.jsx(Ke,{})}),l.jsx(P,{path:"/dashboard",element:l.jsx(Je,{})}),l.jsx(P,{path:"/create",element:l.jsx(Xe,{})}),l.jsx(P,{path:"/editor/:projectId",element:l.jsx(Ze,{})}),l.jsx(P,{path:"/preview/:projectId",element:l.jsx(fe,{})}),l.jsx(P,{path:"/preview/:projectId/:episodeId",element:l.jsx(fe,{})}),l.jsx(P,{path:"/settings",element:l.jsx(Qe,{})}),l.jsx(P,{path:"*",element:l.jsx(Me,{to:"/",replace:!0})})]})})}),pe=e=>{let t;const r=new Set,n=(d,f)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const y=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(_=>_(t,y))}},s=()=>t,a={setState:n,getState:s,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=t=e(n,s,a);return a},et=e=>e?pe(e):pe,tt=e=>e;function rt(e,t=tt){const r=k.useSyncExternalStore(e.subscribe,k.useCallback(()=>t(e.getState()),[e,t]),k.useCallback(()=>t(e.getInitialState()),[e,t]));return k.useDebugValue(r),r}const me=e=>{const t=et(e),r=n=>rt(t,n);return Object.assign(r,t),r},ie=e=>e?me(e):me;function nt(e,t){let r;try{r=e()}catch{return}return{getItem:s=>{var o;const i=c=>c===null?null:JSON.parse(c,void 0),a=(o=r.getItem(s))!=null?o:null;return a instanceof Promise?a.then(i):i(a)},setItem:(s,o)=>r.setItem(s,JSON.stringify(o,void 0)),removeItem:s=>r.removeItem(s)}}const V=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return V(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return V(n)(r)}}}},st=(e,t)=>(r,n,s)=>{let o={storage:nt(()=>localStorage),partialize:u=>u,version:0,merge:(u,x)=>({...x,...u}),...t},i=!1;const a=new Set,c=new Set;let d=o.storage;if(!d)return e((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),r(...u)},n,s);const f=()=>{const u=o.partialize({...n()});return d.setItem(o.name,{state:u,version:o.version})},p=s.setState;s.setState=(u,x)=>(p(u,x),f());const y=e((...u)=>(r(...u),f()),n,s);s.getInitialState=()=>y;let _;const M=()=>{var u,x;if(!d)return;i=!1,a.forEach(g=>{var S;return g((S=n())!=null?S:y)});const O=((x=o.onRehydrateStorage)==null?void 0:x.call(o,(u=n())!=null?u:y))||void 0;return V(d.getItem.bind(d))(o.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==o.version){if(o.migrate){const S=o.migrate(g.state,g.version);return S instanceof Promise?S.then(J=>[!0,J]):[!0,S]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var S;const[J,Ae]=g;if(_=o.merge(Ae,(S=n())!=null?S:y),r(_,!0),J)return f()}).then(()=>{O==null||O(_,void 0),_=n(),i=!0,c.forEach(g=>g(_))}).catch(g=>{O==null||O(void 0,g)})};return s.persist={setOptions:u=>{o={...o,...u},u.storage&&(d=u.storage)},clearStorage:()=>{d==null||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>M(),hasHydrated:()=>i,onHydrate:u=>(a.add(u),()=>{a.delete(u)}),onFinishHydration:u=>(c.add(u),()=>{c.delete(u)})},o.skipHydration||M(),_||y},Se=st;var Pe=Symbol.for("immer-nothing"),he=Symbol.for("immer-draftable"),j=Symbol.for("immer-state");function b(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var z=Object.getPrototypeOf;function N(e){return!!e&&!!e[j]}function I(e){var t;return e?ve(e)||Array.isArray(e)||!!e[he]||!!((t=e.constructor)!=null&&t[he])||T(e)||q(e):!1}var ot=Object.prototype.constructor.toString(),ye=new WeakMap;function ve(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=ye.get(r);return n===void 0&&(n=Function.toString.call(r),ye.set(r,n)),n===ot}function H(e,t,r=!0){W(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(s=>{t(s,e[s],e)}):e.forEach((n,s)=>t(s,n,e))}function W(e){const t=e[j];return t?t.type_:Array.isArray(e)?1:T(e)?2:q(e)?3:0}function ee(e,t){return W(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ie(e,t,r){const n=W(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function it(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function T(e){return e instanceof Map}function q(e){return e instanceof Set}function v(e){return e.copy_||e.base_}function te(e,t){if(T(e))return new Map(e);if(q(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=ve(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[j];let s=Reflect.ownKeys(n);for(let o=0;o<s.length;o++){const i=s[o],a=n[i];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(z(e),n)}else{const n=z(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function ae(e,t=!1){return K(e)||N(e)||!I(e)||(W(e)>1&&Object.defineProperties(e,{set:F,add:F,clear:F,delete:F}),Object.freeze(e),t&&Object.values(e).forEach(r=>ae(r,!0))),e}function at(){b(2)}var F={value:at};function K(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var ct={};function C(e){const t=ct[e];return t||b(0,e),t}var R;function Ce(){return R}function lt(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function ge(e,t){t&&(C("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function re(e){ne(e),e.drafts_.forEach(dt),e.drafts_=null}function ne(e){e===R&&(R=e.parent_)}function _e(e){return R=lt(R,e)}function dt(e){const t=e[j];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function je(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[j].modified_&&(re(t),b(4)),I(e)&&(e=$(t,e),t.parent_||B(t,e)),t.patches_&&C("Patches").generateReplacementPatches_(r[j].base_,e,t.patches_,t.inversePatches_)):e=$(t,r,[]),re(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Pe?e:void 0}function $(e,t,r){if(K(t))return t;const n=e.immer_.shouldUseStrictIteration(),s=t[j];if(!s)return H(t,(o,i)=>be(e,s,t,o,i,r),n),t;if(s.scope_!==e)return t;if(!s.modified_)return B(e,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const o=s.copy_;let i=o,a=!1;s.type_===3&&(i=new Set(o),o.clear(),a=!0),H(i,(c,d)=>be(e,s,o,c,d,r,a),n),B(e,o,!1),r&&e.patches_&&C("Patches").generatePatches_(s,r,e.patches_,e.inversePatches_)}return s.copy_}function be(e,t,r,n,s,o,i){if(s==null||typeof s!="object"&&!i)return;const a=K(s);if(!(a&&!i)){if(N(s)){const c=o&&t&&t.type_!==3&&!ee(t.assigned_,n)?o.concat(n):void 0,d=$(e,s,c);if(Ie(r,n,d),N(d))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(I(s)&&!a){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===s&&a)return;$(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(T(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&B(e,s)}}}function B(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ae(t,r)}function ut(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Ce(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,o=ce;r&&(s=[n],o=L);const{revoke:i,proxy:a}=Proxy.revocable(s,o);return n.draft_=a,n.revoke_=i,a}var ce={get(e,t){if(t===j)return e;const r=v(e);if(!ee(r,t))return ft(e,r,t);const n=r[t];return e.finalized_||!I(n)?n:n===X(e.base_,t)?(Z(e),e.copy_[t]=oe(n,e)):n},has(e,t){return t in v(e)},ownKeys(e){return Reflect.ownKeys(v(e))},set(e,t,r){const n=Oe(v(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=X(v(e),t),o=s==null?void 0:s[j];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(it(r,s)&&(r!==void 0||ee(e.base_,t)))return!0;Z(e),se(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return X(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Z(e),se(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=v(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){b(11)},getPrototypeOf(e){return z(e.base_)},setPrototypeOf(){b(12)}},L={};H(ce,(e,t)=>{L[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});L.deleteProperty=function(e,t){return L.set.call(this,e,t,void 0)};L.set=function(e,t,r){return ce.set.call(this,e[0],t,r,e[0])};function X(e,t){const r=e[j];return(r?v(r):e)[t]}function ft(e,t,r){var s;const n=Oe(t,r);return n?"value"in n?n.value:(s=n.get)==null?void 0:s.call(e.draft_):void 0}function Oe(e,t){if(!(t in e))return;let r=z(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=z(r)}}function se(e){e.modified_||(e.modified_=!0,e.parent_&&se(e.parent_))}function Z(e){e.copy_||(e.copy_=te(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var pt=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const o=r;r=t;const i=this;return function(c=o,...d){return i.produce(c,f=>r.call(this,f,...d))}}typeof r!="function"&&b(6),n!==void 0&&typeof n!="function"&&b(7);let s;if(I(t)){const o=_e(this),i=oe(t,void 0);let a=!0;try{s=r(i),a=!1}finally{a?re(o):ne(o)}return ge(o,n),je(s,o)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===Pe&&(s=void 0),this.autoFreeze_&&ae(s,!0),n){const o=[],i=[];C("Patches").generateReplacementPatches_(t,s,o,i),n(o,i)}return s}else b(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...a)=>this.produceWithPatches(i,c=>t(c,...a));let n,s;return[this.produce(t,r,(i,a)=>{n=i,s=a}),n,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){I(e)||b(8),N(e)&&(e=mt(e));const t=_e(this),r=oe(e,void 0);return r[j].isManual_=!0,ne(t),r}finishDraft(e,t){const r=e&&e[j];(!r||!r.isManual_)&&b(9);const{scope_:n}=r;return ge(n,t),je(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=C("Patches").applyPatches_;return N(e)?n(e,t):this.produce(e,s=>n(s,t))}};function oe(e,t){const r=T(e)?C("MapSet").proxyMap_(e,t):q(e)?C("MapSet").proxySet_(e,t):ut(e,t);return(t?t.scope_:Ce()).drafts_.push(r),r}function mt(e){return N(e)||b(10,e),Ne(e)}function Ne(e){if(!I(e)||K(e))return e;const t=e[j];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=te(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=te(e,!0);return H(r,(s,o)=>{Ie(r,s,Ne(o))},n),t&&(t.finalized_=!1),r}var ht=new pt,yt=ht.produce;const gt=e=>(t,r,n)=>(n.setState=(s,o,...i)=>{const a=typeof s=="function"?yt(s):s;return t(a,o,...i)},e(n.setState,r,n)),le=gt;class _t extends Fe{constructor(){super("WebtoonForgeDB");D(this,"projects");D(this,"characters");D(this,"episodes");D(this,"panels");this.version(1).stores({projects:"id, title, status, genre, createdAt, updatedAt",characters:"id, projectId, name, role, createdAt",episodes:"id, projectId, episodeNumber, status, createdAt",panels:"id, episodeId, panelNumber, status"})}}const m=new _t;var h=[];for(var Q=0;Q<256;++Q)h.push((Q+256).toString(16).slice(1));function jt(e,t=0){return(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase()}var U,bt=new Uint8Array(16);function xt(){if(!U&&(U=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!U))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(bt)}var wt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const xe={randomUUID:wt};function G(e,t,r){if(xe.randomUUID&&!e)return xe.randomUUID();e=e||{};var n=e.random||(e.rng||xt)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,jt(n)}const Nt=ie()(Se(le((e,t)=>({projects:[],currentProject:null,isLoading:!1,error:null,loadProjects:async()=>{e(r=>{r.isLoading=!0,r.error=null});try{const r=await m.projects.toArray();e(n=>{n.projects=r.sort((s,o)=>new Date(o.updatedAt).getTime()-new Date(s.updatedAt).getTime()),n.isLoading=!1})}catch{e(n=>{n.error="프로젝트 로딩 실패",n.isLoading=!1})}},createProject:async r=>{const n=new Date,s={id:G(),title:r.title,genre:r.genre,subGenres:[],targetAudience:r.targetAudience,mood:r.mood,briefConcept:r.briefConcept,artStyle:r.artStyle,episodeCount:r.episodeCount,status:"draft",characters:[],episodes:[],styleGuide:{colorPalette:[],lineWeight:"medium",shadingStyle:"cel",characterProportions:"semi-realistic",backgroundDetail:"moderate",effectsStyle:"",anchorPrompt:""},costTracking:{totalAPIcalls:0,imageGenerations:0,textGenerations:0,cachedResults:0,estimatedCost:0,savingsFromCache:0},createdAt:n,updatedAt:n,version:1};return await m.projects.add(s),e(o=>{o.projects.unshift(s),o.currentProject=s}),s},updateProject:async(r,n)=>{const s=new Date;await m.projects.update(r,{...n,updatedAt:s}),e(o=>{var a;const i=o.projects.findIndex(c=>c.id===r);i!==-1&&Object.assign(o.projects[i],n,{updatedAt:s}),((a=o.currentProject)==null?void 0:a.id)===r&&Object.assign(o.currentProject,n,{updatedAt:s})})},deleteProject:async r=>{await m.projects.delete(r),await m.characters.where("projectId").equals(r).delete(),await m.episodes.where("projectId").equals(r).delete(),e(n=>{var s;n.projects=n.projects.filter(o=>o.id!==r),((s=n.currentProject)==null?void 0:s.id)===r&&(n.currentProject=null)})},setCurrentProject:async r=>{if(!r){e(s=>{s.currentProject=null});return}const n=await m.projects.get(r);if(n){const s=await m.characters.where("projectId").equals(r).toArray(),o=await m.episodes.where("projectId").equals(r).toArray();for(const i of o){const a=await m.panels.where("episodeId").equals(i.id).toArray();i.panels=a.sort((c,d)=>c.panelNumber-d.panelNumber)}n.characters=s,n.episodes=o.sort((i,a)=>i.episodeNumber-a.episodeNumber),e(i=>{i.currentProject=n})}},updateProjectStatus:async(r,n)=>{await t().updateProject(r,{status:n})},addCharacter:async(r,n)=>{const s=new Date,o={...n,id:G(),projectId:r,createdAt:s,updatedAt:s};return await m.characters.add(o),e(i=>{var c;const a=i.projects.find(d=>d.id===r);a&&a.characters.push(o),((c=i.currentProject)==null?void 0:c.id)===r&&i.currentProject.characters.push(o)}),o},updateCharacter:async(r,n,s)=>{const o=new Date;await m.characters.update(n,{...s,updatedAt:o}),e(i=>{var d;const a=f=>{const p=f.characters.findIndex(y=>y.id===n);p!==-1&&Object.assign(f.characters[p],s,{updatedAt:o})},c=i.projects.find(f=>f.id===r);c&&a(c),((d=i.currentProject)==null?void 0:d.id)===r&&a(i.currentProject)})},deleteCharacter:async(r,n)=>{await m.characters.delete(n),e(s=>{var a;const o=c=>{c.characters=c.characters.filter(d=>d.id!==n)},i=s.projects.find(c=>c.id===r);i&&o(i),((a=s.currentProject)==null?void 0:a.id)===r&&o(s.currentProject)})},addEpisode:async(r,n)=>{const s=new Date,o={...n,id:G(),projectId:r,createdAt:s,updatedAt:s};return await m.episodes.add(o),e(i=>{var c;const a=i.projects.find(d=>d.id===r);a&&(a.episodes.push(o),a.episodes.sort((d,f)=>d.episodeNumber-f.episodeNumber)),((c=i.currentProject)==null?void 0:c.id)===r&&(i.currentProject.episodes.push(o),i.currentProject.episodes.sort((d,f)=>d.episodeNumber-f.episodeNumber))}),o},updateEpisode:async(r,n,s)=>{const o=new Date;await m.episodes.update(n,{...s,updatedAt:o}),e(i=>{var d;const a=f=>{const p=f.episodes.findIndex(y=>y.id===n);p!==-1&&Object.assign(f.episodes[p],s,{updatedAt:o})},c=i.projects.find(f=>f.id===r);c&&a(c),((d=i.currentProject)==null?void 0:d.id)===r&&a(i.currentProject)})},deleteEpisode:async(r,n)=>{await m.episodes.delete(n),await m.panels.where("episodeId").equals(n).delete(),e(s=>{var a;const o=c=>{c.episodes=c.episodes.filter(d=>d.id!==n)},i=s.projects.find(c=>c.id===r);i&&o(i),((a=s.currentProject)==null?void 0:a.id)===r&&o(s.currentProject)})},addPanel:async(r,n)=>{const s={...n,id:G()};return await m.panels.add(s),e(o=>{if(o.currentProject){const i=o.currentProject.episodes.find(a=>a.id===r);i&&(i.panels.push(s),i.panels.sort((a,c)=>a.panelNumber-c.panelNumber))}}),s},updatePanel:async(r,n,s)=>{await m.panels.update(n,s),e(o=>{if(o.currentProject){const i=o.currentProject.episodes.find(a=>a.id===r);if(i){const a=i.panels.findIndex(c=>c.id===n);a!==-1&&Object.assign(i.panels[a],s)}}})},deletePanel:async(r,n)=>{await m.panels.delete(n),e(s=>{if(s.currentProject){const o=s.currentProject.episodes.find(i=>i.id===r);o&&(o.panels=o.panels.filter(i=>i.id!==n))}})},reorderPanels:async(r,n)=>{const s=n.map((o,i)=>m.panels.update(o,{panelNumber:i+1}));await Promise.all(s),e(o=>{if(o.currentProject){const i=o.currentProject.episodes.find(a=>a.id===r);i&&(i.panels.forEach(a=>{const c=n.indexOf(a.id);c!==-1&&(a.panelNumber=c+1)}),i.panels.sort((a,c)=>a.panelNumber-c.panelNumber))}})},getProjectProgress:r=>{const{currentProject:n,projects:s}=t(),o=(n==null?void 0:n.id)===r?n:s.find(u=>u.id===r);if(!o)return{planning:0,characters:0,storyboard:0,images:0,overall:0};const i=o.planning?100:0,a=o.characters.filter(u=>u.role==="protagonist"||u.role==="antagonist"),c=Math.min(100,a.length/2*100),d=o.episodes.reduce((u,x)=>u+x.panels.length,0),f=o.episodeCount*20,p=Math.min(100,d/f*100),y=o.episodes.reduce((u,x)=>u+x.panels.filter(O=>O.generatedImage).length,0),_=d>0?y/d*100:0,M=i*.15+c*.15+p*.3+_*.4;return{planning:Math.round(i),characters:Math.round(c),storyboard:Math.round(p),images:Math.round(_),overall:Math.round(M)}}})),{name:"webtoon-forge-project",partialize:e=>({projects:e.projects.map(t=>({...t,characters:[],episodes:[]}))})})),we={text:1e-4,image:{standard:.003}},E=e=>({date:e,textGenerations:0,imageGenerations:0,cacheHits:0,totalCost:0,savedCost:0}),At=ie()(Se(le((e,t)=>({sessionStats:{textGenerations:0,imageGenerations:0,cacheHits:0,totalCost:0,savedCost:0},dailyStats:{},settings:{dailyLimit:5,warningThreshold:.8,enableProgressiveGeneration:!0,enableSemanticCache:!0,cacheThreshold:.85,preferBatchProcessing:!0,offPeakScheduling:!1},recordAPICall:(r,n)=>{const s=new Date().toISOString().split("T")[0];e(o=>{r==="text"?o.sessionStats.textGenerations++:o.sessionStats.imageGenerations++,o.sessionStats.totalCost+=n,o.dailyStats[s]||(o.dailyStats[s]=E(s)),r==="text"?o.dailyStats[s].textGenerations++:o.dailyStats[s].imageGenerations++,o.dailyStats[s].totalCost+=n})},recordCacheHit:r=>{const n=new Date().toISOString().split("T")[0],s=r==="text"?we.text:we.image.standard;e(o=>{o.sessionStats.cacheHits++,o.sessionStats.savedCost+=s,o.dailyStats[n]||(o.dailyStats[n]=E(n)),o.dailyStats[n].cacheHits++,o.dailyStats[n].savedCost+=s})},recordCacheSave:()=>{},getCacheHitRate:()=>{const{sessionStats:r}=t(),n=r.textGenerations+r.imageGenerations+r.cacheHits;return n===0?0:r.cacheHits/n*100},getTodayStats:()=>{const r=new Date().toISOString().split("T")[0],{dailyStats:n}=t();return n[r]||E(r)},getWeeklyStats:()=>{const{dailyStats:r}=t(),n=[];for(let s=6;s>=0;s--){const o=new Date;o.setDate(o.getDate()-s);const i=o.toISOString().split("T")[0];n.push(r[i]||E(i))}return n},getMonthlyStats:()=>{const{dailyStats:r}=t(),n=[];for(let s=29;s>=0;s--){const o=new Date;o.setDate(o.getDate()-s);const i=o.toISOString().split("T")[0];n.push(r[i]||E(i))}return n},updateSettings:r=>{e(n=>{Object.assign(n.settings,r)})},checkDailyLimit:()=>{const{settings:r}=t(),n=t().getTodayStats(),s=r.dailyLimit-n.totalCost,o=n.totalCost/r.dailyLimit;return{exceeded:o>=1,warning:o>=r.warningThreshold,remaining:Math.max(0,s)}},resetSession:()=>{e(r=>{r.sessionStats={textGenerations:0,imageGenerations:0,cacheHits:0,totalCost:0,savedCost:0}})}})),{name:"webtoon-forge-cost",partialize:e=>({dailyStats:e.dailyStats,settings:e.settings})})),St=ie()(le(e=>({sidebarOpen:!0,sidebarTab:"project",activeModal:null,modalData:null,toasts:[],globalLoading:!1,loadingMessage:"",selectedPanelId:null,selectedCharacterId:null,selectedEpisodeId:null,viewMode:"edit",zoom:100,toggleSidebar:()=>{e(t=>{t.sidebarOpen=!t.sidebarOpen})},setSidebarTab:t=>{e(r=>{r.sidebarTab=t,r.sidebarOpen=!0})},openModal:(t,r=null)=>{e(n=>{n.activeModal=t,n.modalData=r})},closeModal:()=>{e(t=>{t.activeModal=null,t.modalData=null})},addToast:t=>{const r=Date.now().toString();e(s=>{s.toasts.push({...t,id:r})});const n=t.duration||3e3;setTimeout(()=>{e(s=>{s.toasts=s.toasts.filter(o=>o.id!==r)})},n)},removeToast:t=>{e(r=>{r.toasts=r.toasts.filter(n=>n.id!==t)})},setGlobalLoading:(t,r="")=>{e(n=>{n.globalLoading=t,n.loadingMessage=r})},setSelectedPanel:t=>{e(r=>{r.selectedPanelId=t})},setSelectedCharacter:t=>{e(r=>{r.selectedCharacterId=t})},setSelectedEpisode:t=>{e(r=>{r.selectedEpisodeId=t})},setViewMode:t=>{e(r=>{r.viewMode=t})},setZoom:t=>{e(r=>{r.zoom=Math.min(200,Math.max(25,t))})}}))),Pt=()=>{const{toasts:e,removeToast:t}=St();return l.jsxs(l.Fragment,{children:[l.jsx(Ve,{}),l.jsx(qe,{toasts:e,onClose:t})]})};Y.createRoot(document.getElementById("root")).render(l.jsx(k.StrictMode,{children:l.jsx(Pt,{})}));export{Be as I,$e as L,We as T,At as a,He as b,St as c,ie as d,m as e,Se as p,Nt as u};
