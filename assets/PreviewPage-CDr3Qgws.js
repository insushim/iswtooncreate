import{j as e,A as N,m as u}from"./ui-D_LkVF2r.js";import{e as f,u as k,r as n}from"./vendor-Vqvh67Lm.js";import{B as x}from"./Button-C3O7gUUW.js";import{u as w,L as S}from"./index-B1teBZmw.js";import"./storage-BBQgdv-R.js";const $=()=>{const{projectId:d,episodeId:m}=f(),h=k(),{currentProject:a,setCurrentProject:p}=w(),[g,y]=n.useState(!0),[l,o]=n.useState(0),[c,v]=n.useState(!1);if(n.useEffect(()=>{(async()=>{d&&(await p(d),y(!1))})()},[d,p]),n.useEffect(()=>{if(a&&m){const s=a.episodes.findIndex(i=>i.id===m);s>=0&&o(s)}},[a,m]),g)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx(S,{size:"lg"})});if(!a)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(x,{variant:"primary",onClick:()=>h("/dashboard"),children:"ëŒ€ì‹œë³´ë“œë¡œ ì´ë™"})]})});const r=a.episodes[l];return e.jsxs("div",{className:`min-h-screen bg-gray-950 ${c?"fixed inset-0 z-50":""}`,children:[e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-sm border-b border-gray-800 sticky top-0 z-10",children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h(`/editor/${d}`),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white font-bold",children:a.title}),r&&e.jsxs("p",{className:"text-gray-400 text-sm",children:[r.episodeNumber,"í™” - ",r.title]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("select",{value:l,onChange:s=>o(Number(s.target.value)),className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white",children:a.episodes.map((s,i)=>e.jsxs("option",{value:i,children:[s.episodeNumber,"í™” - ",s.title]},s.id))}),e.jsx(x,{variant:"ghost",onClick:()=>v(!c),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V5H5v4h4zm6 0V5h4v4h-4zm-6 6v4H5v-4h4zm6 0v4h4v-4h-4z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4h4m8 0h4v4m0 8v4h-4m-8 0H4v-4"})}),children:c?"ë‚˜ê°€ê¸°":"ì „ì²´í™”ë©´"})]})]})}),e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-8",children:e.jsx(N,{mode:"wait",children:r?e.jsxs(u.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-1",children:[r.panels.sort((s,i)=>s.panelNumber-i.panelNumber).map((s,i)=>e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},className:"relative",children:[e.jsxs("div",{className:"relative",children:[s.generatedImage?e.jsx("img",{src:s.generatedImage.imageData,alt:`Panel ${s.panelNumber}`,className:"w-full",loading:"lazy"}):e.jsx("div",{className:"w-full aspect-[3/4] bg-gray-800 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-2 block",children:"ğŸ¨"}),e.jsx("p",{className:"text-gray-400",children:"ì´ë¯¸ì§€ ìƒì„± í•„ìš”"}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["íŒ¨ë„ ",s.panelNumber]})]})}),s.dialogues&&s.dialogues.length>0&&s.dialogues.map(t=>{var b,j;return e.jsxs("div",{className:"absolute z-10",style:{left:`${((b=t.position)==null?void 0:b.x)||50}%`,top:`${((j=t.position)==null?void 0:j.y)||15}%`,transform:"translate(-50%, 0)",maxWidth:"80%"},children:[e.jsx("div",{className:`
                              px-4 py-3 rounded-2xl shadow-lg
                              ${t.bubbleStyle==="thought"?"bg-white/90 rounded-full border-2 border-dashed border-gray-300":"bg-white border border-gray-200"}
                              ${t.bubbleStyle==="shout"?"border-2 border-red-500 bg-yellow-50":""}
                            `,style:{minWidth:"100px"},children:e.jsx("p",{className:`
                                text-gray-900 text-center leading-relaxed
                                ${t.fontSize==="small"?"text-sm":t.fontSize==="large"?"text-xl font-bold":"text-base"}
                                ${t.bubbleStyle==="shout"?"font-bold text-red-600":""}
                              `,style:{wordBreak:"keep-all"},children:t.text})}),t.bubbleStyle!=="thought"&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 w-0 h-0",style:{bottom:"-10px",borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderTop:"12px solid white"}})]},t.id)})]}),s.dialogues&&s.dialogues.length>0&&e.jsx("div",{className:"bg-gray-900/50 px-4 py-2 border-l-4 border-purple-500",children:s.dialogues.map(t=>e.jsxs("p",{className:"text-white text-sm",children:['"',t.text,'"']},t.id))})]},s.id)),e.jsxs("div",{className:"py-12 text-center",children:[e.jsxs("p",{className:"text-gray-400 mb-4",children:["- ",r.episodeNumber,"í™” ë -"]}),r.endingHook&&e.jsx("p",{className:"text-purple-400 italic",children:r.endingHook}),e.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[e.jsx(x,{variant:"secondary",disabled:l===0,onClick:()=>o(l-1),children:"ì´ì „ í™”"}),e.jsx(x,{variant:"primary",disabled:l===a.episodes.length-1,onClick:()=>o(l+1),children:"ë‹¤ìŒ í™”"})]})]})]},r.id):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("span",{className:"text-4xl mb-4 block",children:"ğŸ“š"}),e.jsx("p",{className:"text-gray-400",children:"ì—í”¼ì†Œë“œê°€ ì—†ìŠµë‹ˆë‹¤"})]})})})]})};export{$ as default};
