import{g as Lr,c as tt}from"./vendor-Vqvh67Lm.js";var Ur={exports:{}};(function(rt,$r){(function(Ke,$){rt.exports=$()})(tt,function(){var Ke=function(e,n){return(Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])})(e,n)},$=function(){return($=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function Fe(e,n,t){for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||((r=r||Array.prototype.slice.call(n,0,o))[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}var ee=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:tt,ie=Object.keys,V=Array.isArray;function ue(e,n){return typeof n!="object"||ie(n).forEach(function(t){e[t]=n[t]}),e}typeof Promise>"u"||ee.Promise||(ee.Promise=Promise);var de=Object.getPrototypeOf,qe={}.hasOwnProperty;function j(e,n){return qe.call(e,n)}function Q(e,n){typeof n=="function"&&(n=n(de(e))),(typeof Reflect>"u"?ie:Reflect.ownKeys)(n).forEach(function(t){fe(e,t,n[t])})}var ve=Object.defineProperty;function fe(e,n,t,r){ve(e,n,ue(t&&j(t,"get")&&typeof t.get=="function"?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function xe(e){return{from:function(n){return e.prototype=Object.create(n.prototype),fe(e.prototype,"constructor",e),{extend:Q.bind(null,e.prototype)}}}}var ge=Object.getOwnPropertyDescriptor,ze=[].slice;function ye(e,n,t){return ze.call(e,n,t)}function Fn(e,n){return n(e)}function Me(e){if(!e)throw new Error("Assertion Failed")}function M(e){ee.setImmediate?setImmediate(e):setTimeout(e,0)}function J(e,n){if(typeof n=="string"&&j(e,n))return e[n];if(!n)return e;if(typeof n!="string"){for(var t=[],r=0,o=n.length;r<o;++r){var i=J(e,n[r]);t.push(i)}return t}var u=n.indexOf(".");if(u!==-1){var c=e[n.substr(0,u)];return c==null?void 0:J(c,n.substr(u+1))}}function W(e,n,t){if(e&&n!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof n!="string"&&"length"in n){Me(typeof t!="string"&&"length"in t);for(var r=0,o=n.length;r<o;++r)W(e,n[r],t[r])}else{var i,u,c=n.indexOf(".");c!==-1?(i=n.substr(0,c),(u=n.substr(c+1))===""?t===void 0?V(e)&&!isNaN(parseInt(i))?e.splice(i,1):delete e[i]:e[i]=t:W(c=!(c=e[i])||!j(e,i)?e[i]={}:c,u,t)):t===void 0?V(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=t}}function se(e){var n,t={};for(n in e)j(e,n)&&(t[n]=e[n]);return t}var we=[].concat;function ke(e){return we.apply([],e)}var Ge="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ke([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(n){return n+e+"Array"})}))).filter(function(e){return ee[e]}),De=new Set(Ge.map(function(e){return ee[e]})),Ee=null;function Oe(e){return Ee=new WeakMap,e=function n(t){if(!t||typeof t!="object")return t;var r=Ee.get(t);if(r)return r;if(V(t)){r=[],Ee.set(t,r);for(var o=0,i=t.length;o<i;++o)r.push(n(t[o]))}else if(De.has(t.constructor))r=t;else{var u,c=de(t);for(u in r=c===Object.prototype?{}:Object.create(c),Ee.set(t,r),t)j(t,u)&&(r[u]=n(t[u]))}return r}(e),Ee=null,e}var Pn={}.toString;function ln(e){return Pn.call(e).slice(8,-1)}var In=typeof Symbol<"u"?Symbol.iterator:"@@iterator",hn=typeof In=="symbol"?function(e){var n;return e!=null&&(n=e[In])&&n.apply(e)}:function(){return null};function Qe(e,n){return n=e.indexOf(n),0<=n&&e.splice(n,1),0<=n}var dn={};function We(e){var n,t,r,o;if(arguments.length===1){if(V(e))return e.slice();if(this===dn&&typeof e=="string")return[e];if(o=hn(e)){for(t=[];!(r=o.next()).done;)t.push(r.value);return t}if(e==null)return[e];if(typeof(n=e.length)!="number")return[e];for(t=new Array(n);n--;)t[n]=e[n];return t}for(n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];return t}var Le=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},mn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],$e=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(mn),_t={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pn(e,n){this.name=e,this.message=n}function wt(e,n){return e+". Errors: "+Object.keys(n).map(function(t){return n[t].toString()}).filter(function(t,r,o){return o.indexOf(t)===r}).join(`
`)}function qn(e,n,t,r){this.failures=n,this.failedKeys=r,this.successCount=t,this.message=wt(e,n)}function vn(e,n){this.name="BulkError",this.failures=Object.keys(n).map(function(t){return n[t]}),this.failuresByPos=n,this.message=wt(e,this.failures)}xe(pn).from(Error).extend({toString:function(){return this.name+": "+this.message}}),xe(qn).from(pn),xe(vn).from(pn);var ot=$e.reduce(function(e,n){return e[n]=n+"Error",e},{}),$t=pn,z=$e.reduce(function(e,n){var t=n+"Error";function r(o,i){this.name=t,o?typeof o=="string"?(this.message="".concat(o).concat(i?`
 `+i:""),this.inner=i||null):typeof o=="object"&&(this.message="".concat(o.name," ").concat(o.message),this.inner=o):(this.message=_t[n]||t,this.inner=null)}return xe(r).from($t),e[n]=r,e},{});z.Syntax=SyntaxError,z.Type=TypeError,z.Range=RangeError;var xt=mn.reduce(function(e,n){return e[n+"Error"]=z[n],e},{}),Mn=$e.reduce(function(e,n){return["Syntax","Type","Range"].indexOf(n)===-1&&(e[n+"Error"]=z[n]),e},{});function ce(){}function An(e){return e}function zt(e,n){return e==null||e===An?n:function(t){return n(e(t))}}function Pe(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function Wt(e,n){return e===ce?n:function(){var t=e.apply(this,arguments);t!==void 0&&(arguments[0]=t);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Pe(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Pe(o,this.onerror):o),i!==void 0?i:t}}function Et(e,n){return e===ce?n:function(){e.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?Pe(t,this.onsuccess):t),r&&(this.onerror=this.onerror?Pe(r,this.onerror):r)}}function Ln(e,n){return e===ce?n:function(t){var r=e.apply(this,arguments);ue(t,r);var o=this.onsuccess,i=this.onerror;return this.onsuccess=null,this.onerror=null,t=n.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Pe(o,this.onsuccess):o),i&&(this.onerror=this.onerror?Pe(i,this.onerror):i),r===void 0?t===void 0?void 0:t:ue(r,t)}}function it(e,n){return e===ce?n:function(){return n.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Rn(e,n){return e===ce?n:function(){var t=e.apply(this,arguments);if(t&&typeof t.then=="function"){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return t.then(function(){return n.apply(r,i)})}return n.apply(this,arguments)}}Mn.ModifyError=qn,Mn.DexieError=pn,Mn.BulkError=vn;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function at(e){Be=e}var yn={},ut=100,Ge=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,de(e),e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,de(n),e]}(),mn=Ge[0],$e=Ge[1],Ge=Ge[2],$e=$e&&$e.then,Xe=mn&&mn.constructor,Un=!!Ge,gn=function(e,n){un.push([e,n]),Dn&&(queueMicrotask(Qt),Dn=!1)},Yn=!0,Dn=!0,He=[],Tn=[],Cn=An,Je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ce,pgp:!1,env:{},finalize:ce},Y=Je,un=[],Ze=0,$n=[];function B(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=Y;if(typeof e!="function"){if(e!==yn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&zn(this,this._value))}this._state=null,this._value=null,++n.ref,function t(r,o){try{o(function(i){if(r._state===null){if(i===r)throw new TypeError("A promise cannot be resolved with itself.");var u=r._lib&&bn();i&&typeof i.then=="function"?t(r,function(c,h){i instanceof B?i._then(c,h):i.then(c,h)}):(r._state=!0,r._value=i,Ot(r)),u&&_n()}},zn.bind(null,r))}catch(i){zn(r,i)}}(this,e)}var st={get:function(){var e=Y,n=Gn;function t(r,o){var i=this,u=!e.global&&(e!==Y||n!==Gn),c=u&&!nn(),h=new B(function(d,b){ct(i,new St(It(r,e,u,c),It(o,e,u,c),d,b,e))});return this._consoleTask&&(h._consoleTask=this._consoleTask),h}return t.prototype=yn,t},set:function(e){fe(this,"then",e&&e.prototype===yn?st:{get:function(){return e},set:st.set})}};function St(e,n,t,r,o){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof n=="function"?n:null,this.resolve=t,this.reject=r,this.psd=o}function zn(e,n){var t,r;Tn.push(n),e._state===null&&(t=e._lib&&bn(),n=Cn(n),e._state=!1,e._value=n,r=e,He.some(function(o){return o._value===r._value})||He.push(r),Ot(e),t&&_n())}function Ot(e){var n=e._listeners;e._listeners=[];for(var t=0,r=n.length;t<r;++t)ct(e,n[t]);var o=e._PSD;--o.ref||o.finalize(),Ze===0&&(++Ze,gn(function(){--Ze==0&&ft()},[]))}function ct(e,n){if(e._state!==null){var t=e._state?n.onFulfilled:n.onRejected;if(t===null)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++Ze,gn(Vt,[t,e,n])}else e._listeners.push(n)}function Vt(e,n,t){try{var r,o=n._value;!n._state&&Tn.length&&(Tn=[]),r=Be&&n._consoleTask?n._consoleTask.run(function(){return e(o)}):e(o),n._state||Tn.indexOf(o)!==-1||function(i){for(var u=He.length;u;)if(He[--u]._value===i._value)return He.splice(u,1)}(n),t.resolve(r)}catch(i){t.reject(i)}finally{--Ze==0&&ft(),--t.psd.ref||t.psd.finalize()}}function Qt(){sn(Je,function(){bn()&&_n()})}function bn(){var e=Yn;return Dn=Yn=!1,e}function _n(){var e,n,t;do for(;0<un.length;)for(e=un,un=[],t=e.length,n=0;n<t;++n){var r=e[n];r[0].apply(null,r[1])}while(0<un.length);Dn=Yn=!0}function ft(){var e=He;He=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var n=$n.slice(0),t=n.length;t;)n[--t]()}function Wn(e){return new B(yn,!1,e)}function le(e,n){var t=Y;return function(){var r=bn(),o=Y;try{return tn(t,!0),e.apply(this,arguments)}catch(i){n&&n(i)}finally{tn(o,!1),r&&_n()}}}Q(B.prototype,{then:st,_then:function(e,n){ct(this,new St(null,null,e,n,Y))},catch:function(e){if(arguments.length===1)return this.then(null,e);var n=e,t=arguments[1];return typeof n=="function"?this.then(null,function(r){return(r instanceof n?t:Wn)(r)}):this.then(null,function(r){return(r&&r.name===n?t:Wn)(r)})},finally:function(e){return this.then(function(n){return B.resolve(e()).then(function(){return n})},function(n){return B.resolve(e()).then(function(){return Wn(n)})})},timeout:function(e,n){var t=this;return e<1/0?new B(function(r,o){var i=setTimeout(function(){return o(new z.Timeout(n))},e);t.then(r,o).finally(clearTimeout.bind(null,i))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&fe(B.prototype,Symbol.toStringTag,"Dexie.Promise"),Je.env=Pt(),Q(B,{all:function(){var e=We.apply(null,arguments).map(Xn);return new B(function(n,t){e.length===0&&n([]);var r=e.length;e.forEach(function(o,i){return B.resolve(o).then(function(u){e[i]=u,--r||n(e)},t)})})},resolve:function(e){return e instanceof B?e:e&&typeof e.then=="function"?new B(function(n,t){e.then(n,t)}):new B(yn,!0,e)},reject:Wn,race:function(){var e=We.apply(null,arguments).map(Xn);return new B(function(n,t){e.map(function(r){return B.resolve(r).then(n,t)})})},PSD:{get:function(){return Y},set:function(e){return Y=e}},totalEchoes:{get:function(){return Gn}},newPSD:en,usePSD:sn,scheduler:{get:function(){return gn},set:function(e){gn=e}},rejectionMapper:{get:function(){return Cn},set:function(e){Cn=e}},follow:function(e,n){return new B(function(t,r){return en(function(o,i){var u=Y;u.unhandleds=[],u.onunhandled=i,u.finalize=Pe(function(){var c,h=this;c=function(){h.unhandleds.length===0?o():i(h.unhandleds[0])},$n.push(function d(){c(),$n.splice($n.indexOf(d),1)}),++Ze,gn(function(){--Ze==0&&ft()},[])},u.finalize),e()},n,t,r)})}}),Xe&&(Xe.allSettled&&fe(B,"allSettled",function(){var e=We.apply(null,arguments).map(Xn);return new B(function(n){e.length===0&&n([]);var t=e.length,r=new Array(t);e.forEach(function(o,i){return B.resolve(o).then(function(u){return r[i]={status:"fulfilled",value:u}},function(u){return r[i]={status:"rejected",reason:u}}).then(function(){return--t||n(r)})})})}),Xe.any&&typeof AggregateError<"u"&&fe(B,"any",function(){var e=We.apply(null,arguments).map(Xn);return new B(function(n,t){e.length===0&&t(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach(function(i,u){return B.resolve(i).then(function(c){return n(c)},function(c){o[u]=c,--r||t(new AggregateError(o))})})})}),Xe.withResolvers&&(B.withResolvers=Xe.withResolvers));var _e={awaits:0,echoes:0,id:0},kt=0,Vn=[],Qn=0,Gn=0,Gt=0;function en(e,n,t,r){var o=Y,i=Object.create(o);return i.parent=o,i.ref=0,i.global=!1,i.id=++Gt,Je.env,i.env=Un?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},n&&ue(i,n),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()},r=sn(i,e,t,r),i.ref===0&&i.finalize(),r}function wn(){return _e.id||(_e.id=++kt),++_e.awaits,_e.echoes+=ut,_e.id}function nn(){return!!_e.awaits&&(--_e.awaits==0&&(_e.id=0),_e.echoes=_e.awaits*ut,!0)}function Xn(e){return _e.echoes&&e&&e.constructor===Xe?(wn(),e.then(function(n){return nn(),n},function(n){return nn(),me(n)})):e}function Xt(){var e=Vn[Vn.length-1];Vn.pop(),tn(e,!1)}function tn(e,n){var t,r=Y;(n?!_e.echoes||Qn++&&e===Y:!Qn||--Qn&&e===Y)||queueMicrotask(n?(function(o){++Gn,_e.echoes&&--_e.echoes!=0||(_e.echoes=_e.awaits=_e.id=0),Vn.push(Y),tn(o,!0)}).bind(null,e):Xt),e!==Y&&(Y=e,r===Je&&(Je.env=Pt()),Un&&(t=Je.env.Promise,n=e.env,(r.global||e.global)&&(Object.defineProperty(ee,"Promise",n.PromiseProp),t.all=n.all,t.race=n.race,t.resolve=n.resolve,t.reject=n.reject,n.allSettled&&(t.allSettled=n.allSettled),n.any&&(t.any=n.any))))}function Pt(){var e=ee.Promise;return Un?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(ee,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function sn(e,n,t,r,o){var i=Y;try{return tn(e,!0),n(t,r,o)}finally{tn(i,!1)}}function It(e,n,t,r){return typeof e!="function"?e:function(){var o=Y;t&&wn(),tn(n,!0);try{return e.apply(this,arguments)}finally{tn(o,!1),r&&queueMicrotask(nn)}}}function lt(e){Promise===Xe&&_e.echoes===0?Qn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+$e).indexOf("[native code]")===-1&&(wn=nn=ce);var me=B.reject,rn="ï¿¿",Te="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ht="String expected.",Ue=[],Hn="__dbnames",xn="readonly",Kn="readwrite";function cn(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var At={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function En(e){return typeof e!="string"||/\./.test(e)?function(n){return n}:function(n){return n[e]===void 0&&e in n&&delete(n=Oe(n))[e],n}}function Rt(){throw z.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function re(e,n){try{var t=a(e),r=a(n);if(t!==r)return t==="Array"?1:r==="Array"?-1:t==="binary"?1:r==="binary"?-1:t==="string"?1:r==="string"?-1:t==="Date"?1:r!=="Date"?NaN:-1;switch(t){case"number":case"Date":case"string":return n<e?1:e<n?-1:0;case"binary":return function(o,i){for(var u=o.length,c=i.length,h=u<c?u:c,d=0;d<h;++d)if(o[d]!==i[d])return o[d]<i[d]?-1:1;return u===c?0:u<c?-1:1}(l(e),l(n));case"Array":return function(o,i){for(var u=o.length,c=i.length,h=u<c?u:c,d=0;d<h;++d){var b=re(o[d],i[d]);if(b!==0)return b}return u===c?0:u<c?-1:1}(e,n)}}catch{}return NaN}function a(e){var n=typeof e;return n!="object"?n:ArrayBuffer.isView(e)?"binary":(e=ln(e),e==="ArrayBuffer"?"binary":e)}function l(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function s(e,n,t){var r=e.schema.yProps;return r?(n&&0<t.numFailures&&(n=n.filter(function(o,i){return!t.failures[i]})),Promise.all(r.map(function(o){return o=o.updatesTable,n?e.db.table(o).where("k").anyOf(n).delete():e.db.table(o).clear()})).then(function(){return t})):t}var y=(_.prototype.execute=function(e){var n=this["@@propmod"];if(n.add!==void 0){var t=n.add;if(V(t))return Fe(Fe([],V(e)?e:[],!0),t).sort();if(typeof t=="number")return(Number(e)||0)+t;if(typeof t=="bigint")try{return BigInt(e)+t}catch{return BigInt(0)+t}throw new TypeError("Invalid term ".concat(t))}if(n.remove!==void 0){var r=n.remove;if(V(r))return V(e)?e.filter(function(o){return!r.includes(o)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return t=(t=n.replacePrefix)===null||t===void 0?void 0:t[0],t&&typeof e=="string"&&e.startsWith(t)?n.replacePrefix[1]+e.substring(t.length):e},_);function _(e){this["@@propmod"]=e}function v(e,n){for(var t=ie(n),r=t.length,o=!1,i=0;i<r;++i){var u=t[i],c=n[u],h=J(e,u);c instanceof y?(W(e,u,c.execute(h)),o=!0):h!==c&&(W(e,u,c),o=!0)}return o}var P=(k.prototype._trans=function(e,n,t){var r=this._tx||Y.trans,o=this.name,i=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function u(d,b,f){if(!f.schema[o])throw new z.NotFound("Table "+o+" not part of transaction");return n(f.idbtrans,f)}var c=bn();try{var h=r&&r.db._novip===this.db._novip?r===Y.trans?r._promise(e,u,t):en(function(){return r._promise(e,u,t)},{trans:r,transless:Y.transless||Y}):function d(b,f,x,p){if(b.idbdb&&(b._state.openComplete||Y.letThrough||b._vip)){var m=b._createTransaction(f,x,b._dbSchema);try{m.create(),b._state.PR1398_maxLoop=3}catch(g){return g.name===ot.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return d(b,f,x,p)})):me(g)}return m._promise(f,function(g,w){return en(function(){return Y.trans=m,p(g,w,m)})}).then(function(g){if(f==="readwrite")try{m.idbtrans.commit()}catch{}return f==="readonly"?g:m._completion.then(function(){return g})})}if(b._state.openComplete)return me(new z.DatabaseClosed(b._state.dbOpenError));if(!b._state.isBeingOpened){if(!b._state.autoOpen)return me(new z.DatabaseClosed);b.open().catch(ce)}return b._state.dbReadyPromise.then(function(){return d(b,f,x,p)})}(this.db,e,[this.name],u);return i&&(h._consoleTask=i,h=h.catch(function(d){return console.trace(d),me(d)})),h}finally{c&&_n()}},k.prototype.get=function(e,n){var t=this;return e&&e.constructor===Object?this.where(e).first(n):e==null?me(new z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return t.core.get({trans:r,key:e}).then(function(o){return t.hook.reading.fire(o)})}).then(n)},k.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(V(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var n=ie(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter(function(c){if(c.compound&&n.every(function(d){return 0<=c.keyPath.indexOf(d)})){for(var h=0;h<n.length;++h)if(n.indexOf(c.keyPath[h])===-1)return!1;return!0}return!1}).sort(function(c,h){return c.keyPath.length-h.keyPath.length})[0];if(t&&this.db._maxKey!==rn){var i=t.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(h){return e[h]}))}!t&&Be&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var r=this.schema.idxByName;function o(c,h){return re(c,h)===0}var u=n.reduce(function(f,h){var d=f[0],b=f[1],f=r[h],x=e[h];return[d||f,d||!f?cn(b,f&&f.multi?function(p){return p=J(p,h),V(p)&&p.some(function(m){return o(x,m)})}:function(p){return o(x,J(p,h))}):b]},[null,null]),i=u[0],u=u[1];return i?this.where(i.name).equals(e[i.keyPath]).filter(u):t?this.filter(u):this.where(n).equals("")},k.prototype.filter=function(e){return this.toCollection().and(e)},k.prototype.count=function(e){return this.toCollection().count(e)},k.prototype.offset=function(e){return this.toCollection().offset(e)},k.prototype.limit=function(e){return this.toCollection().limit(e)},k.prototype.each=function(e){return this.toCollection().each(e)},k.prototype.toArray=function(e){return this.toCollection().toArray(e)},k.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},k.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,V(e)?"[".concat(e.join("+"),"]"):e))},k.prototype.reverse=function(){return this.toCollection().reverse()},k.prototype.mapToClass=function(e){var n,t=this.db,r=this.name;function o(){return n!==null&&n.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Rt&&(function(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function b(){this.constructor=h}Ke(h,d),h.prototype=d===null?Object.create(d):(b.prototype=d.prototype,new b)}(o,n=e),Object.defineProperty(o.prototype,"db",{get:function(){return t},enumerable:!1,configurable:!0}),o.prototype.table=function(){return r},e=o);for(var i=new Set,u=e.prototype;u;u=de(u))Object.getOwnPropertyNames(u).forEach(function(h){return i.add(h)});function c(h){if(!h)return h;var d,b=Object.create(e.prototype);for(d in h)if(!i.has(d))try{b[d]=h[d]}catch{}return b}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),e},k.prototype.defineClass=function(){return this.mapToClass(function(e){ue(this,e)})},k.prototype.add=function(e,n){var t=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,u=e;return i&&o&&(u=En(i)(e)),this._trans("readwrite",function(c){return t.core.mutate({trans:c,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(c){return c.numFailures?B.reject(c.failures[0]):c.lastResult}).then(function(c){if(i)try{W(e,i,c)}catch{}return c})},k.prototype.upsert=function(e,n){var t=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(o){return t.core.get({trans:o,key:e}).then(function(i){var u=i??{};return v(u,n),r&&W(u,r,e),t.core.mutate({trans:o,type:"put",values:[u],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[n]}}).then(function(c){return c.numFailures?B.reject(c.failures[0]):!!i})})})},k.prototype.update=function(e,n){return typeof e!="object"||V(e)?this.where(":id").equals(e).modify(n):(e=J(e,this.schema.primKey.keyPath),e===void 0?me(new z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(n))},k.prototype.put=function(e,n){var t=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,u=e;return i&&o&&(u=En(i)(e)),this._trans("readwrite",function(c){return t.core.mutate({trans:c,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(c){return c.numFailures?B.reject(c.failures[0]):c.lastResult}).then(function(c){if(i)try{W(e,i,c)}catch{}return c})},k.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(t){return n.core.mutate({trans:t,type:"delete",keys:[e]}).then(function(r){return s(n,[e],r)}).then(function(r){return r.numFailures?B.reject(r.failures[0]):void 0})})},k.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:At}).then(function(t){return s(e,null,t)})}).then(function(n){return n.numFailures?B.reject(n.failures[0]):void 0})},k.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(t){return n.core.getMany({keys:e,trans:t}).then(function(r){return r.map(function(o){return n.hook.reading.fire(o)})})})},k.prototype.bulkAdd=function(e,n,t){var r=this,o=Array.isArray(n)?n:void 0,i=(t=t||(o?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",function(u){var d=r.schema.primKey,c=d.auto,d=d.keyPath;if(d&&o)throw new z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new z.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,d=d&&c?e.map(En(d)):e;return r.core.mutate({trans:u,type:"add",keys:o,values:d,wantResults:i}).then(function(m){var f=m.numFailures,x=m.results,p=m.lastResult,m=m.failures;if(f===0)return i?x:p;throw new vn("".concat(r.name,".bulkAdd(): ").concat(f," of ").concat(h," operations failed"),m)})})},k.prototype.bulkPut=function(e,n,t){var r=this,o=Array.isArray(n)?n:void 0,i=(t=t||(o?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",function(u){var d=r.schema.primKey,c=d.auto,d=d.keyPath;if(d&&o)throw new z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new z.InvalidArgument("Arguments objects and keys must have the same length");var h=e.length,d=d&&c?e.map(En(d)):e;return r.core.mutate({trans:u,type:"put",keys:o,values:d,wantResults:i}).then(function(m){var f=m.numFailures,x=m.results,p=m.lastResult,m=m.failures;if(f===0)return i?x:p;throw new vn("".concat(r.name,".bulkPut(): ").concat(f," of ").concat(h," operations failed"),m)})})},k.prototype.bulkUpdate=function(e){var n=this,t=this.core,r=e.map(function(u){return u.key}),o=e.map(function(u){return u.changes}),i=[];return this._trans("readwrite",function(u){return t.getMany({trans:u,keys:r,cache:"clone"}).then(function(c){var h=[],d=[];e.forEach(function(f,x){var p=f.key,m=f.changes,g=c[x];if(g){for(var w=0,E=Object.keys(m);w<E.length;w++){var S=E[w],O=m[S];if(S===n.schema.primKey.keyPath){if(re(O,p)!==0)throw new z.Constraint("Cannot update primary key in bulkUpdate()")}else W(g,S,O)}i.push(x),h.push(p),d.push(g)}});var b=h.length;return t.mutate({trans:u,type:"put",keys:h,values:d,updates:{keys:r,changeSpecs:o}}).then(function(f){var x=f.numFailures,p=f.failures;if(x===0)return b;for(var m=0,g=Object.keys(p);m<g.length;m++){var w,E=g[m],S=i[Number(E)];S!=null&&(w=p[E],delete p[E],p[S]=w)}throw new vn("".concat(n.name,".bulkUpdate(): ").concat(x," of ").concat(b," operations failed"),p)})})})},k.prototype.bulkDelete=function(e){var n=this,t=e.length;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:e}).then(function(o){return s(n,e,o)})}).then(function(u){var o=u.numFailures,i=u.lastResult,u=u.failures;if(o===0)return i;throw new vn("".concat(n.name,".bulkDelete(): ").concat(o," of ").concat(t," operations failed"),u)})},k);function k(){}function A(e){function n(u,c){if(c){for(var h=arguments.length,d=new Array(h-1);--h;)d[h-1]=arguments[h];return t[u].subscribe.apply(null,d),e}if(typeof u=="string")return t[u]}var t={};n.addEventType=i;for(var r=1,o=arguments.length;r<o;++r)i(arguments[r]);return n;function i(u,c,h){if(typeof u!="object"){var d;c=c||it;var b={subscribers:[],fire:h=h||ce,subscribe:function(f){b.subscribers.indexOf(f)===-1&&(b.subscribers.push(f),b.fire=c(b.fire,f))},unsubscribe:function(f){b.subscribers=b.subscribers.filter(function(x){return x!==f}),b.fire=b.subscribers.reduce(c,h)}};return t[u]=n[u]=b}ie(d=u).forEach(function(f){var x=d[f];if(V(x))i(f,d[f][0],d[f][1]);else{if(x!=="asap")throw new z.InvalidArgument("Invalid event config");var p=i(f,An,function(){for(var m=arguments.length,g=new Array(m);m--;)g[m]=arguments[m];p.subscribers.forEach(function(w){M(function(){w.apply(null,g)})})})}})}}function R(e,n){return xe(n).from({prototype:e}),n}function T(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function U(e,n){e.filter=cn(e.filter,n)}function X(e,n,t){var r=e.replayFilter;e.replayFilter=r?function(){return cn(r(),n())}:n,e.justLimit=t&&!r}function oe(e,n){if(e.isPrimKey)return n.primaryKey;var t=n.getIndexByKeyPath(e.index);if(!t)throw new z.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return t}function ae(e,n,t){var r=oe(e,n.schema);return n.openCursor({trans:t,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function he(e,n,t,r){var o=e.replayFilter?cn(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},u=function(c,h,d){var b,f;o&&!o(h,d,function(x){return h.stop(x)},function(x){return h.fail(x)})||((f=""+(b=h.primaryKey))=="[object ArrayBuffer]"&&(f=""+new Uint8Array(b)),j(i,f)||(i[f]=!0,n(c,h,d)))};return Promise.all([e.or._iterate(u,t),pe(ae(e,r,t),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}return pe(ae(e,r,t),cn(e.algorithm,o),n,!e.keysOnly&&e.valueMapper)}function pe(e,n,t,r){var o=le(r?function(i,u,c){return t(r(i),u,c)}:t);return e.then(function(i){if(i)return i.start(function(){var u=function(){return i.continue()};n&&!n(i,function(c){return u=c},function(c){i.stop(c),u=ce},function(c){i.fail(c),u=ce})||o(i.value,i,function(c){return u=c}),u()})})}var Ne=(ne.prototype._read=function(e,n){var t=this._ctx;return t.error?t.table._trans(null,me.bind(null,t.error)):t.table._trans("readonly",e).then(n)},ne.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,me.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},ne.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=cn(n.algorithm,e)},ne.prototype._iterate=function(e,n){return he(this._ctx,e,n,this._ctx.table.core)},ne.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),t=Object.create(this._ctx);return e&&ue(t,e),n._ctx=t,n},ne.prototype.raw=function(){return this._ctx.valueMapper=null,this},ne.prototype.each=function(e){var n=this._ctx;return this._read(function(t){return he(n,e,t,n.table.core)})},ne.prototype.count=function(e){var n=this;return this._read(function(t){var r=n._ctx,o=r.table.core;if(T(r,!0))return o.count({trans:t,query:{index:oe(r,o.schema),range:r.range}}).then(function(u){return Math.min(u,r.limit)});var i=0;return he(r,function(){return++i,!1},t,o).then(function(){return i})}).then(e)},ne.prototype.sortBy=function(e,n){var t=e.split(".").reverse(),r=t[0],o=t.length-1;function i(h,d){return d?i(h[t[d]],d-1):h[r]}var u=this._ctx.dir==="next"?1:-1;function c(h,d){return re(i(h,o),i(d,o))*u}return this.toArray(function(h){return h.sort(c)}).then(n)},ne.prototype.toArray=function(e){var n=this;return this._read(function(t){var r=n._ctx;if(r.dir==="next"&&T(r,!0)&&0<r.limit){var o=r.valueMapper,i=oe(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then(function(c){return c=c.result,o?c.map(o):c})}var u=[];return he(r,function(c){return u.push(c)},t,r.table.core).then(function(){return u})},e)},ne.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,T(n)?X(n,function(){var t=e;return function(r,o){return t===0||(t===1?--t:o(function(){r.advance(t),t=0}),!1)}}):X(n,function(){var t=e;return function(){return--t<0}})),this},ne.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),X(this._ctx,function(){var n=e;return function(t,r,o){return--n<=0&&r(o),0<=n}},!0),this},ne.prototype.until=function(e,n){return U(this._ctx,function(t,r,o){return!e(t.value)||(r(o),n)}),this},ne.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},ne.prototype.last=function(e){return this.reverse().first(e)},ne.prototype.filter=function(e){var n;return U(this._ctx,function(t){return e(t.value)}),(n=this._ctx).isMatch=cn(n.isMatch,e),this},ne.prototype.and=function(e){return this.filter(e)},ne.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ne.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ne.prototype.desc=function(){return this.reverse()},ne.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(t,r){e(r.key,r)})},ne.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ne.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(t,r){e(r.primaryKey,r)})},ne.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var t=[];return this.each(function(r,o){t.push(o.key)}).then(function(){return t}).then(e)},ne.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&T(n,!0)&&0<n.limit)return this._read(function(r){var o=oe(n,n.table.core.schema);return n.table.core.query({trans:r,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(r){return r.result}).then(e);n.keysOnly=!n.isMatch;var t=[];return this.each(function(r,o){t.push(o.primaryKey)}).then(function(){return t}).then(e)},ne.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ne.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},ne.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ne.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var n={};return U(this._ctx,function(o){var r=o.primaryKey.toString(),o=j(n,r);return n[r]=!0,!o}),this},ne.prototype.modify=function(e){var n=this,t=this._ctx;return this._write(function(r){var o=typeof e=="function"?e:function(g){return v(g,e)},i=t.table.core,d=i.schema.primaryKey,u=d.outbound,c=d.extractKey,h=200,d=n.db._options.modifyChunkSize;d&&(h=typeof d=="object"?d[i.name]||d["*"]||200:d);function b(g,S){var E=S.failures,S=S.numFailures;x+=g-S;for(var O=0,I=ie(E);O<I.length;O++){var C=I[O];f.push(E[C])}}var f=[],x=0,p=[],m=e===Jn;return n.clone().primaryKeys().then(function(g){function w(S){var O=Math.min(h,g.length-S),I=g.slice(S,S+O);return(m?Promise.resolve([]):i.getMany({trans:r,keys:I,cache:"immutable"})).then(function(C){var F=[],D=[],K=u?[]:null,q=m?I:[];if(!m)for(var N=0;N<O;++N){var L=C[N],H={value:Oe(L),primKey:g[S+N]};o.call(H,H.value,H)!==!1&&(H.value==null?q.push(g[S+N]):u||re(c(L),c(H.value))===0?(D.push(H.value),u&&K.push(g[S+N])):(q.push(g[S+N]),F.push(H.value)))}return Promise.resolve(0<F.length&&i.mutate({trans:r,type:"add",values:F}).then(function(Z){for(var te in Z.failures)q.splice(parseInt(te),1);b(F.length,Z)})).then(function(){return(0<D.length||E&&typeof e=="object")&&i.mutate({trans:r,type:"put",keys:K,values:D,criteria:E,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<S}).then(function(Z){return b(D.length,Z)})}).then(function(){return(0<q.length||E&&m)&&i.mutate({trans:r,type:"delete",keys:q,criteria:E,isAdditionalChunk:0<S}).then(function(Z){return s(t.table,q,Z)}).then(function(Z){return b(q.length,Z)})}).then(function(){return g.length>S+O&&w(S+h)})})}var E=T(t)&&t.limit===1/0&&(typeof e!="function"||m)&&{index:t.index,range:t.range};return w(0).then(function(){if(0<f.length)throw new qn("Error modifying one or more objects",f,x,p);return g.length})})})},ne.prototype.delete=function(){var e=this._ctx,n=e.range;return!T(e)||e.table.schema.yProps||!e.isPrimKey&&n.type!==3?this.modify(Jn):this._write(function(t){var r=e.table.core.schema.primaryKey,o=n;return e.table.core.count({trans:t,query:{index:r,range:o}}).then(function(i){return e.table.core.mutate({trans:t,type:"deleteRange",range:o}).then(function(h){var c=h.failures,h=h.numFailures;if(h)throw new qn("Could not delete some values",Object.keys(c).map(function(d){return c[d]}),i-h);return i-h})})})},ne);function ne(){}var Jn=function(e,n){return n.value=null};function Ht(e,n){return e<n?-1:e===n?0:1}function dt(e,n){return n<e?-1:e===n?0:1}function je(e,n,t){return e=e instanceof Er?new e.Collection(e):e,e._ctx.error=new(t||TypeError)(n),e}function Sn(e){return new e.Collection(e,function(){return xr("")}).limit(0)}function Zn(e,n,t,r){var o,i,u,c,h,d,b,f=t.length;if(!t.every(function(m){return typeof m=="string"}))return je(e,ht);function x(m){o=m==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},i=m==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},u=m==="next"?Ht:dt;var g=t.map(function(w){return{lower:i(w),upper:o(w)}}).sort(function(w,E){return u(w.lower,E.lower)});c=g.map(function(w){return w.upper}),h=g.map(function(w){return w.lower}),b=(d=m)==="next"?"":r}x("next"),e=new e.Collection(e,function(){return Ve(c[0],h[f-1]+r)}),e._ondirectionchange=function(m){x(m)};var p=0;return e._addAlgorithm(function(m,g,w){var E=m.key;if(typeof E!="string")return!1;var S=i(E);if(n(S,h,p))return!0;for(var O=null,I=p;I<f;++I){var C=function(F,D,K,q,N,L){for(var H=Math.min(F.length,q.length),Z=-1,te=0;te<H;++te){var Ye=D[te];if(Ye!==q[te])return N(F[te],K[te])<0?F.substr(0,te)+K[te]+K.substr(te+1):N(F[te],q[te])<0?F.substr(0,te)+q[te]+K.substr(te+1):0<=Z?F.substr(0,Z)+D[Z]+K.substr(Z+1):null;N(F[te],Ye)<0&&(Z=te)}return H<q.length&&L==="next"?F+K.substr(F.length):H<F.length&&L==="prev"?F.substr(0,K.length):Z<0?null:F.substr(0,Z)+q[Z]+K.substr(Z+1)}(E,S,c[I],h[I],u,d);C===null&&O===null?p=I+1:(O===null||0<u(O,C))&&(O=C)}return g(O!==null?function(){m.continue(O+b)}:w),!1}),e}function Ve(e,n,t,r){return{type:2,lower:e,upper:n,lowerOpen:t,upperOpen:r}}function xr(e){return{type:1,lower:e,upper:e}}var Er=(Object.defineProperty(Se.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Se.prototype.between=function(e,n,t,r){t=t!==!1,r=r===!0;try{return 0<this._cmp(e,n)||this._cmp(e,n)===0&&(t||r)&&(!t||!r)?Sn(this):new this.Collection(this,function(){return Ve(e,n,!t,!r)})}catch{return je(this,Te)}},Se.prototype.equals=function(e){return e==null?je(this,Te):new this.Collection(this,function(){return xr(e)})},Se.prototype.above=function(e){return e==null?je(this,Te):new this.Collection(this,function(){return Ve(e,void 0,!0)})},Se.prototype.aboveOrEqual=function(e){return e==null?je(this,Te):new this.Collection(this,function(){return Ve(e,void 0,!1)})},Se.prototype.below=function(e){return e==null?je(this,Te):new this.Collection(this,function(){return Ve(void 0,e,!1,!0)})},Se.prototype.belowOrEqual=function(e){return e==null?je(this,Te):new this.Collection(this,function(){return Ve(void 0,e)})},Se.prototype.startsWith=function(e){return typeof e!="string"?je(this,ht):this.between(e,e+rn,!0,!0)},Se.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Zn(this,function(n,t){return n.indexOf(t[0])===0},[e],rn)},Se.prototype.equalsIgnoreCase=function(e){return Zn(this,function(n,t){return n===t[0]},[e],"")},Se.prototype.anyOfIgnoreCase=function(){var e=We.apply(dn,arguments);return e.length===0?Sn(this):Zn(this,function(n,t){return t.indexOf(n)!==-1},e,"")},Se.prototype.startsWithAnyOfIgnoreCase=function(){var e=We.apply(dn,arguments);return e.length===0?Sn(this):Zn(this,function(n,t){return t.some(function(r){return n.indexOf(r)===0})},e,rn)},Se.prototype.anyOf=function(){var e=this,n=We.apply(dn,arguments),t=this._cmp;try{n.sort(t)}catch{return je(this,Te)}if(n.length===0)return Sn(this);var r=new this.Collection(this,function(){return Ve(n[0],n[n.length-1])});r._ondirectionchange=function(i){t=i==="next"?e._ascending:e._descending,n.sort(t)};var o=0;return r._addAlgorithm(function(i,u,c){for(var h=i.key;0<t(h,n[o]);)if(++o===n.length)return u(c),!1;return t(h,n[o])===0||(u(function(){i.continue(n[o])}),!1)}),r},Se.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Se.prototype.noneOf=function(){var e=We.apply(dn,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return je(this,Te)}var n=e.reduce(function(t,r){return t?t.concat([[t[t.length-1][1],r]]):[[-1/0,r]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},Se.prototype.inAnyRange=function(E,n){var t=this,r=this._cmp,o=this._ascending,i=this._descending,u=this._min,c=this._max;if(E.length===0)return Sn(this);if(!E.every(function(S){return S[0]!==void 0&&S[1]!==void 0&&o(S[0],S[1])<=0}))return je(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",z.InvalidArgument);var h=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0,b,f=o;function x(S,O){return f(S[0],O[0])}try{(b=E.reduce(function(S,O){for(var I=0,C=S.length;I<C;++I){var F=S[I];if(r(O[0],F[1])<0&&0<r(O[1],F[0])){F[0]=u(F[0],O[0]),F[1]=c(F[1],O[1]);break}}return I===C&&S.push(O),S},[])).sort(x)}catch{return je(this,Te)}var p=0,m=d?function(S){return 0<o(S,b[p][1])}:function(S){return 0<=o(S,b[p][1])},g=h?function(S){return 0<i(S,b[p][0])}:function(S){return 0<=i(S,b[p][0])},w=m,E=new this.Collection(this,function(){return Ve(b[0][0],b[b.length-1][1],!h,!d)});return E._ondirectionchange=function(S){f=S==="next"?(w=m,o):(w=g,i),b.sort(x)},E._addAlgorithm(function(S,O,I){for(var C,F=S.key;w(F);)if(++p===b.length)return O(I),!1;return!m(C=F)&&!g(C)||(t._cmp(F,b[p][1])===0||t._cmp(F,b[p][0])===0||O(function(){f===o?S.continue(b[p][0]):S.continue(b[p][1])}),!1)}),E},Se.prototype.startsWithAnyOf=function(){var e=We.apply(dn,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?Sn(this):this.inAnyRange(e.map(function(n){return[n,n+rn]})):je(this,"startsWithAnyOf() only works with strings")},Se);function Se(){}function on(e){return le(function(n){return pt(n),e(n.target.error),!1})}function pt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var vt="storagemutated",Jt="x-storagemutated-1",On=A(null,vt),zr=(an.prototype._lock=function(){return Me(!Y.global),++this._reculock,this._reculock!==1||Y.global||(Y.lockOwnerFor=this),this},an.prototype._unlock=function(){if(Me(!Y.global),--this._reculock==0)for(Y.global||(Y.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{sn(e[1],e[0])}catch{}}return this},an.prototype._locked=function(){return this._reculock&&Y.lockOwnerFor!==this},an.prototype.create=function(e){var n=this;if(!this.mode)return this;var t=this.db.idbdb,r=this.db._state.dbOpenError;if(Me(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new z.DatabaseClosed(r);case"MissingAPIError":throw new z.MissingAPI(r.message,r);default:throw new z.OpenFailed(r)}if(!this.active)throw new z.TransactionInactive;return Me(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||t).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=le(function(o){pt(o),n._reject(e.error)}),e.onabort=le(function(o){pt(o),n.active&&n._reject(new z.Abort(e.error)),n.active=!1,n.on("abort").fire(o)}),e.oncomplete=le(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&On.storagemutated.fire(e.mutatedParts)}),this},an.prototype._promise=function(e,n,t){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return me(new z.ReadOnly("Transaction is readonly"));if(!this.active)return me(new z.TransactionInactive);if(this._locked())return new B(function(i,u){r._blockedFuncs.push([function(){r._promise(e,n,t).then(i,u)},Y])});if(t)return en(function(){var i=new B(function(u,c){r._lock();var h=n(u,c,r);h&&h.then&&h.then(u,c)});return i.finally(function(){return r._unlock()}),i._lib=!0,i});var o=new B(function(i,u){var c=n(i,u,r);c&&c.then&&c.then(i,u)});return o._lib=!0,o},an.prototype._root=function(){return this.parent?this.parent._root():this},an.prototype.waitFor=function(e){var n,t=this._root(),r=B.resolve(e);t._waitingFor?t._waitingFor=t._waitingFor.then(function(){return r}):(t._waitingFor=r,t._waitingQueue=[],n=t.idbtrans.objectStore(t.storeNames[0]),function i(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=i)}());var o=t._waitingFor;return new B(function(i,u){r.then(function(c){return t._waitingQueue.push(le(i.bind(null,c)))},function(c){return t._waitingQueue.push(le(u.bind(null,c)))}).finally(function(){t._waitingFor===o&&(t._waitingFor=null)})})},an.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new z.Abort))},an.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(j(n,e))return n[e];var t=this.schema[e];if(!t)throw new z.NotFound("Table "+e+" not part of transaction");return t=new this.db.Table(e,t,this),t.core=this.db.core.table(e),n[e]=t},an);function an(){}function Zt(e,n,t,r,o,i,u,c){return{name:e,keyPath:n,unique:t,multi:r,auto:o,compound:i,src:(t&&!u?"&":"")+(r?"*":"")+(o?"++":"")+Sr(n),type:c}}function Sr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function er(e,n,t){return{name:e,primKey:n,indexes:t,mappedClass:null,idxByName:(r=function(o){return[o.name,o]},t.reduce(function(o,i,u){return u=r(i,u),u&&(o[u[0]]=u[1]),o},{}))};var r}var yt=function(e){try{return e.only([[]]),yt=function(){return[[]]},[[]]}catch{return yt=function(){return rn},rn}};function nr(e){return e==null?function(){}:typeof e=="string"?(n=e).split(".").length===1?function(t){return t[n]}:function(t){return J(t,n)}:function(t){return J(t,e)};var n}function Or(e){return[].slice.call(e)}var Wr=0;function mt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Vr(e,n,h){function r(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var p=w.lower,m=w.upper,g=w.lowerOpen,w=w.upperOpen;return p===void 0?m===void 0?null:n.upperBound(m,!!w):m===void 0?n.lowerBound(p,!!g):n.bound(p,m,!!g,!!w)}function o(x){var p,m=x.name;return{name:m,schema:x,mutate:function(g){var w=g.trans,E=g.type,S=g.keys,O=g.values,I=g.range;return new Promise(function(C,F){C=le(C);var D=w.objectStore(m),K=D.keyPath==null,q=E==="put"||E==="add";if(!q&&E!=="delete"&&E!=="deleteRange")throw new Error("Invalid operation type: "+E);var N,L=(S||O||{length:1}).length;if(S&&O&&S.length!==O.length)throw new Error("Given keys array must have same length as given values array.");if(L===0)return C({numFailures:0,failures:{},results:[],lastResult:void 0});function H(Ce){++Ye,pt(Ce)}var Z=[],te=[],Ye=0;if(E==="deleteRange"){if(I.type===4)return C({numFailures:Ye,failures:te,results:[],lastResult:void 0});I.type===3?Z.push(N=D.clear()):Z.push(N=D.delete(r(I)))}else{var K=q?K?[O,S]:[O,null]:[S,null],G=K[0],Ae=K[1];if(q)for(var Re=0;Re<L;++Re)Z.push(N=Ae&&Ae[Re]!==void 0?D[E](G[Re],Ae[Re]):D[E](G[Re])),N.onerror=H;else for(Re=0;Re<L;++Re)Z.push(N=D[E](G[Re])),N.onerror=H}function Ut(Ce){Ce=Ce.target.result,Z.forEach(function(jn,br){return jn.error!=null&&(te[br]=jn.error)}),C({numFailures:Ye,failures:te,results:E==="delete"?S:Z.map(function(jn){return jn.result}),lastResult:Ce})}N.onerror=function(Ce){H(Ce),Ut(Ce)},N.onsuccess=Ut})},getMany:function(g){var w=g.trans,E=g.keys;return new Promise(function(S,O){S=le(S);for(var I,C=w.objectStore(m),F=E.length,D=new Array(F),K=0,q=0,N=function(Z){Z=Z.target,D[Z._pos]=Z.result,++q===K&&S(D)},L=on(O),H=0;H<F;++H)E[H]!=null&&((I=C.get(E[H]))._pos=H,I.onsuccess=N,I.onerror=L,++K);K===0&&S(D)})},get:function(g){var w=g.trans,E=g.key;return new Promise(function(S,O){S=le(S);var I=w.objectStore(m).get(E);I.onsuccess=function(C){return S(C.target.result)},I.onerror=on(O)})},query:(p=d,function(g){return new Promise(function(w,E){w=le(w);var S,O,I,K=g.trans,C=g.values,F=g.limit,N=g.query,D=F===1/0?void 0:F,q=N.index,N=N.range,K=K.objectStore(m),q=q.isPrimaryKey?K:K.index(q.name),N=r(N);if(F===0)return w({result:[]});p?((D=C?q.getAll(N,D):q.getAllKeys(N,D)).onsuccess=function(L){return w({result:L.target.result})},D.onerror=on(E)):(S=0,O=!C&&"openKeyCursor"in q?q.openKeyCursor(N):q.openCursor(N),I=[],O.onsuccess=function(L){var H=O.result;return H?(I.push(C?H.value:H.primaryKey),++S===F?w({result:I}):void H.continue()):w({result:I})},O.onerror=on(E))})}),openCursor:function(g){var w=g.trans,E=g.values,S=g.query,O=g.reverse,I=g.unique;return new Promise(function(C,F){C=le(C);var q=S.index,D=S.range,K=w.objectStore(m),K=q.isPrimaryKey?K:K.index(q.name),q=O?I?"prevunique":"prev":I?"nextunique":"next",N=!E&&"openKeyCursor"in K?K.openKeyCursor(r(D),q):K.openCursor(r(D),q);N.onerror=on(F),N.onsuccess=le(function(L){var H,Z,te,Ye,G=N.result;G?(G.___id=++Wr,G.done=!1,H=G.continue.bind(G),Z=(Z=G.continuePrimaryKey)&&Z.bind(G),te=G.advance.bind(G),Ye=function(){throw new Error("Cursor not stopped")},G.trans=w,G.stop=G.continue=G.continuePrimaryKey=G.advance=function(){throw new Error("Cursor not started")},G.fail=le(F),G.next=function(){var Ae=this,Re=1;return this.start(function(){return Re--?Ae.continue():Ae.stop()}).then(function(){return Ae})},G.start=function(Ae){function Re(){if(N.result)try{Ae()}catch(Ce){G.fail(Ce)}else G.done=!0,G.start=function(){throw new Error("Cursor behind last entry")},G.stop()}var Ut=new Promise(function(Ce,jn){Ce=le(Ce),N.onerror=on(jn),G.fail=jn,G.stop=function(br){G.stop=G.continue=G.continuePrimaryKey=G.advance=Ye,Ce(br)}});return N.onsuccess=le(function(Ce){N.onsuccess=Re,Re()}),G.continue=H,G.continuePrimaryKey=Z,G.advance=te,Re(),Ut},C(G)):C(null)},F)})},count:function(g){var w=g.query,E=g.trans,S=w.index,O=w.range;return new Promise(function(I,C){var F=E.objectStore(m),D=S.isPrimaryKey?F:F.index(S.name),F=r(O),D=F?D.count(F):D.count();D.onsuccess=le(function(K){return I(K.target.result)}),D.onerror=on(C)})}}}var i,u,c,b=(u=h,c=Or((i=e).objectStoreNames),{schema:{name:i.name,tables:c.map(function(x){return u.objectStore(x)}).map(function(x){var p=x.keyPath,w=x.autoIncrement,m=V(p),g={},w={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:p==null,compound:m,keyPath:p,autoIncrement:w,unique:!0,extractKey:nr(p)},indexes:Or(x.indexNames).map(function(E){return x.index(E)}).map(function(I){var S=I.name,O=I.unique,C=I.multiEntry,I=I.keyPath,C={name:S,compound:V(I),keyPath:I,unique:O,multiEntry:C,extractKey:nr(I)};return g[mt(I)]=C}),getIndexByKeyPath:function(E){return g[mt(E)]}};return g[":id"]=w.primaryKey,p!=null&&(g[mt(p)]=w.primaryKey),w})},hasGetAll:0<c.length&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),h=b.schema,d=b.hasGetAll,b=h.tables.map(o),f={};return b.forEach(function(x){return f[x.name]=x}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(x){if(!f[x])throw new Error("Table '".concat(x,"' not found"));return f[x]},MIN_KEY:-1/0,MAX_KEY:yt(n),schema:h}}function Qr(e,n,t,r){var o=t.IDBKeyRange;return t.indexedDB,{dbcore:(r=Vr(n,o,r),e.dbcore.reduce(function(i,u){return u=u.create,$($({},i),u(i))},r))}}function Dt(e,r){var t=r.db,r=Qr(e._middlewares,t,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(o){var i=o.name;e.core.schema.tables.some(function(u){return u.name===i})&&(o.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=o.core))})}function Tt(e,n,t,r){t.forEach(function(o){var i=r[o];n.forEach(function(u){var c=function h(d,b){return ge(d,b)||(d=de(d))&&h(d,b)}(u,o);(!c||"value"in c&&c.value===void 0)&&(u===e.Transaction.prototype||u instanceof e.Transaction?fe(u,o,{get:function(){return this.table(o)},set:function(h){ve(this,o,{value:h,writable:!0,configurable:!0,enumerable:!0})}}):u[o]=new e.Table(o,i))})})}function tr(e,n){n.forEach(function(t){for(var r in t)t[r]instanceof e.Table&&delete t[r]})}function Gr(e,n){return e._cfg.version-n._cfg.version}function Xr(e,n,t,r){var o=e._dbSchema;t.objectStoreNames.contains("$meta")&&!o.$meta&&(o.$meta=er("$meta",Pr("")[0],[]),e._storeNames.push("$meta"));var i=e._createTransaction("readwrite",e._storeNames,o);i.create(t),i._completion.catch(r);var u=i._reject.bind(i),c=Y.transless||Y;en(function(){return Y.trans=i,Y.transless=c,n!==0?(Dt(e,t),d=n,((h=i).storeNames.includes("$meta")?h.table("$meta").get("version").then(function(b){return b??d}):B.resolve(d)).then(function(b){return x=b,p=i,m=t,g=[],b=(f=e)._versions,w=f._dbSchema=Kt(0,f.idbdb,m),(b=b.filter(function(E){return E._cfg.version>=x})).length!==0?(b.forEach(function(E){g.push(function(){var S=w,O=E._cfg.dbschema;Bt(f,S,m),Bt(f,O,m),w=f._dbSchema=O;var I=rr(S,O);I.add.forEach(function(q){or(m,q[0],q[1].primKey,q[1].indexes)}),I.change.forEach(function(q){if(q.recreate)throw new z.Upgrade("Not yet support for changing primary key");var N=m.objectStore(q.name);q.add.forEach(function(L){return Ct(N,L)}),q.change.forEach(function(L){N.deleteIndex(L.name),Ct(N,L)}),q.del.forEach(function(L){return N.deleteIndex(L)})});var C=E._cfg.contentUpgrade;if(C&&E._cfg.version>x){Dt(f,m),p._memoizedTables={};var F=se(O);I.del.forEach(function(q){F[q]=S[q]}),tr(f,[f.Transaction.prototype]),Tt(f,[f.Transaction.prototype],ie(F),F),p.schema=F;var D,K=Le(C);return K&&wn(),I=B.follow(function(){var q;(D=C(p))&&K&&(q=nn.bind(null,null),D.then(q,q))}),D&&typeof D.then=="function"?B.resolve(D):I.then(function(){return D})}}),g.push(function(S){var O,I,C=E._cfg.dbschema;O=C,I=S,[].slice.call(I.db.objectStoreNames).forEach(function(F){return O[F]==null&&I.db.deleteObjectStore(F)}),tr(f,[f.Transaction.prototype]),Tt(f,[f.Transaction.prototype],f._storeNames,f._dbSchema),p.schema=f._dbSchema}),g.push(function(S){f.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(f.idbdb.version/10)===E._cfg.version?(f.idbdb.deleteObjectStore("$meta"),delete f._dbSchema.$meta,f._storeNames=f._storeNames.filter(function(O){return O!=="$meta"})):S.objectStore("$meta").put(E._cfg.version,"version"))})}),function E(){return g.length?B.resolve(g.shift()(p.idbtrans)).then(E):B.resolve()}().then(function(){kr(w,m)})):B.resolve();var f,x,p,m,g,w}).catch(u)):(ie(o).forEach(function(b){or(t,b,o[b].primKey,o[b].indexes)}),Dt(e,t),void B.follow(function(){return e.on.populate.fire(i)}).catch(u));var h,d})}function Hr(e,n){kr(e._dbSchema,n),n.db.version%10!=0||n.objectStoreNames.contains("$meta")||n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var t=Kt(0,e.idbdb,n);Bt(e,e._dbSchema,n);for(var r=0,o=rr(t,e._dbSchema).change;r<o.length;r++){var i=function(u){if(u.change.length||u.recreate)return console.warn("Unable to patch indexes of table ".concat(u.name," because it has changes on the type of index or primary key.")),{value:void 0};var c=n.objectStore(u.name);u.add.forEach(function(h){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(u.name,".").concat(h.src)),Ct(c,h)})}(o[r]);if(typeof i=="object")return i.value}}function rr(e,n){var t,r={del:[],add:[],change:[]};for(t in e)n[t]||r.del.push(t);for(t in n){var o=e[t],i=n[t];if(o){var u={name:t,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||o.primKey.auto!==i.primKey.auto)u.recreate=!0,r.change.push(u);else{var c=o.idxByName,h=i.idxByName,d=void 0;for(d in c)h[d]||u.del.push(d);for(d in h){var b=c[d],f=h[d];b?b.src!==f.src&&u.change.push(f):u.add.push(f)}(0<u.del.length||0<u.add.length||0<u.change.length)&&r.change.push(u)}}else r.add.push([t,i])}return r}function or(e,n,t,r){var o=e.db.createObjectStore(n,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach(function(i){return Ct(o,i)}),o}function kr(e,n){ie(e).forEach(function(t){n.db.objectStoreNames.contains(t)||(Be&&console.debug("Dexie: Creating missing table",t),or(n,t,e[t].primKey,e[t].indexes))})}function Ct(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function Kt(e,n,t){var r={};return ye(n.objectStoreNames,0).forEach(function(o){for(var i=t.objectStore(o),u=Zt(Sr(d=i.keyPath),d||"",!0,!1,!!i.autoIncrement,d&&typeof d!="string",!0),c=[],h=0;h<i.indexNames.length;++h){var b=i.index(i.indexNames[h]),d=b.keyPath,b=Zt(b.name,d,!!b.unique,!!b.multiEntry,!1,d&&typeof d!="string",!1);c.push(b)}r[o]=er(o,u,c)}),r}function Bt(e,n,t){for(var r=t.db.objectStoreNames,o=0;o<r.length;++o){var i=r[o],u=t.objectStore(i);e._hasGetAll="getAll"in u;for(var c=0;c<u.indexNames.length;++c){var h=u.indexNames[c],d=u.index(h).keyPath,b=typeof d=="string"?d:"["+ye(d).join("+")+"]";!n[i]||(d=n[i].idxByName[b])&&(d.name=h,delete n[i].idxByName[b],n[i].idxByName[h]=d)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ee.WorkerGlobalScope&&ee instanceof ee.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Pr(e){return e.split(",").map(function(n,t){var i=n.split(":"),r=(o=i[1])===null||o===void 0?void 0:o.trim(),o=(n=i[0].trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return Zt(o,i||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),V(i),t===0,r)})}var Jr=(et.prototype._createTableSchema=er,et.prototype._parseIndexSyntax=Pr,et.prototype._parseStoresSpec=function(e,n){var t=this;ie(e).forEach(function(r){if(e[r]!==null){var o=t._parseIndexSyntax(e[r]),i=o.shift();if(!i)throw new z.Schema("Invalid schema for table "+r+": "+e[r]);if(i.unique=!0,i.multi)throw new z.Schema("Primary key cannot be multiEntry*");o.forEach(function(u){if(u.auto)throw new z.Schema("Only primary key can be marked as autoIncrement (++)");if(!u.keyPath)throw new z.Schema("Index must have a name and cannot be an empty string")}),o=t._createTableSchema(r,i,o),n[r]=o}})},et.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?ue(this._cfg.storesSource,t):t;var t=n._versions,r={},o={};return t.forEach(function(i){ue(r,i._cfg.storesSource),o=i._cfg.dbschema={},i._parseStoresSpec(r,o)}),n._dbSchema=o,tr(n,[n._allTables,n,n.Transaction.prototype]),Tt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],ie(o),o),n._storeNames=ie(o),this},et.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Rn(this._cfg.contentUpgrade||ce,e),this},et);function et(){}function ir(e,n){var t=e._dbNamesDB;return t||(t=e._dbNamesDB=new fn(Hn,{addons:[],indexedDB:e,IDBKeyRange:n})).version(1).stores({dbnames:"name"}),t.table("dbnames")}function ar(e){return e&&typeof e.databases=="function"}function ur(e){return en(function(){return Y.letThrough=!0,e()})}function sr(e){return!("from"in e)}var Ie=function(e,n){if(!this){var t=new Ie;return e&&"d"in e&&ue(t,e),t}ue(this,arguments.length?{d:1,from:e,to:1<arguments.length?n:e}:{d:0})};function gt(e,n,t){var r=re(n,t);if(!isNaN(r)){if(0<r)throw RangeError();if(sr(e))return ue(e,{from:n,to:t,d:1});var o=e.l,r=e.r;if(re(t,e.from)<0)return o?gt(o,n,t):e.l={from:n,to:t,d:1,l:null,r:null},Ar(e);if(0<re(n,e.to))return r?gt(r,n,t):e.r={from:n,to:t,d:1,l:null,r:null},Ar(e);re(n,e.from)<0&&(e.from=n,e.l=null,e.d=r?r.d+1:1),0<re(t,e.to)&&(e.to=t,e.r=null,e.d=e.l?e.l.d+1:1),t=!e.r,o&&!e.l&&bt(e,o),r&&t&&bt(e,r)}}function bt(e,n){sr(n)||function t(r,h){var i=h.from,u=h.to,c=h.l,h=h.r;gt(r,i,u),c&&t(r,c),h&&t(r,h)}(e,n)}function Ir(e,n){var t=Nt(n),r=t.next();if(r.done)return!1;for(var o=r.value,i=Nt(e),u=i.next(o.from),c=u.value;!r.done&&!u.done;){if(re(c.from,o.to)<=0&&0<=re(c.to,o.from))return!0;re(o.from,c.from)<0?o=(r=t.next(c.from)).value:c=(u=i.next(o.from)).value}return!1}function Nt(e){var n=sr(e)?null:{s:0,n:e};return{next:function(t){for(var r=0<arguments.length;n;)switch(n.s){case 0:if(n.s=1,r)for(;n.n.l&&re(t,n.n.from)<0;)n={up:n,n:n.n.l,s:1};else for(;n.n.l;)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!r||re(t,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function Ar(e){var n,t,r=(((n=e.r)===null||n===void 0?void 0:n.d)||0)-(((t=e.l)===null||t===void 0?void 0:t.d)||0),o=1<r?"r":r<-1?"l":"";o&&(n=o=="r"?"l":"r",t=$({},e),r=e[o],e.from=r.from,e.to=r.to,e[o]=r[o],t[o]=r[n],(e[n]=t).d=Rr(t)),e.d=Rr(e)}function Rr(t){var n=t.r,t=t.l;return(n?t?Math.max(n.d,t.d):n.d:t?t.d:0)+1}function jt(e,n){return ie(n).forEach(function(t){e[t]?bt(e[t],n[t]):e[t]=function r(o){var i,u,c={};for(i in o)j(o,i)&&(u=o[i],c[i]=!u||typeof u!="object"||De.has(u.constructor)?u:r(u));return c}(n[t])}),e}function cr(e,n){return e.all||n.all||Object.keys(e).some(function(t){return n[t]&&Ir(n[t],e[t])})}Q(Ie.prototype,(($e={add:function(e){return bt(this,e),this},addKey:function(e){return gt(this,e,e),this},addKeys:function(e){var n=this;return e.forEach(function(t){return gt(n,t,t)}),this},hasKey:function(e){var n=Nt(this).next(e).value;return n&&re(n.from,e)<=0&&0<=re(n.to,e)}})[In]=function(){return Nt(this)},$e));var Bn={},fr={},lr=!1;function Ft(e){jt(fr,e),lr||(lr=!0,setTimeout(function(){lr=!1,hr(fr,!(fr={}))},0))}function hr(e,n){n===void 0&&(n=!1);var t=new Set;if(e.all)for(var r=0,o=Object.values(Bn);r<o.length;r++)Dr(u=o[r],e,t,n);else for(var i in e){var u,c=/^idb\:\/\/(.*)\/(.*)\//.exec(i);c&&(i=c[1],c=c[2],(u=Bn["idb://".concat(i,"/").concat(c)])&&Dr(u,e,t,n))}t.forEach(function(h){return h()})}function Dr(e,n,t,r){for(var o=[],i=0,u=Object.entries(e.queries.query);i<u.length;i++){for(var c=u[i],h=c[0],d=[],b=0,f=c[1];b<f.length;b++){var x=f[b];cr(n,x.obsSet)?x.subscribers.forEach(function(w){return t.add(w)}):r&&d.push(x)}r&&o.push([h,d])}if(r)for(var p=0,m=o;p<m.length;p++){var g=m[p],h=g[0],d=g[1];e.queries.query[h]=d}}function Zr(e){var n=e._state,t=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then(function(){return n.dbOpenError?me(n.dbOpenError):e});n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var r=n.openCanceller,o=Math.round(10*e.verno),i=!1;function u(){if(n.openCanceller!==r)throw new z.DatabaseClosed("db.open() was cancelled")}function c(){return new B(function(x,p){if(u(),!t)throw new z.MissingAPI;var m=e.name,g=n.autoSchema||!o?t.open(m):t.open(m,o);if(!g)throw new z.MissingAPI;g.onerror=on(p),g.onblocked=le(e._fireOnBlocked),g.onupgradeneeded=le(function(w){var E;b=g.transaction,n.autoSchema&&!e._options.allowEmptyDB?(g.onerror=pt,b.abort(),g.result.close(),(E=t.deleteDatabase(m)).onsuccess=E.onerror=le(function(){p(new z.NoSuchDatabase("Database ".concat(m," doesnt exist")))})):(b.onerror=on(p),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,f=w<1,e.idbdb=g.result,i&&Hr(e,b),Xr(e,w/10,b,p))},p),g.onsuccess=le(function(){b=null;var w,E,S,O,I,C=e.idbdb=g.result,F=ye(C.objectStoreNames);if(0<F.length)try{var D=C.transaction((O=F).length===1?O[0]:O,"readonly");if(n.autoSchema)E=C,S=D,(w=e).verno=E.version/10,S=w._dbSchema=Kt(0,E,S),w._storeNames=ye(E.objectStoreNames,0),Tt(w,[w._allTables],ie(S),S);else if(Bt(e,e._dbSchema,D),((I=rr(Kt(0,(I=e).idbdb,D),I._dbSchema)).add.length||I.change.some(function(K){return K.add.length||K.change.length}))&&!i)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),C.close(),o=C.version+1,i=!0,x(c());Dt(e,D)}catch{}Ue.push(e),C.onversionchange=le(function(K){n.vcFired=!0,e.on("versionchange").fire(K)}),C.onclose=le(function(){e.close({disableAutoOpen:!1})}),f&&(I=e._deps,D=m,C=I.indexedDB,I=I.IDBKeyRange,ar(C)||D===Hn||ir(C,I).put({name:D}).catch(ce)),x()},p)}).catch(function(x){switch(x==null?void 0:x.name){case"UnknownError":if(0<n.PR1398_maxLoop)return n.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c();break;case"VersionError":if(0<o)return o=0,c()}return B.reject(x)})}var h,d=n.dbReadyResolve,b=null,f=!1;return B.race([r,(typeof navigator>"u"?B.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(x){function p(){return indexedDB.databases().finally(x)}h=setInterval(p,100),p()}).finally(function(){return clearInterval(h)}):Promise.resolve()).then(c)]).then(function(){return u(),n.onReadyBeingFired=[],B.resolve(ur(function(){return e.on.ready.fire(e.vip)})).then(function x(){if(0<n.onReadyBeingFired.length){var p=n.onReadyBeingFired.reduce(Rn,ce);return n.onReadyBeingFired=[],B.resolve(ur(function(){return p(e.vip)})).then(x)}})}).finally(function(){n.openCanceller===r&&(n.onReadyBeingFired=null,n.isBeingOpened=!1)}).catch(function(x){n.dbOpenError=x;try{b&&b.abort()}catch{}return r===n.openCanceller&&e._close(),me(x)}).finally(function(){n.openComplete=!0,d()}).then(function(){var x;return f&&(x={},e.tables.forEach(function(p){p.schema.indexes.forEach(function(m){m.name&&(x["idb://".concat(e.name,"/").concat(p.name,"/").concat(m.name)]=new Ie(-1/0,[[[]]]))}),x["idb://".concat(e.name,"/").concat(p.name,"/")]=x["idb://".concat(e.name,"/").concat(p.name,"/:dels")]=new Ie(-1/0,[[[]]])}),On(vt).fire(x),hr(x,!0)),e})}function dr(e){function n(i){return e.next(i)}var t=o(n),r=o(function(i){return e.throw(i)});function o(i){return function(h){var c=i(h),h=c.value;return c.done?h:h&&typeof h.then=="function"?h.then(t,r):V(h)?Promise.all(h).then(t,r):t(h)}}return o(n)()}function qt(e,n,t){for(var r=V(e)?e.slice():[e],o=0;o<t;++o)r.push(n);return r}var eo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return $($({},e),{table:function(n){var t=e.table(n),r=t.schema,o={},i=[];function u(f,x,p){var m=mt(f),g=o[m]=o[m]||[],w=f==null?0:typeof f=="string"?1:f.length,E=0<x,E=$($({},p),{name:E?"".concat(m,"(virtual-from:").concat(p.name,")"):p.name,lowLevelIndex:p,isVirtual:E,keyTail:x,keyLength:w,extractKey:nr(f),unique:!E&&p.unique});return g.push(E),E.isPrimaryKey||i.push(E),1<w&&u(w===2?f[0]:f.slice(0,w-1),x+1,p),g.sort(function(S,O){return S.keyTail-O.keyTail}),E}n=u(r.primaryKey.keyPath,0,r.primaryKey),o[":id"]=[n];for(var c=0,h=r.indexes;c<h.length;c++){var d=h[c];u(d.keyPath,0,d)}function b(f){var x,p=f.query.index;return p.isVirtual?$($({},f),{query:{index:p.lowLevelIndex,range:(x=f.query.range,p=p.keyTail,{type:x.type===1?2:x.type,lower:qt(x.lower,x.lowerOpen?e.MAX_KEY:e.MIN_KEY,p),lowerOpen:!0,upper:qt(x.upper,x.upperOpen?e.MIN_KEY:e.MAX_KEY,p),upperOpen:!0})}}):f}return $($({},t),{schema:$($({},r),{primaryKey:n,indexes:i,getIndexByKeyPath:function(f){return(f=o[mt(f)])&&f[0]}}),count:function(f){return t.count(b(f))},query:function(f){return t.query(b(f))},openCursor:function(f){var x=f.query.index,p=x.keyTail,m=x.isVirtual,g=x.keyLength;return m?t.openCursor(b(f)).then(function(E){return E&&w(E)}):t.openCursor(f);function w(E){return Object.create(E,{continue:{value:function(S){S!=null?E.continue(qt(S,f.reverse?e.MAX_KEY:e.MIN_KEY,p)):f.unique?E.continue(E.key.slice(0,g).concat(f.reverse?e.MIN_KEY:e.MAX_KEY,p)):E.continue()}},continuePrimaryKey:{value:function(S,O){E.continuePrimaryKey(qt(S,e.MAX_KEY,p),O)}},primaryKey:{get:function(){return E.primaryKey}},key:{get:function(){var S=E.key;return g===1?S[0]:S.slice(0,g)}},value:{get:function(){return E.value}}})}}})}})}};function pr(e,n,t,r){return t=t||{},r=r||"",ie(e).forEach(function(o){var i,u,c;j(n,o)?(i=e[o],u=n[o],typeof i=="object"&&typeof u=="object"&&i&&u?(c=ln(i))!==ln(u)?t[r+o]=n[o]:c==="Object"?pr(i,u,t,r+o+"."):i!==u&&(t[r+o]=n[o]):i!==u&&(t[r+o]=n[o])):t[r+o]=void 0}),ie(n).forEach(function(o){j(e,o)||(t[r+o]=n[o])}),t}function vr(e,n){return n.type==="delete"?n.keys:n.keys||n.values.map(e.extractKey)}var no={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return $($({},e),{table:function(n){var t=e.table(n),r=t.schema.primaryKey;return $($({},t),{mutate:function(o){var i=Y.trans,u=i.table(n).hook,c=u.deleting,h=u.creating,d=u.updating;switch(o.type){case"add":if(h.fire===ce)break;return i._promise("readwrite",function(){return b(o)},!0);case"put":if(h.fire===ce&&d.fire===ce)break;return i._promise("readwrite",function(){return b(o)},!0);case"delete":if(c.fire===ce)break;return i._promise("readwrite",function(){return b(o)},!0);case"deleteRange":if(c.fire===ce)break;return i._promise("readwrite",function(){return function f(x,p,m){return t.query({trans:x,values:!1,query:{index:r,range:p},limit:m}).then(function(g){var w=g.result;return b({type:"delete",keys:w,trans:x}).then(function(E){return 0<E.numFailures?Promise.reject(E.failures[0]):w.length<m?{failures:[],numFailures:0,lastResult:void 0}:f(x,$($({},p),{lower:w[w.length-1],lowerOpen:!0}),m)})})}(o.trans,o.range,1e4)},!0)}return t.mutate(o);function b(f){var x,p,m,g=Y.trans,w=f.keys||vr(r,f);if(!w)throw new Error("Keys missing");return(f=f.type==="add"||f.type==="put"?$($({},f),{keys:w}):$({},f)).type!=="delete"&&(f.values=Fe([],f.values)),f.keys&&(f.keys=Fe([],f.keys)),x=t,m=w,((p=f).type==="add"?Promise.resolve([]):x.getMany({trans:p.trans,keys:m,cache:"immutable"})).then(function(E){var S=w.map(function(O,I){var C,F,D,K=E[I],q={onerror:null,onsuccess:null};return f.type==="delete"?c.fire.call(q,O,K,g):f.type==="add"||K===void 0?(C=h.fire.call(q,O,f.values[I],g),O==null&&C!=null&&(f.keys[I]=O=C,r.outbound||W(f.values[I],r.keyPath,O))):(C=pr(K,f.values[I]),(F=d.fire.call(q,C,O,K,g))&&(D=f.values[I],Object.keys(F).forEach(function(N){j(D,N)?D[N]=F[N]:W(D,N,F[N])}))),q});return t.mutate(f).then(function(O){for(var I=O.failures,C=O.results,F=O.numFailures,O=O.lastResult,D=0;D<w.length;++D){var K=(C||w)[D],q=S[D];K==null?q.onerror&&q.onerror(I[D]):q.onsuccess&&q.onsuccess(f.type==="put"&&E[D]?f.values[D]:K)}return{failures:I,results:C,numFailures:F,lastResult:O}}).catch(function(O){return S.forEach(function(I){return I.onerror&&I.onerror(O)}),Promise.reject(O)})})}}})}})}};function Tr(e,n,t){try{if(!n||n.keys.length<e.length)return null;for(var r=[],o=0,i=0;o<n.keys.length&&i<e.length;++o)re(n.keys[o],e[i])===0&&(r.push(t?Oe(n.values[o]):n.values[o]),++i);return r.length===e.length?r:null}catch{return null}}var to={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var t=e.table(n);return $($({},t),{getMany:function(r){if(!r.cache)return t.getMany(r);var o=Tr(r.keys,r.trans._cache,r.cache==="clone");return o?B.resolve(o):t.getMany(r).then(function(i){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Oe(i):i},i})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),t.mutate(r)}})}}}};function Cr(e,n){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!n.schema.primaryKey.outbound}function Kr(e,n){switch(e){case"query":return n.values&&!n.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ro={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,t=new Ie(e.MIN_KEY,e.MAX_KEY);return $($({},e),{transaction:function(r,o,i){if(Y.subscr&&o!=="readonly")throw new z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Y.querier));return e.transaction(r,o,i)},table:function(r){var o=e.table(r),i=o.schema,u=i.primaryKey,f=i.indexes,c=u.extractKey,h=u.outbound,d=u.autoIncrement&&f.filter(function(p){return p.compound&&p.keyPath.includes(u.keyPath)}),b=$($({},o),{mutate:function(p){function m(N){return N="idb://".concat(n,"/").concat(r,"/").concat(N),O[N]||(O[N]=new Ie)}var g,w,E,S=p.trans,O=p.mutatedParts||(p.mutatedParts={}),I=m(""),C=m(":dels"),F=p.type,q=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[vr(u,p).filter(function(N){return N}),p.values]:[],D=q[0],K=q[1],q=p.trans._cache;return V(D)?(I.addKeys(D),(q=F==="delete"||D.length===K.length?Tr(D,q):null)||C.addKeys(D),(q||K)&&(g=m,w=q,E=K,i.indexes.forEach(function(N){var L=g(N.name||"");function H(te){return te!=null?N.extractKey(te):null}function Z(te){return N.multiEntry&&V(te)?te.forEach(function(Ye){return L.addKey(Ye)}):L.addKey(te)}(w||E).forEach(function(te,Ae){var G=w&&H(w[Ae]),Ae=E&&H(E[Ae]);re(G,Ae)!==0&&(G!=null&&Z(G),Ae!=null&&Z(Ae))})}))):D?(K={from:(K=D.lower)!==null&&K!==void 0?K:e.MIN_KEY,to:(K=D.upper)!==null&&K!==void 0?K:e.MAX_KEY},C.add(K),I.add(K)):(I.add(t),C.add(t),i.indexes.forEach(function(N){return m(N.name).add(t)})),o.mutate(p).then(function(N){return!D||p.type!=="add"&&p.type!=="put"||(I.addKeys(N.results),d&&d.forEach(function(L){for(var H=p.values.map(function(G){return L.extractKey(G)}),Z=L.keyPath.findIndex(function(G){return G===u.keyPath}),te=0,Ye=N.results.length;te<Ye;++te)H[te][Z]=N.results[te];m(L.name).addKeys(H)})),S.mutatedParts=jt(S.mutatedParts||{},O),N})}}),f=function(m){var g=m.query,m=g.index,g=g.range;return[m,new Ie((m=g.lower)!==null&&m!==void 0?m:e.MIN_KEY,(g=g.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},x={get:function(p){return[u,new Ie(p.key)]},getMany:function(p){return[u,new Ie().addKeys(p.keys)]},count:f,query:f,openCursor:f};return ie(x).forEach(function(p){b[p]=function(m){var g=Y.subscr,w=!!g,E=Cr(Y,o)&&Kr(p,m)?m.obsSet={}:g;if(w){var S=function(K){return K="idb://".concat(n,"/").concat(r,"/").concat(K),E[K]||(E[K]=new Ie)},O=S(""),I=S(":dels"),g=x[p](m),w=g[0],g=g[1];if((p==="query"&&w.isPrimaryKey&&!m.values?I:S(w.name||"")).add(g),!w.isPrimaryKey){if(p!=="count"){var C=p==="query"&&h&&m.values&&o.query($($({},m),{values:!1}));return o[p].apply(this,arguments).then(function(K){if(p==="query"){if(h&&m.values)return C.then(function(H){return H=H.result,O.addKeys(H),K});var q=m.values?K.result.map(c):K.result;(m.values?O:I).addKeys(q)}else if(p==="openCursor"){var N=K,L=m.values;return N&&Object.create(N,{key:{get:function(){return I.addKey(N.primaryKey),N.key}},primaryKey:{get:function(){var H=N.primaryKey;return I.addKey(H),H}},value:{get:function(){return L&&O.addKey(N.primaryKey),N.value}}})}return K})}I.add(t)}}return o[p].apply(this,arguments)}}),b}})}};function Br(e,n,t){if(t.numFailures===0)return n;if(n.type==="deleteRange")return null;var r=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;return t.numFailures===r?null:(n=$({},n),V(n.keys)&&(n.keys=n.keys.filter(function(o,i){return!(i in t.failures)})),"values"in n&&V(n.values)&&(n.values=n.values.filter(function(o,i){return!(i in t.failures)})),n)}function yr(e,n){return t=e,((r=n).lower===void 0||(r.lowerOpen?0<re(t,r.lower):0<=re(t,r.lower)))&&(e=e,(n=n).upper===void 0||(n.upperOpen?re(e,n.upper)<0:re(e,n.upper)<=0));var t,r}function Nr(e,n,x,r,o,i){if(!x||x.length===0)return e;var u=n.query.index,c=u.multiEntry,h=n.query.range,d=r.schema.primaryKey.extractKey,b=u.extractKey,f=(u.lowLevelIndex||u).extractKey,x=x.reduce(function(p,m){var g=p,w=[];if(m.type==="add"||m.type==="put")for(var E=new Ie,S=m.values.length-1;0<=S;--S){var O,I=m.values[S],C=d(I);E.hasKey(C)||(O=b(I),(c&&V(O)?O.some(function(N){return yr(N,h)}):yr(O,h))&&(E.addKey(C),w.push(I)))}switch(m.type){case"add":var F=new Ie().addKeys(n.values?p.map(function(L){return d(L)}):p),g=p.concat(n.values?w.filter(function(L){return L=d(L),!F.hasKey(L)&&(F.addKey(L),!0)}):w.map(function(L){return d(L)}).filter(function(L){return!F.hasKey(L)&&(F.addKey(L),!0)}));break;case"put":var D=new Ie().addKeys(m.values.map(function(L){return d(L)}));g=p.filter(function(L){return!D.hasKey(n.values?d(L):L)}).concat(n.values?w:w.map(function(L){return d(L)}));break;case"delete":var K=new Ie().addKeys(m.keys);g=p.filter(function(L){return!K.hasKey(n.values?d(L):L)});break;case"deleteRange":var q=m.range;g=p.filter(function(L){return!yr(d(L),q)})}return g},e);return x===e?e:(x.sort(function(p,m){return re(f(p),f(m))||re(d(p),d(m))}),n.limit&&n.limit<1/0&&(x.length>n.limit?x.length=n.limit:e.length===n.limit&&x.length<n.limit&&(o.dirty=!0)),i?Object.freeze(x):x)}function jr(e,n){return re(e.lower,n.lower)===0&&re(e.upper,n.upper)===0&&!!e.lowerOpen==!!n.lowerOpen&&!!e.upperOpen==!!n.upperOpen}function oo(e,n){return function(t,r,o,i){if(t===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=re(t,r))===0){if(o&&i)return 0;if(o)return 1;if(i)return-1}return r}(e.lower,n.lower,e.lowerOpen,n.lowerOpen)<=0&&0<=function(t,r,o,i){if(t===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=re(t,r))===0){if(o&&i)return 0;if(o)return-1;if(i)return 1}return r}(e.upper,n.upper,e.upperOpen,n.upperOpen)}function io(e,n,t,r){e.subscribers.add(t),r.addEventListener("abort",function(){var o,i;e.subscribers.delete(t),e.subscribers.size===0&&(o=e,i=n,setTimeout(function(){o.subscribers.size===0&&Qe(i,o)},3e3))})}var ao={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name;return $($({},e),{transaction:function(t,r,o){var i,u,c=e.transaction(t,r,o);return r==="readwrite"&&(u=(i=new AbortController).signal,o=function(h){return function(){if(i.abort(),r==="readwrite"){for(var d=new Set,b=0,f=t;b<f.length;b++){var x=f[b],p=Bn["idb://".concat(n,"/").concat(x)];if(p){var m=e.table(x),g=p.optimisticOps.filter(function(L){return L.trans===c});if(c._explicit&&h&&c.mutatedParts)for(var w=0,E=Object.values(p.queries.query);w<E.length;w++)for(var S=0,O=(F=E[w]).slice();S<O.length;S++)cr((D=O[S]).obsSet,c.mutatedParts)&&(Qe(F,D),D.subscribers.forEach(function(L){return d.add(L)}));else if(0<g.length){p.optimisticOps=p.optimisticOps.filter(function(L){return L.trans!==c});for(var I=0,C=Object.values(p.queries.query);I<C.length;I++)for(var F,D,K,q=0,N=(F=C[I]).slice();q<N.length;q++)(D=N[q]).res!=null&&c.mutatedParts&&(h&&!D.dirty?(K=Object.isFrozen(D.res),K=Nr(D.res,D.req,g,m,D,K),D.dirty?(Qe(F,D),D.subscribers.forEach(function(L){return d.add(L)})):K!==D.res&&(D.res=K,D.promise=B.resolve({result:K}))):(D.dirty&&Qe(F,D),D.subscribers.forEach(function(L){return d.add(L)})))}}}d.forEach(function(L){return L()})}}},c.addEventListener("abort",o(!1),{signal:u}),c.addEventListener("error",o(!1),{signal:u}),c.addEventListener("complete",o(!0),{signal:u})),c},table:function(t){var r=e.table(t),o=r.schema.primaryKey;return $($({},r),{mutate:function(i){var u=Y.trans;if(o.outbound||u.db._options.cache==="disabled"||u.explicit||u.idbtrans.mode!=="readwrite")return r.mutate(i);var c=Bn["idb://".concat(n,"/").concat(t)];return c?(u=r.mutate(i),i.type!=="add"&&i.type!=="put"||!(50<=i.values.length||vr(o,i).some(function(h){return h==null}))?(c.optimisticOps.push(i),i.mutatedParts&&Ft(i.mutatedParts),u.then(function(h){0<h.numFailures&&(Qe(c.optimisticOps,i),(h=Br(0,i,h))&&c.optimisticOps.push(h),i.mutatedParts&&Ft(i.mutatedParts))}),u.catch(function(){Qe(c.optimisticOps,i),i.mutatedParts&&Ft(i.mutatedParts)})):u.then(function(h){var d=Br(0,$($({},i),{values:i.values.map(function(b,f){var x;return h.failures[f]?b:(b=(x=o.keyPath)!==null&&x!==void 0&&x.includes(".")?Oe(b):$({},b),W(b,o.keyPath,h.results[f]),b)})}),h);c.optimisticOps.push(d),queueMicrotask(function(){return i.mutatedParts&&Ft(i.mutatedParts)})}),u):r.mutate(i)},query:function(i){if(!Cr(Y,r)||!Kr("query",i))return r.query(i);var u=((d=Y.trans)===null||d===void 0?void 0:d.db._options.cache)==="immutable",f=Y,c=f.requery,h=f.signal,d=function(m,g,w,E){var S=Bn["idb://".concat(m,"/").concat(g)];if(!S)return[];if(!(g=S.queries[w]))return[null,!1,S,null];var O=g[(E.query?E.query.index.name:null)||""];if(!O)return[null,!1,S,null];switch(w){case"query":var I=O.find(function(C){return C.req.limit===E.limit&&C.req.values===E.values&&jr(C.req.query.range,E.query.range)});return I?[I,!0,S,O]:[O.find(function(C){return("limit"in C.req?C.req.limit:1/0)>=E.limit&&(!E.values||C.req.values)&&oo(C.req.query.range,E.query.range)}),!1,S,O];case"count":return I=O.find(function(C){return jr(C.req.query.range,E.query.range)}),[I,!!I,S,O]}}(n,t,"query",i),b=d[0],f=d[1],x=d[2],p=d[3];return b&&f?b.obsSet=i.obsSet:(f=r.query(i).then(function(m){var g=m.result;if(b&&(b.res=g),u){for(var w=0,E=g.length;w<E;++w)Object.freeze(g[w]);Object.freeze(g)}else m.result=Oe(g);return m}).catch(function(m){return p&&b&&Qe(p,b),Promise.reject(m)}),b={obsSet:i.obsSet,promise:f,subscribers:new Set,type:"query",req:i,dirty:!1},p?p.push(b):(p=[b],(x=x||(Bn["idb://".concat(n,"/").concat(t)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[i.query.index.name||""]=p)),io(b,p,c,h),b.promise.then(function(m){return{result:Nr(m.result,i,x==null?void 0:x.optimisticOps,r,b,u)}})}})}})}};function Mt(e,n){return new Proxy(e,{get:function(t,r,o){return r==="db"?n:Reflect.get(t,r,o)}})}var fn=(be.prototype.version=function(e){if(isNaN(e)||e<.1)throw new z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,t=n.filter(function(r){return r._cfg.version===e})[0];return t||(t=new this.Version(e),n.push(t),n.sort(Gr),t.stores({}),this._state.autoSchema=!1,t)},be.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||Y.letThrough||this._vip)?e():new B(function(t,r){if(n._state.openComplete)return r(new z.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen)return void r(new z.DatabaseClosed);n.open().catch(ce)}n._state.dbReadyPromise.then(t,r)}).then(e)},be.prototype.use=function(e){var n=e.stack,t=e.create,r=e.level,o=e.name;return o&&this.unuse({stack:n,name:o}),e=this._middlewares[n]||(this._middlewares[n]=[]),e.push({stack:n,create:t,level:r??10,name:o}),e.sort(function(i,u){return i.level-u.level}),this},be.prototype.unuse=function(e){var n=e.stack,t=e.name,r=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return r?o.create!==r:!!t&&o.name!==t})),this},be.prototype.open=function(){var e=this;return sn(Je,function(){return Zr(e)})},be.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,n=Ue.indexOf(this);if(0<=n&&Ue.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new B(function(t){e.dbReadyResolve=t}),e.openCanceller=new B(function(t,r){e.cancelOpen=r}))},be.prototype.close=function(t){var n=(t===void 0?{disableAutoOpen:!0}:t).disableAutoOpen,t=this._state;n?(t.isBeingOpened&&t.cancelOpen(new z.DatabaseClosed),this._close(),t.autoOpen=!1,t.dbOpenError=new z.DatabaseClosed):(this._close(),t.autoOpen=this._options.autoOpen||t.isBeingOpened,t.openComplete=!1,t.dbOpenError=null)},be.prototype.delete=function(e){var n=this;e===void 0&&(e={disableAutoOpen:!0});var t=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new B(function(o,i){function u(){n.close(e);var c=n._deps.indexedDB.deleteDatabase(n.name);c.onsuccess=le(function(){var h,d,b;h=n._deps,d=n.name,b=h.indexedDB,h=h.IDBKeyRange,ar(b)||d===Hn||ir(b,h).delete(d).catch(ce),o()}),c.onerror=on(i),c.onblocked=n._fireOnBlocked}if(t)throw new z.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(u):u()})},be.prototype.backendDB=function(){return this.idbdb},be.prototype.isOpen=function(){return this.idbdb!==null},be.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},be.prototype.hasFailed=function(){return this._state.dbOpenError!==null},be.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(be.prototype,"tables",{get:function(){var e=this;return ie(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),be.prototype.transaction=function(){var e=(function(n,t,r){var o=arguments.length;if(o<2)throw new z.InvalidArgument("Too few arguments");for(var i=new Array(o-1);--o;)i[o-1]=arguments[o];return r=i.pop(),[n,ke(i),r]}).apply(this,arguments);return this._transaction.apply(this,e)},be.prototype._transaction=function(e,n,t){var r=this,o=Y.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);var i,u,c=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(u=n.map(function(d){if(d=d instanceof r.Table?d.name:d,typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===xn)i=xn;else{if(e!="rw"&&e!=Kn)throw new z.InvalidArgument("Invalid transaction mode: "+e);i=Kn}if(o){if(o.mode===xn&&i===Kn){if(!c)throw new z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&u.forEach(function(d){if(o&&o.storeNames.indexOf(d)===-1){if(!c)throw new z.SubTransaction("Table "+d+" not included in parent transaction.");o=null}}),c&&o&&!o.active&&(o=null)}}catch(d){return o?o._promise(null,function(b,f){f(d)}):me(d)}var h=(function d(b,f,x,p,m){return B.resolve().then(function(){var g=Y.transless||Y,w=b._createTransaction(f,x,b._dbSchema,p);if(w.explicit=!0,g={trans:w,transless:g},p)w.idbtrans=p.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,b._state.PR1398_maxLoop=3}catch(O){return O.name===ot.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return d(b,f,x,null,m)})):me(O)}var E,S=Le(m);return S&&wn(),g=B.follow(function(){var O;(E=m.call(w,w))&&(S?(O=nn.bind(null,null),E.then(O,O)):typeof E.next=="function"&&typeof E.throw=="function"&&(E=dr(E)))},g),(E&&typeof E.then=="function"?B.resolve(E).then(function(O){return w.active?O:me(new z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):g.then(function(){return E})).then(function(O){return p&&w._resolve(),w._completion.then(function(){return O})}).catch(function(O){return w._reject(O),me(O)})})}).bind(null,this,i,u,o,t);return o?o._promise(i,h,"lock"):Y.trans?sn(Y.transless,function(){return r._whenReady(h)}):this._whenReady(h)},be.prototype.table=function(e){if(!j(this._allTables,e))throw new z.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},be);function be(e,n){var t=this;this._middlewares={},this.verno=0;var r=be.dependencies;this._options=n=$({addons:be.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},r=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o,i,u,c,h,d={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ce,dbReadyPromise:null,cancelOpen:ce,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};d.dbReadyPromise=new B(function(f){d.dbReadyResolve=f}),d.openCanceller=new B(function(f,x){d.cancelOpen=x}),this._state=d,this.name=e,this.on=A(this,"populate","blocked","versionchange","close",{ready:[Rn,ce]}),this.once=function(f,x){var p=function(){for(var m=[],g=0;g<arguments.length;g++)m[g]=arguments[g];t.on(f).unsubscribe(p),x.apply(t,m)};return t.on(f,p)},this.on.ready.subscribe=Fn(this.on.ready.subscribe,function(f){return function(x,p){be.vip(function(){var m,g=t._state;g.openComplete?(g.dbOpenError||B.resolve().then(x),p&&f(x)):g.onReadyBeingFired?(g.onReadyBeingFired.push(x),p&&f(x)):(f(x),m=t,p||f(function w(){m.on.ready.unsubscribe(x),m.on.ready.unsubscribe(w)}))})}}),this.Collection=(o=this,R(Ne.prototype,function(E,w){this.db=o;var p=At,m=null;if(w)try{p=w()}catch(S){m=S}var g=E._ctx,w=g.table,E=w.hook.reading.fire;this._ctx={table:w,index:g.index,isPrimKey:!g.index||w.schema.primKey.keyPath&&g.index===w.schema.primKey.name,range:p,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:m,or:g.or,valueMapper:E!==An?E:null}})),this.Table=(i=this,R(P.prototype,function(f,x,p){this.db=i,this._tx=p,this.name=f,this.schema=x,this.hook=i._allTables[f]?i._allTables[f].hook:A(null,{creating:[Wt,ce],reading:[zt,An],updating:[Ln,ce],deleting:[Et,ce]})})),this.Transaction=(u=this,R(zr.prototype,function(f,x,p,m,g){var w=this;f!=="readonly"&&x.forEach(function(E){E=(E=p[E])===null||E===void 0?void 0:E.yProps,E&&(x=x.concat(E.map(function(S){return S.updatesTable})))}),this.db=u,this.mode=f,this.storeNames=x,this.schema=p,this.chromeTransactionDurability=m,this.idbtrans=null,this.on=A(this,"complete","error","abort"),this.parent=g||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(E,S){w._resolve=E,w._reject=S}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(E){var S=w.active;return w.active=!1,w.on.error.fire(E),w.parent?w.parent._reject(E):S&&w.idbtrans&&w.idbtrans.abort(),me(E)})})),this.Version=(c=this,R(Jr.prototype,function(f){this.db=c,this._cfg={version:f,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(h=this,R(Er.prototype,function(f,x,p){if(this.db=h,this._ctx={table:f,index:x===":id"?null:x,or:p},this._cmp=this._ascending=re,this._descending=function(m,g){return re(g,m)},this._max=function(m,g){return 0<re(m,g)?m:g},this._min=function(m,g){return re(m,g)<0?m:g},this._IDBKeyRange=h._deps.IDBKeyRange,!this._IDBKeyRange)throw new z.MissingAPI})),this.on("versionchange",function(f){0<f.newVersion?console.warn("Another connection wants to upgrade database '".concat(t.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(t.name,"'. Closing db now to resume the delete request.")),t.close({disableAutoOpen:!1})}),this.on("blocked",function(f){!f.newVersion||f.newVersion<f.oldVersion?console.warn("Dexie.delete('".concat(t.name,"') was blocked")):console.warn("Upgrade '".concat(t.name,"' blocked by other connection holding version ").concat(f.oldVersion/10))}),this._maxKey=yt(n.IDBKeyRange),this._createTransaction=function(f,x,p,m){return new t.Transaction(f,x,p,t._options.chromeTransactionDurability,m)},this._fireOnBlocked=function(f){t.on("blocked").fire(f),Ue.filter(function(x){return x.name===t.name&&x!==t&&!x._state.vcFired}).map(function(x){return x.on("versionchange").fire(f)})},this.use(to),this.use(ao),this.use(ro),this.use(eo),this.use(no);var b=new Proxy(this,{get:function(f,x,p){if(x==="_vip")return!0;if(x==="table")return function(g){return Mt(t.table(g),b)};var m=Reflect.get(f,x,p);return m instanceof P?Mt(m,b):x==="tables"?m.map(function(g){return Mt(g,b)}):x==="_createTransaction"?function(){return Mt(m.apply(this,arguments),b)}:m}});this.vip=b,r.forEach(function(f){return f(t)})}var Lt,$e=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",uo=(mr.prototype.subscribe=function(e,n,t){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:t})},mr.prototype[$e]=function(){return this},mr);function mr(e){this._subscribe=e}try{Lt={indexedDB:ee.indexedDB||ee.mozIndexedDB||ee.webkitIndexedDB||ee.msIndexedDB,IDBKeyRange:ee.IDBKeyRange||ee.webkitIDBKeyRange}}catch{Lt={indexedDB:null,IDBKeyRange:null}}function Fr(e){var n,t=!1,r=new uo(function(o){var i=Le(e),u,c=!1,h={},d={},b={get closed(){return c},unsubscribe:function(){c||(c=!0,u&&u.abort(),f&&On.storagemutated.unsubscribe(p))}};o.start&&o.start(b);var f=!1,x=function(){return lt(m)},p=function(g){jt(h,g),cr(d,h)&&x()},m=function(){var g,w,E;!c&&Lt.indexedDB&&(h={},g={},u&&u.abort(),u=new AbortController,E=function(S){var O=bn();try{i&&wn();var I=en(e,S);return I=i?I.finally(nn):I}finally{O&&_n()}}(w={subscr:g,signal:u.signal,requery:x,querier:e,trans:null}),Promise.resolve(E).then(function(S){t=!0,n=S,c||w.signal.aborted||(h={},function(O){for(var I in O)if(j(O,I))return;return 1}(d=g)||f||(On(vt,p),f=!0),lt(function(){return!c&&o.next&&o.next(S)}))},function(S){t=!1,["DatabaseClosedError","AbortError"].includes(S==null?void 0:S.name)||c||lt(function(){c||o.error&&o.error(S)})}))};return setTimeout(x,0),b});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var Nn=fn;function gr(e){var n=kn;try{kn=!0,On.storagemutated.fire(e),hr(e,!0)}finally{kn=n}}Q(Nn,$($({},Mn),{delete:function(e){return new Nn(e,{addons:[]}).delete()},exists:function(e){return new Nn(e,{addons:[]}).open().then(function(n){return n.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return n=Nn.dependencies,t=n.indexedDB,n=n.IDBKeyRange,(ar(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(o){return o.name}).filter(function(o){return o!==Hn})}):ir(t,n).toCollection().primaryKeys()).then(e)}catch{return me(new z.MissingAPI)}var n,t},defineClass:function(){return function(e){ue(this,e)}},ignoreTransaction:function(e){return Y.trans?sn(Y.transless,e):e()},vip:ur,async:function(e){return function(){try{var n=dr(e.apply(this,arguments));return n&&typeof n.then=="function"?n:B.resolve(n)}catch(t){return me(t)}}},spawn:function(e,n,t){try{var r=dr(e.apply(t,n||[]));return r&&typeof r.then=="function"?r:B.resolve(r)}catch(o){return me(o)}},currentTransaction:{get:function(){return Y.trans||null}},waitFor:function(e,n){return n=B.resolve(typeof e=="function"?Nn.ignoreTransaction(e):e).timeout(n||6e4),Y.trans?Y.trans.waitFor(n):n},Promise:B,debug:{get:function(){return Be},set:function(e){at(e)}},derive:xe,extend:ue,props:Q,override:Fn,Events:A,on:On,liveQuery:Fr,extendObservabilitySet:jt,getByKeyPath:J,setByKeyPath:W,delByKeyPath:function(e,n){typeof n=="string"?W(e,n,void 0):"length"in n&&[].map.call(n,function(t){W(e,t,void 0)})},shallowClone:se,deepClone:Oe,getObjectDiff:pr,cmp:re,asap:M,minKey:-1/0,addons:[],connections:Ue,errnames:ot,dependencies:Lt,cache:Bn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,n,t){return e+n/Math.pow(10,2*t)})})),Nn.maxKey=yt(Nn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(On(vt,function(e){kn||(e=new CustomEvent(Jt,{detail:e}),kn=!0,dispatchEvent(e),kn=!1)}),addEventListener(Jt,function(e){e=e.detail,kn||gr(e)}));var nt,kn=!1,qr=function(){};return typeof BroadcastChannel<"u"&&((qr=function(){(nt=new BroadcastChannel(Jt)).onmessage=function(e){return e.data&&gr(e.data)}})(),typeof nt.unref=="function"&&nt.unref(),On(vt,function(e){kn||nt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!fn.disableBfCache&&e.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),nt!=null&&nt.close();for(var n=0,t=Ue;n<t.length;n++)t[n].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!fn.disableBfCache&&e.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),qr(),gr({all:new Ie(-1/0,[[]])}))})),B.rejectionMapper=function(e,n){return!e||e instanceof pn||e instanceof TypeError||e instanceof SyntaxError||!e.name||!xt[e.name]?e:(n=new xt[e.name](n||e.message,e),"stack"in e&&fe(n,"stack",{get:function(){return this.inner.stack}}),n)},at(Be),$(fn,Object.freeze({__proto__:null,Dexie:fn,liveQuery:Fr,Entity:Rt,cmp:re,PropModification:y,replacePrefix:function(e,n){return new y({replacePrefix:[e,n]})},add:function(e){return new y({add:e})},remove:function(e){return new y({remove:e})},default:fn,RangeSet:Ie,mergeRanges:bt,rangesOverlap:Ir}),{default:fn}),fn})})(Ur);var so=Ur.exports;const _r=Lr(so),Mr=Symbol.for("Dexie"),wr=globalThis[Mr]||(globalThis[Mr]=_r);if(_r.semVer!==wr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_r.semVer} and ${wr.semVer}`);const{liveQuery:lo,mergeRanges:ho,rangesOverlap:po,RangeSet:vo,cmp:yo,Entity:mo,PropModification:go,replacePrefix:bo,add:_o,remove:wo,DexieYProvider:xo}=wr;function Yt(rt){throw new Error('Could not dynamically require "'+rt+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Yr={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(rt,$r){(function(Ke){rt.exports=Ke()})(function(){return function Ke($,Fe,ee){function ie(de,qe){if(!Fe[de]){if(!$[de]){var j=typeof Yt=="function"&&Yt;if(!qe&&j)return j(de,!0);if(V)return V(de,!0);var Q=new Error("Cannot find module '"+de+"'");throw Q.code="MODULE_NOT_FOUND",Q}var ve=Fe[de]={exports:{}};$[de][0].call(ve.exports,function(fe){var xe=$[de][1][fe];return ie(xe||fe)},ve,ve.exports,Ke,$,Fe,ee)}return Fe[de].exports}for(var V=typeof Yt=="function"&&Yt,ue=0;ue<ee.length;ue++)ie(ee[ue]);return ie}({1:[function(Ke,$,Fe){(function(ee){var ie=ee.MutationObserver||ee.WebKitMutationObserver,V;if(ie){var ue=0,de=new ie(fe),qe=ee.document.createTextNode("");de.observe(qe,{characterData:!0}),V=function(){qe.data=ue=++ue%2}}else if(!ee.setImmediate&&typeof ee.MessageChannel<"u"){var j=new ee.MessageChannel;j.port1.onmessage=fe,V=function(){j.port2.postMessage(0)}}else"document"in ee&&"onreadystatechange"in ee.document.createElement("script")?V=function(){var ge=ee.document.createElement("script");ge.onreadystatechange=function(){fe(),ge.onreadystatechange=null,ge.parentNode.removeChild(ge),ge=null},ee.document.documentElement.appendChild(ge)}:V=function(){setTimeout(fe,0)};var Q,ve=[];function fe(){Q=!0;for(var ge,ze,ye=ve.length;ye;){for(ze=ve,ve=[],ge=-1;++ge<ye;)ze[ge]();ye=ve.length}Q=!1}$.exports=xe;function xe(ge){ve.push(ge)===1&&!Q&&V()}}).call(this,typeof tt<"u"?tt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(Ke,$,Fe){var ee=Ke(1);function ie(){}var V={},ue=["REJECTED"],de=["FULFILLED"],qe=["PENDING"];$.exports=j;function j(M){if(typeof M!="function")throw new TypeError("resolver must be a function");this.state=qe,this.queue=[],this.outcome=void 0,M!==ie&&xe(this,M)}j.prototype.catch=function(M){return this.then(null,M)},j.prototype.then=function(M,J){if(typeof M!="function"&&this.state===de||typeof J!="function"&&this.state===ue)return this;var W=new this.constructor(ie);if(this.state!==qe){var se=this.state===de?M:J;ve(W,se,this.outcome)}else this.queue.push(new Q(W,M,J));return W};function Q(M,J,W){this.promise=M,typeof J=="function"&&(this.onFulfilled=J,this.callFulfilled=this.otherCallFulfilled),typeof W=="function"&&(this.onRejected=W,this.callRejected=this.otherCallRejected)}Q.prototype.callFulfilled=function(M){V.resolve(this.promise,M)},Q.prototype.otherCallFulfilled=function(M){ve(this.promise,this.onFulfilled,M)},Q.prototype.callRejected=function(M){V.reject(this.promise,M)},Q.prototype.otherCallRejected=function(M){ve(this.promise,this.onRejected,M)};function ve(M,J,W){ee(function(){var se;try{se=J(W)}catch(we){return V.reject(M,we)}se===M?V.reject(M,new TypeError("Cannot resolve promise with itself")):V.resolve(M,se)})}V.resolve=function(M,J){var W=ge(fe,J);if(W.status==="error")return V.reject(M,W.value);var se=W.value;if(se)xe(M,se);else{M.state=de,M.outcome=J;for(var we=-1,ke=M.queue.length;++we<ke;)M.queue[we].callFulfilled(J)}return M},V.reject=function(M,J){M.state=ue,M.outcome=J;for(var W=-1,se=M.queue.length;++W<se;)M.queue[W].callRejected(J);return M};function fe(M){var J=M&&M.then;if(M&&(typeof M=="object"||typeof M=="function")&&typeof J=="function")return function(){J.apply(M,arguments)}}function xe(M,J){var W=!1;function se(Ee){W||(W=!0,V.reject(M,Ee))}function we(Ee){W||(W=!0,V.resolve(M,Ee))}function ke(){J(we,se)}var De=ge(ke);De.status==="error"&&se(De.value)}function ge(M,J){var W={};try{W.value=M(J),W.status="success"}catch(se){W.status="error",W.value=se}return W}j.resolve=ze;function ze(M){return M instanceof this?M:V.resolve(new this(ie),M)}j.reject=ye;function ye(M){var J=new this(ie);return V.reject(J,M)}j.all=Fn;function Fn(M){var J=this;if(Object.prototype.toString.call(M)!=="[object Array]")return this.reject(new TypeError("must be an array"));var W=M.length,se=!1;if(!W)return this.resolve([]);for(var we=new Array(W),ke=0,De=-1,Ee=new this(ie);++De<W;)Oe(M[De],De);return Ee;function Oe(Pn,ln){J.resolve(Pn).then(In,function(hn){se||(se=!0,V.reject(Ee,hn))});function In(hn){we[ln]=hn,++ke===W&&!se&&(se=!0,V.resolve(Ee,we))}}}j.race=Me;function Me(M){var J=this;if(Object.prototype.toString.call(M)!=="[object Array]")return this.reject(new TypeError("must be an array"));var W=M.length,se=!1;if(!W)return this.resolve([]);for(var we=-1,ke=new this(ie);++we<W;)De(M[we]);return ke;function De(Ee){J.resolve(Ee).then(function(Oe){se||(se=!0,V.resolve(ke,Oe))},function(Oe){se||(se=!0,V.reject(ke,Oe))})}}},{1:1}],3:[function(Ke,$,Fe){(function(ee){typeof ee.Promise!="function"&&(ee.Promise=Ke(2))}).call(this,typeof tt<"u"?tt:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(Ke,$,Fe){var ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function ie(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}function V(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var ue=V();function de(){try{if(!ue||!ue.open)return!1;var a=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),l=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!a||l)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function qe(a,l){a=a||[],l=l||{};try{return new Blob(a,l)}catch(v){if(v.name!=="TypeError")throw v;for(var s=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,y=new s,_=0;_<a.length;_+=1)y.append(a[_]);return y.getBlob(l.type)}}typeof Promise>"u"&&Ke(3);var j=Promise;function Q(a,l){l&&a.then(function(s){l(null,s)},function(s){l(s)})}function ve(a,l,s){typeof l=="function"&&a.then(l),typeof s=="function"&&a.catch(s)}function fe(a){return typeof a!="string"&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function xe(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var ge="local-forage-detect-blob-support",ze=void 0,ye={},Fn=Object.prototype.toString,Me="readonly",M="readwrite";function J(a){for(var l=a.length,s=new ArrayBuffer(l),y=new Uint8Array(s),_=0;_<l;_++)y[_]=a.charCodeAt(_);return s}function W(a){return new j(function(l){var s=a.transaction(ge,M),y=qe([""]);s.objectStore(ge).put(y,"key"),s.onabort=function(_){_.preventDefault(),_.stopPropagation(),l(!1)},s.oncomplete=function(){var _=navigator.userAgent.match(/Chrome\/(\d+)/),v=navigator.userAgent.match(/Edge\//);l(v||!_||parseInt(_[1],10)>=43)}}).catch(function(){return!1})}function se(a){return typeof ze=="boolean"?j.resolve(ze):W(a).then(function(l){return ze=l,ze})}function we(a){var l=ye[a.name],s={};s.promise=new j(function(y,_){s.resolve=y,s.reject=_}),l.deferredOperations.push(s),l.dbReady?l.dbReady=l.dbReady.then(function(){return s.promise}):l.dbReady=s.promise}function ke(a){var l=ye[a.name],s=l.deferredOperations.pop();if(s)return s.resolve(),s.promise}function De(a,l){var s=ye[a.name],y=s.deferredOperations.pop();if(y)return y.reject(l),y.promise}function Ee(a,l){return new j(function(s,y){if(ye[a.name]=ye[a.name]||_t(),a.db)if(l)we(a),a.db.close();else return s(a.db);var _=[a.name];l&&_.push(a.version);var v=ue.open.apply(ue,_);l&&(v.onupgradeneeded=function(P){var k=v.result;try{k.createObjectStore(a.storeName),P.oldVersion<=1&&k.createObjectStore(ge)}catch(A){if(A.name==="ConstraintError")console.warn('The database "'+a.name+'" has been upgraded from version '+P.oldVersion+" to version "+P.newVersion+', but the storage "'+a.storeName+'" already exists.');else throw A}}),v.onerror=function(P){P.preventDefault(),y(v.error)},v.onsuccess=function(){var P=v.result;P.onversionchange=function(k){k.target.close()},s(P),ke(a)}})}function Oe(a){return Ee(a,!1)}function Pn(a){return Ee(a,!0)}function ln(a,l){if(!a.db)return!0;var s=!a.db.objectStoreNames.contains(a.storeName),y=a.version<a.db.version,_=a.version>a.db.version;if(y&&(a.version!==l&&console.warn('The database "'+a.name+`" can't be downgraded from version `+a.db.version+" to version "+a.version+"."),a.version=a.db.version),_||s){if(s){var v=a.db.version+1;v>a.version&&(a.version=v)}return!0}return!1}function In(a){return new j(function(l,s){var y=new FileReader;y.onerror=s,y.onloadend=function(_){var v=btoa(_.target.result||"");l({__local_forage_encoded_blob:!0,data:v,type:a.type})},y.readAsBinaryString(a)})}function hn(a){var l=J(atob(a.data));return qe([l],{type:a.type})}function Qe(a){return a&&a.__local_forage_encoded_blob}function dn(a){var l=this,s=l._initReady().then(function(){var y=ye[l._dbInfo.name];if(y&&y.dbReady)return y.dbReady});return ve(s,a,a),s}function We(a){we(a);for(var l=ye[a.name],s=l.forages,y=0;y<s.length;y++){var _=s[y];_._dbInfo.db&&(_._dbInfo.db.close(),_._dbInfo.db=null)}return a.db=null,Oe(a).then(function(v){return a.db=v,ln(a)?Pn(a):v}).then(function(v){a.db=l.db=v;for(var P=0;P<s.length;P++)s[P]._dbInfo.db=v}).catch(function(v){throw De(a,v),v})}function Le(a,l,s,y){y===void 0&&(y=1);try{var _=a.db.transaction(a.storeName,l);s(null,_)}catch(v){if(y>0&&(!a.db||v.name==="InvalidStateError"||v.name==="NotFoundError"))return j.resolve().then(function(){if(!a.db||v.name==="NotFoundError"&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),Pn(a)}).then(function(){return We(a).then(function(){Le(a,l,s,y-1)})}).catch(s);s(v)}}function _t(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function pn(a){var l=this,s={db:null};if(a)for(var y in a)s[y]=a[y];var _=ye[s.name];_||(_=_t(),ye[s.name]=_),_.forages.push(l),l._initReady||(l._initReady=l.ready,l.ready=dn);var v=[];function P(){return j.resolve()}for(var k=0;k<_.forages.length;k++){var A=_.forages[k];A!==l&&v.push(A._initReady().catch(P))}var R=_.forages.slice(0);return j.all(v).then(function(){return s.db=_.db,Oe(s)}).then(function(T){return s.db=T,ln(s,l._defaultConfig.version)?Pn(s):T}).then(function(T){s.db=_.db=T,l._dbInfo=s;for(var U=0;U<R.length;U++){var X=R[U];X!==l&&(X._dbInfo.db=s.db,X._dbInfo.version=s.version)}})}function wt(a,l){var s=this;a=fe(a);var y=new j(function(_,v){s.ready().then(function(){Le(s._dbInfo,Me,function(P,k){if(P)return v(P);try{var A=k.objectStore(s._dbInfo.storeName),R=A.get(a);R.onsuccess=function(){var T=R.result;T===void 0&&(T=null),Qe(T)&&(T=hn(T)),_(T)},R.onerror=function(){v(R.error)}}catch(T){v(T)}})}).catch(v)});return Q(y,l),y}function qn(a,l){var s=this,y=new j(function(_,v){s.ready().then(function(){Le(s._dbInfo,Me,function(P,k){if(P)return v(P);try{var A=k.objectStore(s._dbInfo.storeName),R=A.openCursor(),T=1;R.onsuccess=function(){var U=R.result;if(U){var X=U.value;Qe(X)&&(X=hn(X));var oe=a(X,U.key,T++);oe!==void 0?_(oe):U.continue()}else _()},R.onerror=function(){v(R.error)}}catch(U){v(U)}})}).catch(v)});return Q(y,l),y}function vn(a,l,s){var y=this;a=fe(a);var _=new j(function(v,P){var k;y.ready().then(function(){return k=y._dbInfo,Fn.call(l)==="[object Blob]"?se(k.db).then(function(A){return A?l:In(l)}):l}).then(function(A){Le(y._dbInfo,M,function(R,T){if(R)return P(R);try{var U=T.objectStore(y._dbInfo.storeName);A===null&&(A=void 0);var X=U.put(A,a);T.oncomplete=function(){A===void 0&&(A=null),v(A)},T.onabort=T.onerror=function(){var oe=X.error?X.error:X.transaction.error;P(oe)}}catch(oe){P(oe)}})}).catch(P)});return Q(_,s),_}function ot(a,l){var s=this;a=fe(a);var y=new j(function(_,v){s.ready().then(function(){Le(s._dbInfo,M,function(P,k){if(P)return v(P);try{var A=k.objectStore(s._dbInfo.storeName),R=A.delete(a);k.oncomplete=function(){_()},k.onerror=function(){v(R.error)},k.onabort=function(){var T=R.error?R.error:R.transaction.error;v(T)}}catch(T){v(T)}})}).catch(v)});return Q(y,l),y}function $t(a){var l=this,s=new j(function(y,_){l.ready().then(function(){Le(l._dbInfo,M,function(v,P){if(v)return _(v);try{var k=P.objectStore(l._dbInfo.storeName),A=k.clear();P.oncomplete=function(){y()},P.onabort=P.onerror=function(){var R=A.error?A.error:A.transaction.error;_(R)}}catch(R){_(R)}})}).catch(_)});return Q(s,a),s}function z(a){var l=this,s=new j(function(y,_){l.ready().then(function(){Le(l._dbInfo,Me,function(v,P){if(v)return _(v);try{var k=P.objectStore(l._dbInfo.storeName),A=k.count();A.onsuccess=function(){y(A.result)},A.onerror=function(){_(A.error)}}catch(R){_(R)}})}).catch(_)});return Q(s,a),s}function xt(a,l){var s=this,y=new j(function(_,v){if(a<0){_(null);return}s.ready().then(function(){Le(s._dbInfo,Me,function(P,k){if(P)return v(P);try{var A=k.objectStore(s._dbInfo.storeName),R=!1,T=A.openKeyCursor();T.onsuccess=function(){var U=T.result;if(!U){_(null);return}a===0||R?_(U.key):(R=!0,U.advance(a))},T.onerror=function(){v(T.error)}}catch(U){v(U)}})}).catch(v)});return Q(y,l),y}function Mn(a){var l=this,s=new j(function(y,_){l.ready().then(function(){Le(l._dbInfo,Me,function(v,P){if(v)return _(v);try{var k=P.objectStore(l._dbInfo.storeName),A=k.openKeyCursor(),R=[];A.onsuccess=function(){var T=A.result;if(!T){y(R);return}R.push(T.key),T.continue()},A.onerror=function(){_(A.error)}}catch(T){_(T)}})}).catch(_)});return Q(s,a),s}function ce(a,l){l=xe.apply(this,arguments);var s=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||s.name,a.storeName=a.storeName||s.storeName);var y=this,_;if(!a.name)_=j.reject("Invalid arguments");else{var v=a.name===s.name&&y._dbInfo.db,P=v?j.resolve(y._dbInfo.db):Oe(a).then(function(k){var A=ye[a.name],R=A.forages;A.db=k;for(var T=0;T<R.length;T++)R[T]._dbInfo.db=k;return k});a.storeName?_=P.then(function(k){if(k.objectStoreNames.contains(a.storeName)){var A=k.version+1;we(a);var R=ye[a.name],T=R.forages;k.close();for(var U=0;U<T.length;U++){var X=T[U];X._dbInfo.db=null,X._dbInfo.version=A}var oe=new j(function(ae,he){var pe=ue.open(a.name,A);pe.onerror=function(Ne){var ne=pe.result;ne.close(),he(Ne)},pe.onupgradeneeded=function(){var Ne=pe.result;Ne.deleteObjectStore(a.storeName)},pe.onsuccess=function(){var Ne=pe.result;Ne.close(),ae(Ne)}});return oe.then(function(ae){R.db=ae;for(var he=0;he<T.length;he++){var pe=T[he];pe._dbInfo.db=ae,ke(pe._dbInfo)}}).catch(function(ae){throw(De(a,ae)||j.resolve()).catch(function(){}),ae})}}):_=P.then(function(k){we(a);var A=ye[a.name],R=A.forages;k.close();for(var T=0;T<R.length;T++){var U=R[T];U._dbInfo.db=null}var X=new j(function(oe,ae){var he=ue.deleteDatabase(a.name);he.onerror=function(){var pe=he.result;pe&&pe.close(),ae(he.error)},he.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')},he.onsuccess=function(){var pe=he.result;pe&&pe.close(),oe(pe)}});return X.then(function(oe){A.db=oe;for(var ae=0;ae<R.length;ae++){var he=R[ae];ke(he._dbInfo)}}).catch(function(oe){throw(De(a,oe)||j.resolve()).catch(function(){}),oe})})}return Q(_,l),_}var An={_driver:"asyncStorage",_initStorage:pn,_support:de(),iterate:qn,getItem:wt,setItem:vn,removeItem:ot,clear:$t,length:z,key:xt,keys:Mn,dropInstance:ce};function zt(){return typeof openDatabase=="function"}var Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wt="~~local_forage_type~",Et=/^~~local_forage_type~([^~]+)~/,Ln="__lfsc__:",it=Ln.length,Rn="arbf",Be="blob",at="si08",yn="ui08",ut="uic8",mn="si16",Ge="si32",Xe="ur16",Un="ui32",gn="fl32",Yn="fl64",Dn=it+Rn.length,He=Object.prototype.toString;function Tn(a){var l=a.length*.75,s=a.length,y,_=0,v,P,k,A;a[a.length-1]==="="&&(l--,a[a.length-2]==="="&&l--);var R=new ArrayBuffer(l),T=new Uint8Array(R);for(y=0;y<s;y+=4)v=Pe.indexOf(a[y]),P=Pe.indexOf(a[y+1]),k=Pe.indexOf(a[y+2]),A=Pe.indexOf(a[y+3]),T[_++]=v<<2|P>>4,T[_++]=(P&15)<<4|k>>2,T[_++]=(k&3)<<6|A&63;return R}function Cn(a){var l=new Uint8Array(a),s="",y;for(y=0;y<l.length;y+=3)s+=Pe[l[y]>>2],s+=Pe[(l[y]&3)<<4|l[y+1]>>4],s+=Pe[(l[y+1]&15)<<2|l[y+2]>>6],s+=Pe[l[y+2]&63];return l.length%3===2?s=s.substring(0,s.length-1)+"=":l.length%3===1&&(s=s.substring(0,s.length-2)+"=="),s}function Je(a,l){var s="";if(a&&(s=He.call(a)),a&&(s==="[object ArrayBuffer]"||a.buffer&&He.call(a.buffer)==="[object ArrayBuffer]")){var y,_=Ln;a instanceof ArrayBuffer?(y=a,_+=Rn):(y=a.buffer,s==="[object Int8Array]"?_+=at:s==="[object Uint8Array]"?_+=yn:s==="[object Uint8ClampedArray]"?_+=ut:s==="[object Int16Array]"?_+=mn:s==="[object Uint16Array]"?_+=Xe:s==="[object Int32Array]"?_+=Ge:s==="[object Uint32Array]"?_+=Un:s==="[object Float32Array]"?_+=gn:s==="[object Float64Array]"?_+=Yn:l(new Error("Failed to get type for BinaryArray"))),l(_+Cn(y))}else if(s==="[object Blob]"){var v=new FileReader;v.onload=function(){var P=Wt+a.type+"~"+Cn(this.result);l(Ln+Be+P)},v.readAsArrayBuffer(a)}else try{l(JSON.stringify(a))}catch(P){console.error("Couldn't convert value into a JSON string: ",a),l(null,P)}}function Y(a){if(a.substring(0,it)!==Ln)return JSON.parse(a);var l=a.substring(Dn),s=a.substring(it,Dn),y;if(s===Be&&Et.test(l)){var _=l.match(Et);y=_[1],l=l.substring(_[0].length)}var v=Tn(l);switch(s){case Rn:return v;case Be:return qe([v],{type:y});case at:return new Int8Array(v);case yn:return new Uint8Array(v);case ut:return new Uint8ClampedArray(v);case mn:return new Int16Array(v);case Xe:return new Uint16Array(v);case Ge:return new Int32Array(v);case Un:return new Uint32Array(v);case gn:return new Float32Array(v);case Yn:return new Float64Array(v);default:throw new Error("Unkown type: "+s)}}var un={serialize:Je,deserialize:Y,stringToBuffer:Tn,bufferToString:Cn};function Ze(a,l,s,y){a.executeSql("CREATE TABLE IF NOT EXISTS "+l.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],s,y)}function $n(a){var l=this,s={db:null};if(a)for(var y in a)s[y]=typeof a[y]!="string"?a[y].toString():a[y];var _=new j(function(v,P){try{s.db=openDatabase(s.name,String(s.version),s.description,s.size)}catch(k){return P(k)}s.db.transaction(function(k){Ze(k,s,function(){l._dbInfo=s,v()},function(A,R){P(R)})},P)});return s.serializer=un,_}function B(a,l,s,y,_,v){a.executeSql(s,y,_,function(P,k){k.code===k.SYNTAX_ERR?P.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[l.storeName],function(A,R){R.rows.length?v(A,k):Ze(A,l,function(){A.executeSql(s,y,_,v)},v)},v):v(P,k)},v)}function st(a,l){var s=this;a=fe(a);var y=new j(function(_,v){s.ready().then(function(){var P=s._dbInfo;P.db.transaction(function(k){B(k,P,"SELECT * FROM "+P.storeName+" WHERE key = ? LIMIT 1",[a],function(A,R){var T=R.rows.length?R.rows.item(0).value:null;T&&(T=P.serializer.deserialize(T)),_(T)},function(A,R){v(R)})})}).catch(v)});return Q(y,l),y}function St(a,l){var s=this,y=new j(function(_,v){s.ready().then(function(){var P=s._dbInfo;P.db.transaction(function(k){B(k,P,"SELECT * FROM "+P.storeName,[],function(A,R){for(var T=R.rows,U=T.length,X=0;X<U;X++){var oe=T.item(X),ae=oe.value;if(ae&&(ae=P.serializer.deserialize(ae)),ae=a(ae,oe.key,X+1),ae!==void 0){_(ae);return}}_()},function(A,R){v(R)})})}).catch(v)});return Q(y,l),y}function zn(a,l,s,y){var _=this;a=fe(a);var v=new j(function(P,k){_.ready().then(function(){l===void 0&&(l=null);var A=l,R=_._dbInfo;R.serializer.serialize(l,function(T,U){U?k(U):R.db.transaction(function(X){B(X,R,"INSERT OR REPLACE INTO "+R.storeName+" (key, value) VALUES (?, ?)",[a,T],function(){P(A)},function(oe,ae){k(ae)})},function(X){if(X.code===X.QUOTA_ERR){if(y>0){P(zn.apply(_,[a,A,s,y-1]));return}k(X)}})})}).catch(k)});return Q(v,s),v}function Ot(a,l,s){return zn.apply(this,[a,l,s,1])}function ct(a,l){var s=this;a=fe(a);var y=new j(function(_,v){s.ready().then(function(){var P=s._dbInfo;P.db.transaction(function(k){B(k,P,"DELETE FROM "+P.storeName+" WHERE key = ?",[a],function(){_()},function(A,R){v(R)})})}).catch(v)});return Q(y,l),y}function Vt(a){var l=this,s=new j(function(y,_){l.ready().then(function(){var v=l._dbInfo;v.db.transaction(function(P){B(P,v,"DELETE FROM "+v.storeName,[],function(){y()},function(k,A){_(A)})})}).catch(_)});return Q(s,a),s}function Qt(a){var l=this,s=new j(function(y,_){l.ready().then(function(){var v=l._dbInfo;v.db.transaction(function(P){B(P,v,"SELECT COUNT(key) as c FROM "+v.storeName,[],function(k,A){var R=A.rows.item(0).c;y(R)},function(k,A){_(A)})})}).catch(_)});return Q(s,a),s}function bn(a,l){var s=this,y=new j(function(_,v){s.ready().then(function(){var P=s._dbInfo;P.db.transaction(function(k){B(k,P,"SELECT key FROM "+P.storeName+" WHERE id = ? LIMIT 1",[a+1],function(A,R){var T=R.rows.length?R.rows.item(0).key:null;_(T)},function(A,R){v(R)})})}).catch(v)});return Q(y,l),y}function _n(a){var l=this,s=new j(function(y,_){l.ready().then(function(){var v=l._dbInfo;v.db.transaction(function(P){B(P,v,"SELECT key FROM "+v.storeName,[],function(k,A){for(var R=[],T=0;T<A.rows.length;T++)R.push(A.rows.item(T).key);y(R)},function(k,A){_(A)})})}).catch(_)});return Q(s,a),s}function ft(a){return new j(function(l,s){a.transaction(function(y){y.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(_,v){for(var P=[],k=0;k<v.rows.length;k++)P.push(v.rows.item(k).name);l({db:a,storeNames:P})},function(_,v){s(v)})},function(y){s(y)})})}function Wn(a,l){l=xe.apply(this,arguments);var s=this.config();a=typeof a!="function"&&a||{},a.name||(a.name=a.name||s.name,a.storeName=a.storeName||s.storeName);var y=this,_;return a.name?_=new j(function(v){var P;a.name===s.name?P=y._dbInfo.db:P=openDatabase(a.name,"","",0),a.storeName?v({db:P,storeNames:[a.storeName]}):v(ft(P))}).then(function(v){return new j(function(P,k){v.db.transaction(function(A){function R(oe){return new j(function(ae,he){A.executeSql("DROP TABLE IF EXISTS "+oe,[],function(){ae()},function(pe,Ne){he(Ne)})})}for(var T=[],U=0,X=v.storeNames.length;U<X;U++)T.push(R(v.storeNames[U]));j.all(T).then(function(){P()}).catch(function(oe){k(oe)})},function(A){k(A)})})}):_=j.reject("Invalid arguments"),Q(_,l),_}var le={_driver:"webSQLStorage",_initStorage:$n,_support:zt(),iterate:St,getItem:st,setItem:Ot,removeItem:ct,clear:Vt,length:Qt,key:bn,keys:_n,dropInstance:Wn};function _e(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function kt(a,l){var s=a.name+"/";return a.storeName!==l.storeName&&(s+=a.storeName+"/"),s}function Vn(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch{return!0}}function Qn(){return!Vn()||localStorage.length>0}function Gn(a){var l=this,s={};if(a)for(var y in a)s[y]=a[y];return s.keyPrefix=kt(a,l._defaultConfig),Qn()?(l._dbInfo=s,s.serializer=un,j.resolve()):j.reject()}function Gt(a){var l=this,s=l.ready().then(function(){for(var y=l._dbInfo.keyPrefix,_=localStorage.length-1;_>=0;_--){var v=localStorage.key(_);v.indexOf(y)===0&&localStorage.removeItem(v)}});return Q(s,a),s}function en(a,l){var s=this;a=fe(a);var y=s.ready().then(function(){var _=s._dbInfo,v=localStorage.getItem(_.keyPrefix+a);return v&&(v=_.serializer.deserialize(v)),v});return Q(y,l),y}function wn(a,l){var s=this,y=s.ready().then(function(){for(var _=s._dbInfo,v=_.keyPrefix,P=v.length,k=localStorage.length,A=1,R=0;R<k;R++){var T=localStorage.key(R);if(T.indexOf(v)===0){var U=localStorage.getItem(T);if(U&&(U=_.serializer.deserialize(U)),U=a(U,T.substring(P),A++),U!==void 0)return U}}});return Q(y,l),y}function nn(a,l){var s=this,y=s.ready().then(function(){var _=s._dbInfo,v;try{v=localStorage.key(a)}catch{v=null}return v&&(v=v.substring(_.keyPrefix.length)),v});return Q(y,l),y}function Xn(a){var l=this,s=l.ready().then(function(){for(var y=l._dbInfo,_=localStorage.length,v=[],P=0;P<_;P++){var k=localStorage.key(P);k.indexOf(y.keyPrefix)===0&&v.push(k.substring(y.keyPrefix.length))}return v});return Q(s,a),s}function Xt(a){var l=this,s=l.keys().then(function(y){return y.length});return Q(s,a),s}function tn(a,l){var s=this;a=fe(a);var y=s.ready().then(function(){var _=s._dbInfo;localStorage.removeItem(_.keyPrefix+a)});return Q(y,l),y}function Pt(a,l,s){var y=this;a=fe(a);var _=y.ready().then(function(){l===void 0&&(l=null);var v=l;return new j(function(P,k){var A=y._dbInfo;A.serializer.serialize(l,function(R,T){if(T)k(T);else try{localStorage.setItem(A.keyPrefix+a,R),P(v)}catch(U){(U.name==="QuotaExceededError"||U.name==="NS_ERROR_DOM_QUOTA_REACHED")&&k(U),k(U)}})})});return Q(_,s),_}function sn(a,l){if(l=xe.apply(this,arguments),a=typeof a!="function"&&a||{},!a.name){var s=this.config();a.name=a.name||s.name,a.storeName=a.storeName||s.storeName}var y=this,_;return a.name?_=new j(function(v){a.storeName?v(kt(a,y._defaultConfig)):v(a.name+"/")}).then(function(v){for(var P=localStorage.length-1;P>=0;P--){var k=localStorage.key(P);k.indexOf(v)===0&&localStorage.removeItem(k)}}):_=j.reject("Invalid arguments"),Q(_,l),_}var It={_driver:"localStorageWrapper",_initStorage:Gn,_support:_e(),iterate:wn,getItem:en,setItem:Pt,removeItem:tn,clear:Gt,length:Xt,key:nn,keys:Xn,dropInstance:sn},lt=function(l,s){return l===s||typeof l=="number"&&typeof s=="number"&&isNaN(l)&&isNaN(s)},me=function(l,s){for(var y=l.length,_=0;_<y;){if(lt(l[_],s))return!0;_++}return!1},rn=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},Te={},ht={},Ue={INDEXEDDB:An,WEBSQL:le,LOCALSTORAGE:It},Hn=[Ue.INDEXEDDB._driver,Ue.WEBSQL._driver,Ue.LOCALSTORAGE._driver],xn=["dropInstance"],Kn=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(xn),cn={description:"",driver:Hn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function At(a,l){a[l]=function(){var s=arguments;return a.ready().then(function(){return a[l].apply(a,s)})}}function En(){for(var a=1;a<arguments.length;a++){var l=arguments[a];if(l)for(var s in l)l.hasOwnProperty(s)&&(rn(l[s])?arguments[0][s]=l[s].slice():arguments[0][s]=l[s])}return arguments[0]}var Rt=function(){function a(l){ie(this,a);for(var s in Ue)if(Ue.hasOwnProperty(s)){var y=Ue[s],_=y._driver;this[s]=_,Te[_]||this.defineDriver(y)}this._defaultConfig=En({},cn),this._config=En({},this._defaultConfig,l),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(s){if((typeof s>"u"?"undefined":ee(s))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var y in s){if(y==="storeName"&&(s[y]=s[y].replace(/\W/g,"_")),y==="version"&&typeof s[y]!="number")return new Error("Database version must be a number.");this._config[y]=s[y]}return"driver"in s&&s.driver?this.setDriver(this._config.driver):!0}else return typeof s=="string"?this._config[s]:this._config},a.prototype.defineDriver=function(s,y,_){var v=new j(function(P,k){try{var A=s._driver,R=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!s._driver){k(R);return}for(var T=Kn.concat("_initStorage"),U=0,X=T.length;U<X;U++){var oe=T[U],ae=!me(xn,oe);if((ae||s[oe])&&typeof s[oe]!="function"){k(R);return}}var he=function(){for(var ne=function(Sn){return function(){var Zn=new Error("Method "+Sn+" is not implemented by the current driver"),Ve=j.reject(Zn);return Q(Ve,arguments[arguments.length-1]),Ve}},Jn=0,Ht=xn.length;Jn<Ht;Jn++){var dt=xn[Jn];s[dt]||(s[dt]=ne(dt))}};he();var pe=function(ne){Te[A]&&console.info("Redefining LocalForage driver: "+A),Te[A]=s,ht[A]=ne,P()};"_support"in s?s._support&&typeof s._support=="function"?s._support().then(pe,k):pe(!!s._support):pe(!0)}catch(Ne){k(Ne)}});return ve(v,y,_),v},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(s,y,_){var v=Te[s]?j.resolve(Te[s]):j.reject(new Error("Driver not found."));return ve(v,y,_),v},a.prototype.getSerializer=function(s){var y=j.resolve(un);return ve(y,s),y},a.prototype.ready=function(s){var y=this,_=y._driverSet.then(function(){return y._ready===null&&(y._ready=y._initDriver()),y._ready});return ve(_,s,s),_},a.prototype.setDriver=function(s,y,_){var v=this;rn(s)||(s=[s]);var P=this._getSupportedDrivers(s);function k(){v._config.driver=v.driver()}function A(U){return v._extend(U),k(),v._ready=v._initStorage(v._config),v._ready}function R(U){return function(){var X=0;function oe(){for(;X<U.length;){var ae=U[X];return X++,v._dbInfo=null,v._ready=null,v.getDriver(ae).then(A).catch(oe)}k();var he=new Error("No available storage method found.");return v._driverSet=j.reject(he),v._driverSet}return oe()}}var T=this._driverSet!==null?this._driverSet.catch(function(){return j.resolve()}):j.resolve();return this._driverSet=T.then(function(){var U=P[0];return v._dbInfo=null,v._ready=null,v.getDriver(U).then(function(X){v._driver=X._driver,k(),v._wrapLibraryMethodsWithReady(),v._initDriver=R(P)})}).catch(function(){k();var U=new Error("No available storage method found.");return v._driverSet=j.reject(U),v._driverSet}),ve(this._driverSet,y,_),this._driverSet},a.prototype.supports=function(s){return!!ht[s]},a.prototype._extend=function(s){En(this,s)},a.prototype._getSupportedDrivers=function(s){for(var y=[],_=0,v=s.length;_<v;_++){var P=s[_];this.supports(P)&&y.push(P)}return y},a.prototype._wrapLibraryMethodsWithReady=function(){for(var s=0,y=Kn.length;s<y;s++)At(this,Kn[s])},a.prototype.createInstance=function(s){return new a(s)},a}(),re=new Rt;$.exports=re},{3:3}]},{},[4])(4)})})(Yr);var co=Yr.exports;const Eo=Lr(co);export{wr as D,Eo as l};
