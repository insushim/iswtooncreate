import{j as e,m as k,A as ne}from"./ui-D_LkVF2r.js";import{r as f,d as ue,u as be,e as je}from"./vendor-Vqvh67Lm.js";import{D as oe,p as U}from"./parseJsonResponse-BC4W7KvA.js";import{S as ye}from"./Slider-B58Hgk20.js";import{I as H,T as F,L as V,u as D,b as fe}from"./index-BUU0P7GT.js";import{B as E}from"./Button-C3O7gUUW.js";import{g as Y,C as W}from"./GeminiService-CuSaiY5Y.js";import{B as le,P as Ne}from"./Badge-BSkIqIZk.js";import"./storage-BBQgdv-R.js";import"./ai-BpRkNtKl.js";const ve=[{value:"all",label:"ì „ì²´ ì´ìš©ê°€"},{value:"teens",label:"10ëŒ€"},{value:"20s",label:"20ëŒ€"},{value:"30plus",label:"30ëŒ€ ì´ìƒ"}],we=({data:s,updateData:d})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ì‘í’ˆì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ì´ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê¸°íšì˜ë„ì„œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤"})]}),e.jsx(H,{label:"ì‘í’ˆ ì œëª©",placeholder:"ì˜ˆ: ì–´ëŠ ë‚  ê³µì£¼ê°€ ë˜ì–´ë²„ë ¸ë‹¤",value:s.title,onChange:i=>d({title:i.target.value})}),e.jsx(F,{label:"ì‘í’ˆ ì»¨ì…‰ (ê°„ë‹¨í•œ ì„¤ëª…)",placeholder:"ì˜ˆ: í˜„ëŒ€ ì§ì¥ì¸ì´ ì´ì„¸ê³„ì˜ ì•…ì—­ ê³µì£¼ë¡œ ë¹™ì˜í•˜ì—¬ ì£½ìŒì„ í”¼í•˜ê¸° ìœ„í•´ ê³ êµ°ë¶„íˆ¬í•˜ëŠ” ë¡œë§¨ìŠ¤ íŒíƒ€ì§€",value:s.briefConcept,onChange:i=>d({briefConcept:i.target.value}),rows:4,showCount:!0,maxLength:500}),e.jsx(oe,{label:"íƒ€ê²Ÿ ë…ìì¸µ",options:ve,value:s.targetAudience,onChange:i=>d({targetAudience:i})}),e.jsx(ye,{label:"ì˜ˆìƒ íšŒì°¨ ìˆ˜",value:s.episodeCount,onChange:i=>d({episodeCount:i}),min:5,max:200,step:5,formatValue:i=>`${i}í™”`}),e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4 border border-gray-600",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"ì…ë ¥ íŒ"}),e.jsxs("ul",{className:"text-sm text-gray-500 space-y-1",children:[e.jsx("li",{children:"â€¢ ì œëª©ì€ ì‘í’ˆì˜ ë¶„ìœ„ê¸°ë¥¼ ì˜ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤"}),e.jsx("li",{children:"â€¢ ì»¨ì…‰ì—ëŠ” ì£¼ì¸ê³µ, ë°°ê²½, í•µì‹¬ ê°ˆë“±ì„ í¬í•¨í•´ì£¼ì„¸ìš”"}),e.jsx("li",{children:"â€¢ íšŒì°¨ ìˆ˜ëŠ” ë‚˜ì¤‘ì— ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"})]})]})]}),me=[{id:"romance",label:"ë¡œë§¨ìŠ¤",icon:"ğŸ’•",color:"pink"},{id:"action",label:"ì•¡ì…˜",icon:"âš”ï¸",color:"red"},{id:"fantasy",label:"íŒíƒ€ì§€",icon:"ğŸ§™",color:"purple"},{id:"slice-of-life",label:"ì¼ìƒ",icon:"â˜•",color:"green"},{id:"thriller",label:"ìŠ¤ë¦´ëŸ¬",icon:"ğŸ”ª",color:"gray"},{id:"comedy",label:"ì½”ë¯¸ë””",icon:"ğŸ˜‚",color:"yellow"},{id:"sci-fi",label:"SF",icon:"ğŸš€",color:"blue"},{id:"drama",label:"ë“œë¼ë§ˆ",icon:"ğŸ­",color:"orange"},{id:"horror",label:"í˜¸ëŸ¬",icon:"ğŸ‘»",color:"slate"},{id:"mystery",label:"ë¯¸ìŠ¤í„°ë¦¬",icon:"ğŸ”",color:"indigo"}],Ce=[{id:"korean-webtoon",label:"í•œêµ­ ì›¹íˆ°",description:"ê¹”ë”í•œ ì„ í™”ì™€ ë°ì€ ìƒ‰ê°",preview:"ğŸ‡°ğŸ‡·"},{id:"japanese-manga",label:"ì¼ë³¸ ë§Œí™”",description:"ìŠ¤í¬ë¦°í†¤ê³¼ ì—­ë™ì  êµ¬ë„",preview:"ğŸ‡¯ğŸ‡µ"},{id:"american-comic",label:"ë¯¸êµ­ ì½”ë¯¹ìŠ¤",description:"êµµì€ ì„ ê³¼ ê°•ë ¬í•œ ì±„ìƒ‰",preview:"ğŸ‡ºğŸ‡¸"},{id:"pastel-soft",label:"íŒŒìŠ¤í…” í†¤",description:"ë¶€ë“œëŸ½ê³  ë”°ëœ»í•œ ë¶„ìœ„ê¸°",preview:"ğŸ¨"},{id:"watercolor",label:"ìˆ˜ì±„í™”",description:"ì€ì€í•˜ê³  ê°ì„±ì ì¸ ìŠ¤íƒ€ì¼",preview:"ğŸ’§"},{id:"noir-contrast",label:"ëŠì™€ë¥´",description:"ê°•í•œ ëª…ì•” ëŒ€ë¹„",preview:"ğŸŒ‘"},{id:"chibi-cute",label:"ì¹˜ë¹„/ê·€ì—¬ì›€",description:"í° ëˆˆê³¼ ë‹¨ìˆœí™”ëœ ì²´í˜•",preview:"ğŸ¥°"},{id:"realistic",label:"ì‚¬ì‹¤ì ",description:"ì„¸ë°€í•œ ë¬˜ì‚¬ì™€ ë””í…Œì¼",preview:"ğŸ“·"}],ke=["ë°ì€","ì–´ë‘ìš´","ë”°ëœ»í•œ","ì°¨ê°€ìš´","ê¸´ì¥ê°","í¸ì•ˆí•œ","ì‹ ë¹„ë¡œìš´","ìœ ì¾Œí•œ","ê°ì„±ì ","ì—­ë™ì ","ëª½í™˜ì ","ì”ì”í•œ"],Se=({data:s,updateData:d})=>{const i=l=>{s.genre===l?d({genre:""}):d({genre:l})},r=l=>{const a=s.subGenres.includes(l)?s.subGenres.filter(h=>h!==l):[...s.subGenres,l].slice(0,3);d({subGenres:a})},m=l=>{const a=s.mood.includes(l)?s.mood.filter(h=>h!==l):[...s.mood,l].slice(0,4);d({mood:a})};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ì¥ë¥´ì™€ ìŠ¤íƒ€ì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ì„ íƒí•œ ìŠ¤íƒ€ì¼ì— ë§ì¶° ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ë©”ì¸ ì¥ë¥´ (1ê°œ ì„ íƒ)"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:me.map(l=>e.jsxs(k.button,{onClick:()=>i(l.id),whileHover:{scale:1.05},whileTap:{scale:.95},className:`
                p-4 rounded-xl border-2 transition-all duration-200
                flex flex-col items-center justify-center gap-2
                ${s.genre===l.id?"border-purple-500 bg-purple-500/20":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}
              `,children:[e.jsx("span",{className:"text-2xl",children:l.icon}),e.jsx("span",{className:"text-sm font-medium text-white",children:l.label})]},l.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ì„œë¸Œ ì¥ë¥´ (ìµœëŒ€ 3ê°œ)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:me.filter(l=>l.id!==s.genre).map(l=>e.jsxs(k.button,{onClick:()=>r(l.id),whileHover:{scale:1.05},whileTap:{scale:.95},className:`
                  px-4 py-2 rounded-full text-sm font-medium
                  transition-all duration-200
                  ${s.subGenres.includes(l.id)?"bg-purple-500/30 text-purple-300 border border-purple-500":"bg-gray-700 text-gray-400 border border-gray-600 hover:border-gray-500"}
                `,children:[l.icon," ",l.label]},l.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ì•„íŠ¸ ìŠ¤íƒ€ì¼"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:Ce.map(l=>e.jsxs(k.button,{onClick:()=>d({artStyle:l.id}),whileHover:{scale:1.02},whileTap:{scale:.98},className:`
                p-4 rounded-xl border-2 transition-all duration-200 text-left
                ${s.artStyle===l.id?"border-purple-500 bg-purple-500/20":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}
              `,children:[e.jsx("span",{className:"text-3xl mb-2 block",children:l.preview}),e.jsx("span",{className:"text-sm font-medium text-white block",children:l.label}),e.jsx("span",{className:"text-xs text-gray-400",children:l.description})]},l.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ë¶„ìœ„ê¸° (ìµœëŒ€ 4ê°œ)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ke.map(l=>e.jsx(k.button,{onClick:()=>m(l),whileHover:{scale:1.05},whileTap:{scale:.95},className:`
                px-4 py-2 rounded-full text-sm font-medium
                transition-all duration-200
                ${s.mood.includes(l)?"bg-pink-500/30 text-pink-300 border border-pink-500":"bg-gray-700 text-gray-400 border border-gray-600 hover:border-gray-500"}
              `,children:l},l))})]})]})},$e=({data:s,updateData:d,isGenerating:i,setIsGenerating:r})=>{const[m,l]=f.useState(null),a=async()=>{if(!s.title||!s.briefConcept||!s.genre){l("ê¸°ë³¸ ì •ë³´ì™€ ì¥ë¥´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.");return}r(!0),l(null);try{const o=`
        ì›¹íˆ° ê¸°íšì˜ë„ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

        ì‘í’ˆ ì •ë³´:
        - ì œëª©: ${s.title}
        - ì¥ë¥´: ${s.genre} ${s.subGenres.length>0?`(ì„œë¸Œ: ${s.subGenres.join(", ")})`:""}
        - ì»¨ì…‰: ${s.briefConcept}
        - íƒ€ê²Ÿ: ${s.targetAudience}
        - ë¶„ìœ„ê¸°: ${s.mood.join(", ")}
        - ì˜ˆìƒ íšŒì°¨: ${s.episodeCount}í™”

        ë‹¤ìŒ í•­ëª©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
        {
          "synopsis": "3-5ë¬¸ì¥ì˜ ì‹œë†‰ì‹œìŠ¤",
          "coreMessage": "ì´ ì‘í’ˆì´ ì „ë‹¬í•˜ê³ ì í•˜ëŠ” í•µì‹¬ ë©”ì‹œì§€",
          "targetAnalysis": "íƒ€ê²Ÿ ë…ìì¸µ ë¶„ì„ ë° ê·¸ë“¤ì´ ì´ ì‘í’ˆì— ëŒë¦´ ì´ìœ ",
          "uniquePoints": ["ì°¨ë³„í™” í¬ì¸íŠ¸ 1", "ì°¨ë³„í™” í¬ì¸íŠ¸ 2", "ì°¨ë³„í™” í¬ì¸íŠ¸ 3"],
          "expectedDirection": "ì˜ˆìƒ ì „ê°œ ë°©í–¥ ë° ê²°ë§ íŒíŠ¸"
        }
      `,g=await Y.generateText(o,{temperature:.7,maxTokens:8192}),c=U(g);d({planning:c})}catch(o){console.error("Planning generation failed:",o),l("ê¸°íšì„œ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{r(!1)}},h=(o,g)=>{s.planning&&d({planning:{...s.planning,[o]:g}})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"AI ê¸°íšì˜ë„ì„œ"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ì…ë ¥í•œ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê¸°íšì˜ë„ì„œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤"})]}),s.planning?e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium text-purple-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center",children:"ğŸ“–"}),"ì‹œë†‰ì‹œìŠ¤"]}),e.jsx(F,{value:s.planning.synopsis,onChange:o=>h("synopsis",o.target.value),rows:4,className:"bg-gray-700/50"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium text-pink-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-pink-500/20 flex items-center justify-center",children:"ğŸ’¡"}),"í•µì‹¬ ë©”ì‹œì§€"]}),e.jsx(F,{value:s.planning.coreMessage,onChange:o=>h("coreMessage",o.target.value),rows:2,className:"bg-gray-700/50"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium text-blue-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center",children:"ğŸ¯"}),"íƒ€ê²Ÿ ë¶„ì„"]}),e.jsx(F,{value:s.planning.targetAnalysis,onChange:o=>h("targetAnalysis",o.target.value),rows:3,className:"bg-gray-700/50"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium text-green-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-green-500/20 flex items-center justify-center",children:"âœ¨"}),"ì°¨ë³„í™” í¬ì¸íŠ¸"]}),e.jsx("ul",{className:"space-y-2",children:s.planning.uniquePoints.map((o,g)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-green-400 font-medium",children:[g+1,"."]}),e.jsx("input",{type:"text",value:o,onChange:c=>{const t=[...s.planning.uniquePoints];t[g]=c.target.value,h("uniquePoints",t)},className:"flex-1 bg-gray-700/50 border border-gray-600 rounded-lg px-3 py-2 text-white"})]},g))})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium text-orange-400 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-orange-500/20 flex items-center justify-center",children:"ğŸš€"}),"ì˜ˆìƒ ì „ê°œ ë°©í–¥"]}),e.jsx(F,{value:s.planning.expectedDirection,onChange:o=>h("expectedDirection",o.target.value),rows:3,className:"bg-gray-700/50"})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(E,{variant:"ghost",onClick:a,disabled:i,loading:i,children:"ë‹¤ì‹œ ìƒì„±í•˜ê¸°"})})]}):e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:i?e.jsxs("div",{className:"text-center",children:[e.jsx(V,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ê¸°íšì„œë¥¼ ì‘ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"ì•½ 10-20ì´ˆ ì†Œìš”ë©ë‹ˆë‹¤"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-purple-500/20 flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-12 h-12 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ê¸°íšì˜ë„ì„œ ìƒì„± ì¤€ë¹„ ì™„ë£Œ"}),e.jsx("p",{className:"text-gray-400 text-center mb-6 max-w-md",children:"ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ AIê°€ ì…ë ¥í•˜ì‹  ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê¸°íšì˜ë„ì„œë¥¼ ìë™ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤."}),e.jsx(E,{onClick:a,variant:"primary",size:"lg",children:"ê¸°íšì„œ ìƒì„±í•˜ê¸°"}),m&&e.jsx("p",{className:"text-red-400 mt-4",children:m})]})})]})},Pe=({data:s,updateData:d,isGenerating:i,setIsGenerating:r})=>{const[m,l]=f.useState(null),a=async()=>{if(!s.planning){l("ë¨¼ì € ê¸°íšì˜ë„ì„œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.");return}r(!0),l(null);try{const o=`
        ì›¹íˆ° ì„¸ê³„ê´€ ì„¤ì •ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.

        ì‘í’ˆ ì •ë³´:
        - ì œëª©: ${s.title}
        - ì¥ë¥´: ${s.genre}
        - ì‹œë†‰ì‹œìŠ¤: ${s.planning.synopsis}

        ë‹¤ìŒ í•­ëª©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•´ì£¼ì„¸ìš”:
        {
          "era": "ì‹œëŒ€ì  ë°°ê²½ (ì˜ˆ: í˜„ëŒ€, ì¤‘ì„¸ íŒíƒ€ì§€, ê·¼ë¯¸ë˜ ë“±)",
          "setting": "ì£¼ìš” ë¬´ëŒ€ ì„¤ëª… (2-3ë¬¸ì¥)",
          "mainLocations": [
            {
              "id": "loc1",
              "name": "ì¥ì†Œ ì´ë¦„",
              "description": "ì¥ì†Œ ì„¤ëª…",
              "significance": "ìŠ¤í† ë¦¬ì—ì„œì˜ ì¤‘ìš”ì„±",
              "variations": []
            }
          ],
          "specialRules": ["ì„¸ê³„ê´€ íŠ¹ìˆ˜ ê·œì¹™ 1", "ê·œì¹™ 2"],
          "socialStructure": "ì‚¬íšŒ êµ¬ì¡° ì„¤ëª… (ì„ íƒ)",
          "technology": "ê¸°ìˆ  ìˆ˜ì¤€ ì„¤ëª… (ì„ íƒ)"
        }

        mainLocationsëŠ” 3-5ê°œ ì •ë„ ìƒì„±í•´ì£¼ì„¸ìš”.
      `,g=await Y.generateText(o,{temperature:.7}),c=U(g);d({worldBuilding:c})}catch(o){console.error("World building generation failed:",o),l("ì„¸ê³„ê´€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{r(!1)}},h=(o,g)=>{s.worldBuilding&&d({worldBuilding:{...s.worldBuilding,[o]:g}})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ì„¸ê³„ê´€ ì„¤ì •"}),e.jsx("p",{className:"text-gray-400",children:"ì‘í’ˆì˜ ë°°ê²½ì´ ë˜ëŠ” ì„¸ê³„ê´€ì„ êµ¬ì¶•í•©ë‹ˆë‹¤"})]}),s.worldBuilding?e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-sm font-medium text-cyan-400 mb-2",children:"ì‹œëŒ€ì  ë°°ê²½"}),e.jsx(H,{value:s.worldBuilding.era,onChange:o=>h("era",o.target.value),className:"bg-gray-700/50"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-sm font-medium text-cyan-400 mb-2",children:"ê¸°ìˆ  ìˆ˜ì¤€"}),e.jsx(H,{value:s.worldBuilding.technology||"",onChange:o=>h("technology",o.target.value),className:"bg-gray-700/50"})]})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ì£¼ìš” ë¬´ëŒ€ ì„¤ëª…"}),e.jsx(F,{value:s.worldBuilding.setting,onChange:o=>h("setting",o.target.value),rows:3,className:"bg-gray-700/50"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"ì£¼ìš” ì¥ì†Œ"}),e.jsx("div",{className:"space-y-4",children:s.worldBuilding.mainLocations.map((o,g)=>e.jsx("div",{className:"bg-gray-700/50 rounded-lg p-4 border border-gray-600",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-xl flex-shrink-0",children:"ğŸ“"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(H,{value:o.name,onChange:c=>{const t=[...s.worldBuilding.mainLocations];t[g]={...o,name:c.target.value},h("mainLocations",t)},className:"bg-gray-800/50 font-medium",placeholder:"ì¥ì†Œ ì´ë¦„"}),e.jsx(F,{value:o.description,onChange:c=>{const t=[...s.worldBuilding.mainLocations];t[g]={...o,description:c.target.value},h("mainLocations",t)},rows:2,className:"bg-gray-800/50 text-sm",placeholder:"ì¥ì†Œ ì„¤ëª…"}),e.jsx(H,{value:o.significance,onChange:c=>{const t=[...s.worldBuilding.mainLocations];t[g]={...o,significance:c.target.value},h("mainLocations",t)},className:"bg-gray-800/50 text-sm text-gray-400",placeholder:"ìŠ¤í† ë¦¬ì—ì„œì˜ ì¤‘ìš”ì„±"})]})]})},o.id||g))})]}),s.worldBuilding.specialRules&&s.worldBuilding.specialRules.length>0&&e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"ì„¸ê³„ê´€ íŠ¹ìˆ˜ ê·œì¹™"}),e.jsx("ul",{className:"space-y-2",children:s.worldBuilding.specialRules.map((o,g)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"âš¡"}),e.jsx("input",{type:"text",value:o,onChange:c=>{const t=[...s.worldBuilding.specialRules||[]];t[g]=c.target.value,h("specialRules",t)},className:"flex-1 bg-gray-700/50 border border-gray-600 rounded-lg px-3 py-2 text-white"})]},g))})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(E,{variant:"ghost",onClick:a,disabled:i,loading:i,children:"ë‹¤ì‹œ ìƒì„±í•˜ê¸°"})})]}):e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:i?e.jsxs("div",{className:"text-center",children:[e.jsx(V,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ì„¸ê³„ê´€ì„ êµ¬ì¶•í•˜ê³  ìˆìŠµë‹ˆë‹¤..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-cyan-500/20 flex items-center justify-center mb-6",children:e.jsx("span",{className:"text-5xl",children:"ğŸŒ"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ì„¸ê³„ê´€ ì„¤ì • ìƒì„±"}),e.jsx("p",{className:"text-gray-400 text-center mb-6 max-w-md",children:"ê¸°íšì˜ë„ì„œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘í’ˆì˜ ì„¸ê³„ê´€ì„ ìë™ìœ¼ë¡œ êµ¬ì¶•í•©ë‹ˆë‹¤."}),e.jsx(E,{onClick:a,variant:"primary",size:"lg",children:"ì„¸ê³„ê´€ ìƒì„±í•˜ê¸°"}),m&&e.jsx("p",{className:"text-red-400 mt-4",children:m})]})})]})},xe=[{value:"protagonist",label:"ì£¼ì¸ê³µ"},{value:"antagonist",label:"ì ëŒ€ì"},{value:"supporting",label:"ì¡°ì—°"},{value:"minor",label:"ë‹¨ì—­"}],Ee=[{value:"male",label:"ë‚¨ì„±"},{value:"female",label:"ì—¬ì„±"},{value:"non-binary",label:"ë…¼ë°”ì´ë„ˆë¦¬"},{value:"other",label:"ê¸°íƒ€"}],Ae=({data:s,updateData:d,isGenerating:i,setIsGenerating:r})=>{const[m,l]=f.useState(null),[a,h]=f.useState(null),o=async()=>{if(!s.planning||!s.worldBuilding){l("ë¨¼ì € ê¸°íšì˜ë„ì„œì™€ ì„¸ê³„ê´€ì„ ìƒì„±í•´ì£¼ì„¸ìš”.");return}r(!0),l(null);try{const t=s.episodeCount<=20?5:s.episodeCount<=50?7:10,u=`ì›¹íˆ° "${s.title}" (${s.genre})ì˜ ìºë¦­í„° ${t}ëª…ì„ JSONìœ¼ë¡œ ìƒì„±.

ì‹œë†‰ì‹œìŠ¤: ${s.planning.synopsis}

ì¤‘ìš”: JSONë§Œ ì¶œë ¥. ì„¤ëª… ì—†ì´ ë°”ë¡œ { ë¡œ ì‹œì‘.

{"characters":[
  {"name":"ì´ë¦„","koreanName":"í•œê¸€ì´ë¦„","role":"protagonist","age":20,"gender":"male","personality":["ì„±ê²©1","ì„±ê²©2"],"appearance":{"height":"175cm","hairColor":"ê²€ì •","hairStyle":"ë‹¨ë°œ","eyeColor":"ê°ˆìƒ‰"},"backstory":"ë°°ê²½(50ìì´ë‚´)","motivation":"ë™ê¸°(30ìì´ë‚´)","arc":"ì„±ì¥(30ìì´ë‚´)"}
]}

roleê°’: protagonist/antagonist/supporting/minor
genderê°’: male/female
í•„ìˆ˜êµ¬ì„±: ì£¼ì¸ê³µ1-2, ì ëŒ€ì1-2, ì¡°ì—°${Math.max(2,t-4)}, ë‹¨ì—­1-2
ì´ ${t}ëª… ìƒì„±. backstory,motivation,arcëŠ” ê°„ê²°í•˜ê²Œ.`,b=await Y.generateText(u,{temperature:.8,maxTokens:12e3,useCache:!1}),x=U(b);if(!x.characters||x.characters.length===0)throw new Error("ìºë¦­í„°ê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");d({characters:x.characters})}catch(t){console.error("Character generation failed:",t),l("ìºë¦­í„° ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{r(!1)}},g=(t,u,b)=>{const x=[...s.characters];if(u.includes(".")){const[S,A]=u.split(".");x[t]={...x[t],[S]:{...x[t][S],[A]:b}}}else x[t]={...x[t],[u]:b};d({characters:x})},c=t=>{const u={protagonist:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",antagonist:"bg-red-500/20 text-red-400 border-red-500/30",supporting:"bg-blue-500/20 text-blue-400 border-blue-500/30",minor:"bg-gray-500/20 text-gray-400 border-gray-500/30"};return u[t]||u.minor};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ìºë¦­í„° ì„¤ì •"}),e.jsx("p",{className:"text-gray-400",children:"ì‘í’ˆì— ë“±ì¥í•˜ëŠ” ìºë¦­í„°ë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤"})]}),s.characters.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:i?e.jsxs("div",{className:"text-center",children:[e.jsx(V,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ìºë¦­í„°ë“¤ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-pink-500/20 flex items-center justify-center mb-6",children:e.jsx("span",{className:"text-5xl",children:"ğŸ‘¥"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ìºë¦­í„° ìë™ ìƒì„±"}),e.jsx("p",{className:"text-gray-400 text-center mb-6 max-w-md",children:"ê¸°íšì„œì™€ ì„¸ê³„ê´€ì„ ë°”íƒ•ìœ¼ë¡œ ë§¤ë ¥ì ì¸ ìºë¦­í„°ë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤."}),e.jsx(E,{onClick:o,variant:"primary",size:"lg",children:"ìºë¦­í„° ìƒì„±í•˜ê¸°"}),m&&e.jsx("p",{className:"text-red-400 mt-4",children:m})]})}):e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-3 gap-4",children:s.characters.map((t,u)=>{var b,x,S;return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},onClick:()=>h(a===u?null:u),className:`
                  relative cursor-pointer rounded-xl p-4 border-2 transition-all duration-200
                  ${a===u?"border-purple-500 bg-purple-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}
                `,children:[e.jsx("span",{className:`absolute top-3 right-3 px-2 py-1 rounded-full text-xs font-medium border ${c(t.role)}`,children:(b=xe.find(A=>A.value===t.role))==null?void 0:b.label}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-2xl mb-3",children:t.gender==="female"?"ğŸ‘©":t.gender==="male"?"ğŸ‘¨":"ğŸ§‘"}),e.jsx("h4",{className:"text-lg font-bold text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-400",children:t.koreanName}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t.age,"ì„¸ Â· ",(x=t.appearance)==null?void 0:x.height]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(S=t.personality)==null?void 0:S.slice(0,3).map((A,M)=>e.jsx("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-0.5 rounded",children:A},M))})]},u)})}),e.jsx(ne,{children:a!==null&&e.jsx(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-gray-800/50 rounded-xl border border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:["ìºë¦­í„° ìƒì„¸ ì •ë³´ í¸ì§‘",e.jsx("button",{onClick:()=>h(null),className:"ml-auto text-gray-400 hover:text-white",children:"âœ•"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(H,{label:"ì´ë¦„",value:s.characters[a].name,onChange:t=>g(a,"name",t.target.value)}),e.jsx(H,{label:"í•œêµ­ ì´ë¦„",value:s.characters[a].koreanName,onChange:t=>g(a,"koreanName",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(oe,{label:"ì—­í• ",options:xe,value:s.characters[a].role,onChange:t=>g(a,"role",t)}),e.jsx(H,{label:"ë‚˜ì´",type:"number",value:s.characters[a].age,onChange:t=>g(a,"age",Number(t.target.value))}),e.jsx(oe,{label:"ì„±ë³„",options:Ee,value:s.characters[a].gender,onChange:t=>g(a,"gender",t)})]}),e.jsx(F,{label:"ë°°ê²½ ìŠ¤í† ë¦¬",value:s.characters[a].backstory,onChange:t=>g(a,"backstory",t.target.value),rows:3}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(H,{label:"ë™ê¸°",value:s.characters[a].motivation,onChange:t=>g(a,"motivation",t.target.value)}),e.jsx(H,{label:"ì„±ì¥ ë°©í–¥",value:s.characters[a].arc,onChange:t=>g(a,"arc",t.target.value)})]})]})})}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(E,{variant:"ghost",onClick:o,disabled:i,loading:i,children:"ì „ì²´ ë‹¤ì‹œ ìƒì„±í•˜ê¸°"})})]})]})},Te=({data:s,updateData:d,isGenerating:i,setIsGenerating:r})=>{var g;const[m,l]=f.useState(null),a=async()=>{var c,t,u;if(!s.planning||s.characters.length===0){l("ë¨¼ì € ê¸°íšì„œì™€ ìºë¦­í„°ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.");return}r(!0),l(null);try{const b=s.characters.slice(0,5).map(B=>B.name).join(", "),x=s.episodeCount,S=Math.floor(x*.2),A=Math.floor(x*.5),M=Math.floor(x*.75),n=Math.floor(x*.9),v=`ì›¹íˆ° "${s.title}" ìŠ¤í† ë¦¬ êµ¬ì¡° (ì´ ${x}í™” ì™„ê²°). JSONë§Œ ì¶œë ¥.

ì¥ë¥´: ${s.genre}
ì¤„ê±°ë¦¬: ${s.planning.synopsis.slice(0,300)}
ìºë¦­í„°: ${b}

âš ï¸ ì¤‘ìš”: ${x}í™” ì™„ê²° ì‘í’ˆì…ë‹ˆë‹¤. ê²°ë§ì€ ë°˜ë“œì‹œ ${n+1}í™” ì´í›„ì—ë§Œ!

{"acts":[
{"actNumber":1,"title":"ë°œë‹¨","description":"ì£¼ì¸ê³µ ì†Œê°œì™€ ì„¸ê³„ê´€ ì„¤ì •","episodeRange":"1-${S}í™”","keyEvents":["ë¹™ì˜/í™˜ìƒ","ìƒˆë¡œìš´ í™˜ê²½ ì ì‘","í•µì‹¬ ì¸ë¬¼ ë§Œë‚¨"],"characterFocus":["${b.split(",")[0]}"],"emotionalTone":"ì„¤ë ˜/í˜¸ê¸°ì‹¬"},
{"actNumber":2,"title":"ì „ê°œ","description":"ê°ˆë“± ì‹œì‘ê³¼ ê´€ê³„ í˜•ì„±","episodeRange":"${S+1}-${A}í™”","keyEvents":["ì²« ë²ˆì§¸ ìœ„ê¸°","ë™ë§¹ í˜•ì„±","ì ëŒ€ ì„¸ë ¥ ë“±ì¥"],"characterFocus":["ì£¼ìš”ìºë¦­í„°ë“¤"],"emotionalTone":"ê¸´ì¥/ì„±ì¥"},
{"actNumber":3,"title":"ìœ„ê¸°","description":"ì£¼ìš” ê°ˆë“± ì‹¬í™”","episodeRange":"${A+1}-${M}í™”","keyEvents":["ë°°ì‹ /ë°˜ì „","í° ì‹œë ¨","ê´€ê³„ ë³€í™”"],"characterFocus":["ì£¼ìš”ìºë¦­í„°ë“¤"],"emotionalTone":"ì ˆì •/ê°ˆë“±"},
{"actNumber":4,"title":"ì ˆì •","description":"ìµœëŒ€ ìœ„ê¸°ì™€ ì„ íƒ","episodeRange":"${M+1}-${n}í™”","keyEvents":["ìµœì¢… ëŒ€ê²° ì¤€ë¹„","í¬ìƒ","ê²°ë‹¨"],"characterFocus":["ì£¼ìš”ìºë¦­í„°ë“¤"],"emotionalTone":"ê¸´ë°•/ë¹„ì¥"},
{"actNumber":5,"title":"ê²°ë§","description":"ê°ˆë“± í•´ê²°ê³¼ ìƒˆë¡œìš´ ì‹œì‘","episodeRange":"${n+1}-${x}í™”","keyEvents":["ìµœì¢… ìŠ¹ë¦¬/íŒ¨ë°°","ì—í•„ë¡œê·¸","ìƒˆë¡œìš´ ì‹œì‘"],"characterFocus":["${b.split(",")[0]}"],"emotionalTone":"ê°ë™/í¬ë§"}
],
"majorPlotPoints":[
{"episode":1,"type":"hook","description":"ë¹™ì˜/í™˜ìƒ ì‹œì‘"},
{"episode":${Math.floor(x*.1)},"type":"inciting_incident","description":"ë³¸ê²©ì ì¸ ì‚¬ê±´ ì‹œì‘"},
{"episode":${Math.floor(x*.25)},"type":"first_pinch","description":"ì²« ë²ˆì§¸ ìœ„ê¸°"},
{"episode":${Math.floor(x*.5)},"type":"midpoint","description":"ì¤‘ëŒ€í•œ ì „í™˜ì "},
{"episode":${Math.floor(x*.75)},"type":"second_pinch","description":"ë‘ ë²ˆì§¸ í° ìœ„ê¸°"},
{"episode":${Math.floor(x*.9)},"type":"climax","description":"ìµœì¢… ëŒ€ê²°"},
{"episode":${x},"type":"resolution","description":"ì™„ê²°"}
],
"subplots":[{"title":"ë¡œë§¨ìŠ¤","characters":["ìºë¦­í„°1","ìºë¦­í„°2"],"description":"ê°ì •ì„ ","resolution":"${n}í™”ì¯¤ í•´ê²°"}],
"themes":["ì„±ì¥","ìš´ëª…"]}

ìœ„ í˜•ì‹ëŒ€ë¡œ ë‚´ìš©ë§Œ ì±„ì›Œì„œ JSON ì¶œë ¥. {ë¡œ ì‹œì‘.`,T=await Y.generateText(v,{temperature:.7,maxTokens:4096});console.log("[StoryStructure] Raw response:",T);const w=U(T);console.log("[StoryStructure] Parsed:",w),d({storyStructure:w})}catch(b){console.error("Story structure generation failed:",b);const x={acts:[{actNumber:1,title:"ì‹œì‘",description:"ì´ì•¼ê¸°ì˜ ì‹œì‘",episodeRange:`1-${Math.floor(s.episodeCount*.25)}í™”`,keyEvents:["ì£¼ì¸ê³µ ì†Œê°œ"],characterFocus:[((c=s.characters[0])==null?void 0:c.name)||"ì£¼ì¸ê³µ"],emotionalTone:"ì„¤ë ˜"},{actNumber:2,title:"ì „ê°œ",description:"ê°ˆë“±ê³¼ ë°œì „",episodeRange:`${Math.floor(s.episodeCount*.25)+1}-${Math.floor(s.episodeCount*.75)}í™”`,keyEvents:["ê°ˆë“± ì‹¬í™”"],characterFocus:[((t=s.characters[0])==null?void 0:t.name)||"ì£¼ì¸ê³µ"],emotionalTone:"ê¸´ì¥"},{actNumber:3,title:"ê²°ë§",description:"í´ë¼ì´ë§¥ìŠ¤ì™€ í•´ê²°",episodeRange:`${Math.floor(s.episodeCount*.75)+1}-${s.episodeCount}í™”`,keyEvents:["ìµœì¢… ëŒ€ê²°"],characterFocus:[((u=s.characters[0])==null?void 0:u.name)||"ì£¼ì¸ê³µ"],emotionalTone:"ê°ë™"}],majorPlotPoints:[{episode:1,type:"hook",description:"ì´ì•¼ê¸°ì˜ ì‹œì‘"},{episode:Math.floor(s.episodeCount*.5),type:"midpoint",description:"ì¤‘ê°„ ì „í™˜ì "},{episode:s.episodeCount,type:"climax",description:"í´ë¼ì´ë§¥ìŠ¤"}],subplots:[],themes:[s.genre,"ì„±ì¥"]};d({storyStructure:x}),l("AI ìƒì„± ì‹¤íŒ¨í•˜ì—¬ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. í•„ìš”ì‹œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.")}finally{r(!1)}},h=c=>({hook:"bg-green-500",inciting_incident:"bg-blue-500",first_pinch:"bg-yellow-500",midpoint:"bg-purple-500",second_pinch:"bg-orange-500",climax:"bg-red-500",resolution:"bg-pink-500"})[c]||"bg-gray-500",o=c=>({hook:"í›…",inciting_incident:"ë°œë‹¨",first_pinch:"ì²« ë²ˆì§¸ ìœ„ê¸°",midpoint:"ì¤‘ê°„ì ",second_pinch:"ë‘ ë²ˆì§¸ ìœ„ê¸°",climax:"í´ë¼ì´ë§¥ìŠ¤",resolution:"ê²°ë§"})[c]||c;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ìŠ¤í† ë¦¬ êµ¬ì¡°"}),e.jsx("p",{className:"text-gray-400",children:"ì „ì²´ ìŠ¤í† ë¦¬ì˜ êµ¬ì¡°ì™€ ì£¼ìš” í”Œë¡¯ í¬ì¸íŠ¸ë¥¼ ì„¤ê³„í•©ë‹ˆë‹¤"})]}),s.storyStructure?e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"ë§‰ êµ¬ì„±"}),s.storyStructure.acts.map((c,t)=>{var u;return e.jsx(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.1},className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-xl font-bold text-white flex-shrink-0",children:c.actNumber}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg font-bold text-white",children:c.title}),e.jsx("p",{className:"text-sm text-purple-400 mb-2",children:c.episodeRange}),e.jsx(F,{value:c.description,onChange:b=>{var S,A,M,n;const x=[...((S=s.storyStructure)==null?void 0:S.acts)||[]];x[t]={...c,description:b.target.value},d({storyStructure:{acts:x,majorPlotPoints:((A=s.storyStructure)==null?void 0:A.majorPlotPoints)||[],subplots:((M=s.storyStructure)==null?void 0:M.subplots)||[],themes:((n=s.storyStructure)==null?void 0:n.themes)||[]}})},rows:2,className:"bg-gray-700/50 mb-2"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded",children:c.emotionalTone}),(u=c.characterFocus)==null?void 0:u.map((b,x)=>e.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-400 px-2 py-1 rounded",children:b},x))]})]})]})},t)})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"ì£¼ìš” í”Œë¡¯ í¬ì¸íŠ¸"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-gray-700"}),e.jsx("div",{className:"space-y-4",children:(g=s.storyStructure.majorPlotPoints)==null?void 0:g.map((c,t)=>e.jsxs(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.05},className:"flex items-start gap-4 relative",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${h(c.type)} flex items-center justify-center text-white font-bold z-10`,children:c.episode}),e.jsxs("div",{className:"flex-1 bg-gray-700/50 rounded-lg p-4",children:[e.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${h(c.type)} bg-opacity-20 mb-2`,children:o(c.type)}),e.jsx("p",{className:"text-white",children:c.description})]})]},t))})]})]}),s.storyStructure.subplots&&s.storyStructure.subplots.length>0&&e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"ì„œë¸Œí”Œë¡¯"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.storyStructure.subplots.map((c,t)=>{var u;return e.jsxs("div",{className:"bg-gray-700/50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-white mb-1",children:c.title}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:c.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(u=c.characters)==null?void 0:u.map((b,x)=>e.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:b},x))})]},t)})})]}),s.storyStructure.themes&&e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"í•µì‹¬ í…Œë§ˆ"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.storyStructure.themes.map((c,t)=>e.jsx("span",{className:"px-4 py-2 bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-white rounded-full border border-purple-500/30",children:c},t))})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 pt-4",children:[e.jsx(E,{variant:"ghost",onClick:()=>{console.log("[StoryStructure] ë‹¤ì‹œ ìƒì„±í•˜ê¸° í´ë¦­, isGenerating:",i),a()},disabled:i,loading:i,children:i?"ìƒì„± ì¤‘...":"ë‹¤ì‹œ ìƒì„±í•˜ê¸°"}),m&&e.jsx("p",{className:"text-red-400 text-sm",children:m})]})]}):e.jsx("div",{className:"flex flex-col items-center justify-center py-12",children:i?e.jsxs("div",{className:"text-center",children:[e.jsx(V,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ìŠ¤í† ë¦¬ êµ¬ì¡°ë¥¼ ì„¤ê³„í•˜ê³  ìˆìŠµë‹ˆë‹¤..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-orange-500/20 flex items-center justify-center mb-6",children:e.jsx("span",{className:"text-5xl",children:"ğŸ“Š"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ìŠ¤í† ë¦¬ êµ¬ì¡° ìƒì„±"}),e.jsx("p",{className:"text-gray-400 text-center mb-6 max-w-md",children:"3ë§‰ êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ì²´ ìŠ¤í† ë¦¬ íë¦„ì„ ì„¤ê³„í•©ë‹ˆë‹¤."}),e.jsx(E,{onClick:a,variant:"primary",size:"lg",children:"ìŠ¤í† ë¦¬ êµ¬ì¡° ìƒì„±í•˜ê¸°"}),m&&e.jsx("p",{className:"text-red-400 mt-4",children:m})]})})]})},Me=({data:s,updateData:d,isGenerating:i,setIsGenerating:r})=>{var M;const[m,l]=f.useState(null),[a,h]=f.useState(null),[o,g]=f.useState(5),c=f.useRef(s);f.useEffect(()=>{c.current=s},[s]);const t=async()=>{var v,T,w,B,Z,Q;console.log("[EpisodePlan] ========= BUTTON CLICKED ========="),console.log("[EpisodePlan] isGenerating:",i);const n=c.current;if(console.log("[EpisodePlan] storyStructure:",n.storyStructure),console.log("[EpisodePlan] planning:",n.planning),!((v=n.planning)!=null&&v.synopsis)){l("ë¨¼ì € AI ê¸°íš ë‹¨ê³„ì—ì„œ ì‹œë†‰ì‹œìŠ¤ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”."),console.log("[EpisodePlan] Error: No planning/synopsis");return}r(!0),l(null);try{const _=n.episodePlans.length,P=_+1,y=Math.min(P+o-1,n.episodeCount),j=y-P+1;console.log(`[EpisodePlan] Current episodes: ${_}, Generating: ${P}~${y}`);const R=n.episodePlans[n.episodePlans.length-1];if(P>n.episodeCount){l("ëª¨ë“  ì—í”¼ì†Œë“œê°€ ì´ë¯¸ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤."),r(!1);return}const C=n.storyStructure;let N=null,I="",J="";if(C!=null&&C.acts){for(const $ of C.acts){const z=(T=$.episodeRange)==null?void 0:T.match(/(\d+)-(\d+)/);if(z){const he=parseInt(z[1]),ge=parseInt(z[2]);if(P>=he&&P<=ge){N=$;break}}}if(N&&(I=`
ğŸ“ í˜„ì¬ ë§‰: ${N.actNumber}ë§‰ "${N.title}" (${N.episodeRange})
- ì„¤ëª…: ${N.description}
- ê°ì •í†¤: ${N.emotionalTone}
- ì£¼ìš”ì‚¬ê±´: ${(w=N.keyEvents)==null?void 0:w.join(", ")}
- ì¤‘ì‹¬ìºë¦­í„°: ${(B=N.characterFocus)==null?void 0:B.join(", ")}`),C.majorPlotPoints){const $=C.majorPlotPoints.filter(z=>z.episode>=P&&z.episode<=y);$.length>0&&(J=`
ğŸ¯ ì´ êµ¬ê°„ì˜ ì£¼ìš” í”Œë¡¯ í¬ì¸íŠ¸:
${$.map(z=>`- ${z.episode}í™”: [${z.type}] ${z.description}`).join(`
`)}`)}}const O=n.episodeCount,G=Math.floor(O*.9),q=P>=G,X=Math.round(P/O*100);let L="";q?L="climax, falling, resolution ì‚¬ìš© ê°€ëŠ¥ (ê²°ë§ êµ¬ê°„)":P>=Math.floor(O*.75)?L="rising, climax, fallingë§Œ ì‚¬ìš© (ì ˆì • êµ¬ê°„, resolution ê¸ˆì§€!)":P>=Math.floor(O*.5)?L="rising, climaxë§Œ ì‚¬ìš© (ìœ„ê¸° êµ¬ê°„, resolution/falling ê¸ˆì§€!)":L="exposition, risingë§Œ ì‚¬ìš© (ë°œë‹¨/ì „ê°œ êµ¬ê°„, climax/resolution ê¸ˆì§€!)";const ee=n.episodePlans.slice(-3),ae=ee.length>0?`
ìµœê·¼ ì „ê°œ:
${ee.map($=>`- ${$.episodeNumber}í™” "${$.title}": ${$.summary}`).join(`
`)}`:"",se=`ì›¹íˆ° "${n.title}" ì—í”¼ì†Œë“œ ${P}~${y}í™” ìƒì„±.

ğŸ“Š ì „ì²´: ${O}í™” ì™„ê²°ì‘ | í˜„ì¬: ${P}~${y}í™” (ì§„í–‰ë¥  ${X}%)
${I}
${J}
${ae}

ì‹œë†‰ì‹œìŠ¤: ${(Q=(Z=n.planning)==null?void 0:Z.synopsis)==null?void 0:Q.slice(0,200)}
ìºë¦­í„°: ${n.characters.slice(0,5).map($=>$.name).join(", ")}
${R?`ì§ì „í™”(${R.episodeNumber}í™”): "${R.title}" - ${R.endingHook}`:"ì²« ì—í”¼ì†Œë“œì…ë‹ˆë‹¤."}

âš ï¸ í•„ìˆ˜ ê·œì¹™:
1. ì •í™•íˆ ${j}ê°œë§Œ ìƒì„± (${P}~${y}í™”)
2. emotionalArc: ${L}
3. ${O}í™”ê°€ ì™„ê²°! ${q?"ê²°ë§ êµ¬ê°„ì…ë‹ˆë‹¤.":`ê²°ë§ì€ ${G}í™” ì´í›„ì—ë§Œ! ì§€ê¸ˆì€ ìŠ¤í† ë¦¬ ì „ê°œ ì¤‘!`}
4. ì´ì „ ì—í”¼ì†Œë“œì™€ ì¤‘ë³µë˜ëŠ” ì‚¬ê±´/ì œëª© ê¸ˆì§€
5. JSONë§Œ ì¶œë ¥, {ë¡œ ì‹œì‘

{"episodes":[
{"episodeNumber":${P},"title":"ì œëª©(ì¤‘ë³µê¸ˆì§€)","summary":"ìš”ì•½30ì","keyEvents":["ìƒˆë¡œìš´ì‚¬ê±´"],"emotionalArc":"rising","endingHook":"ë‹¤ìŒí™”ë–¡ë°¥","characters":["ì´ë¦„"],"locations":["ì¥ì†Œ"]}
]}`;console.log("[EpisodePlan] Prompt:",se);const p=await Y.generateText(se,{temperature:.8,maxTokens:16e3,useCache:!1}),te=U(p);if(console.log("[EpisodePlan] Raw parsed result:",te),!te.episodes||te.episodes.length===0)throw new Error("ì—í”¼ì†Œë“œê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");const ie=te.episodes.slice(0,j).map(($,z)=>({...$,episodeNumber:P+z})).filter($=>$.episodeNumber<=n.episodeCount);if(console.log(`[EpisodePlan] Generated ${ie.length} episodes (filtered to max ${n.episodeCount}í™”)`),ie.length===0){l("ëª¨ë“  ì—í”¼ì†Œë“œê°€ ì´ë¯¸ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.");return}const ce=c.current,pe=new Set(ce.episodePlans.map($=>$.episodeNumber)),de=ie.filter($=>!pe.has($.episodeNumber));if(de.length===0){l("ì¶”ê°€í•  ìƒˆ ì—í”¼ì†Œë“œê°€ ì—†ìŠµë‹ˆë‹¤.");return}d({episodePlans:[...ce.episodePlans,...de]})}catch(_){console.error("Episode plan generation failed:",_),l("ì—í”¼ì†Œë“œ í”Œëœ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{r(!1)}},u=(n,v,T)=>{const w=[...s.episodePlans];w[n]={...w[n],[v]:T},d({episodePlans:w})},b=n=>{if(!confirm(`${s.episodePlans[n].episodeNumber}í™”ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))return;const T=s.episodePlans.filter((w,B)=>B!==n).map((w,B)=>({...w,episodeNumber:B+1}));d({episodePlans:T}),a===n?h(null):a!==null&&a>n&&h(a-1)},x=()=>{confirm("ëª¨ë“  ì—í”¼ì†Œë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(d({episodePlans:[]}),h(null))},S=n=>({exposition:"primary",rising:"warning",climax:"danger",falling:"info",resolution:"success"})[n]||"default",A=n=>({exposition:"ë°œë‹¨",rising:"ìƒìŠ¹",climax:"ì ˆì •",falling:"í•˜ê°•",resolution:"ê²°ë§"})[n]||n;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ì—í”¼ì†Œë“œ í”Œëœ"}),e.jsx("p",{className:"text-gray-400",children:"ê° ì—í”¼ì†Œë“œì˜ ë‚´ìš©ì„ ê³„íší•©ë‹ˆë‹¤"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"ì—í”¼ì†Œë“œ ê³„íš ì§„í–‰"}),e.jsxs("span",{className:"text-white font-medium",children:[s.episodePlans.length," / ",s.episodeCount,"í™”"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300",style:{width:`${s.episodePlans.length/s.episodeCount*100}%`}})})]}),s.episodePlans.length===0&&!i?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-green-500/20 flex items-center justify-center mb-6",children:e.jsx("span",{className:"text-5xl",children:"ğŸ“"})}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"ì—í”¼ì†Œë“œ í”Œëœ ìƒì„±"}),e.jsx("p",{className:"text-gray-400 text-center mb-6 max-w-md",children:"ìŠ¤í† ë¦¬ êµ¬ì¡°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê° ì—í”¼ì†Œë“œì˜ ìƒì„¸ ê³„íšì„ ì‘ì„±í•©ë‹ˆë‹¤."}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{className:"text-gray-400",children:"ìƒì„±í•  ì—í”¼ì†Œë“œ ìˆ˜:"}),e.jsx("select",{value:o,onChange:n=>g(Number(n.target.value)),className:"bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[3,5,10].map(n=>e.jsxs("option",{value:n,children:[n,"í™”"]},n))})]}),e.jsx(E,{onClick:t,variant:"primary",size:"lg",disabled:i,children:i?"ìƒì„± ì¤‘...":"ì—í”¼ì†Œë“œ í”Œëœ ìƒì„±í•˜ê¸°"}),m&&e.jsx("div",{className:"mt-4 p-4 bg-red-500/20 border border-red-500/50 rounded-lg",children:e.jsx("p",{className:"text-red-400 font-medium",children:m})})]}):e.jsxs("div",{className:"space-y-4",children:[i&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(V,{size:"lg",className:"mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"AIê°€ ì—í”¼ì†Œë“œë¥¼ ê³„íší•˜ê³  ìˆìŠµë‹ˆë‹¤..."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.episodePlans.map((n,v)=>{var T;return e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:v*.05},className:`
                  relative rounded-xl p-4 border-2 transition-all duration-200
                  ${a===v?"border-purple-500 bg-purple-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}
                `,children:[e.jsx("button",{onClick:w=>{w.stopPropagation(),b(v)},className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-red-500/20 hover:bg-red-500/40 flex items-center justify-center text-red-400 hover:text-red-300 transition-colors",title:"ì—í”¼ì†Œë“œ ì‚­ì œ",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{onClick:()=>h(a===v?null:v),className:"cursor-pointer",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2 pr-6",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-400",children:n.episodeNumber}),e.jsx(le,{variant:S(n.emotionalArc),children:A(n.emotionalArc)})]}),e.jsx("h4",{className:"text-lg font-bold text-white mb-2",children:n.title}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:n.summary}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(T=n.characters)==null?void 0:T.slice(0,3).map((w,B)=>e.jsx("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-0.5 rounded",children:w},B))})]})]},v)})}),e.jsx(ne,{children:a!==null&&e.jsx(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-gray-800/50 rounded-xl border border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center justify-between",children:[s.episodePlans[a].episodeNumber,"í™” ìƒì„¸ í¸ì§‘",e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-white",children:"âœ•"})]}),e.jsx(F,{label:"ì œëª©",value:s.episodePlans[a].title,onChange:n=>u(a,"title",n.target.value),rows:1}),e.jsx(F,{label:"ìš”ì•½",value:s.episodePlans[a].summary,onChange:n=>u(a,"summary",n.target.value),rows:3}),e.jsx(F,{label:"ì—”ë”© í›… (ë–¡ë°¥)",value:s.episodePlans[a].endingHook,onChange:n=>u(a,"endingHook",n.target.value),rows:2,helperText:"ë‹¤ìŒ í™”ë¡œ ì´ì–´ì§€ëŠ” ê¶ê¸ˆì¦ì„ ìœ ë°œí•˜ëŠ” ìš”ì†Œ"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"ì£¼ìš” ì‚¬ê±´"}),(M=s.episodePlans[a].keyEvents)==null?void 0:M.map((n,v)=>e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-purple-400",children:[v+1,"."]}),e.jsx("input",{type:"text",value:n,onChange:T=>{const w=[...s.episodePlans[a].keyEvents];w[v]=T.target.value,u(a,"keyEvents",w)},className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white"})]},v))]})]})})}),!i&&e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[s.episodePlans.length>0&&e.jsx(E,{onClick:x,variant:"danger",size:"sm",children:"ì „ì²´ ì‚­ì œ"}),s.episodePlans.length===0&&e.jsx("div",{}),s.episodePlans.length<s.episodeCount?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("select",{value:o,onChange:n=>g(Number(n.target.value)),className:"bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white",children:[3,5,10].map(n=>e.jsxs("option",{value:n,children:[n,"í™” ì¶”ê°€"]},n))}),e.jsx(E,{onClick:()=>{console.log("[Button] onClick triggered, isGenerating:",i),t()},variant:"primary",disabled:i,children:i?"ìƒì„± ì¤‘...":"ë‹¤ìŒ ì—í”¼ì†Œë“œ ìƒì„±"})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["ë‚¨ì€ ì—í”¼ì†Œë“œ: ",s.episodeCount-s.episodePlans.length,"í™”"]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("span",{className:"font-medium",children:["ëª¨ë“  ì—í”¼ì†Œë“œ ìƒì„± ì™„ë£Œ! (",s.episodeCount,"í™”)"]})]}),m&&e.jsx("div",{className:"mt-4 p-4 bg-red-500/20 border border-red-500/50 rounded-lg w-full",children:e.jsx("p",{className:"text-red-400 font-medium",children:m})})]})]})]})},Be=({data:s})=>{const i=(()=>{let r=0;const m=6;return s.title&&s.briefConcept&&r++,s.genre&&s.artStyle&&r++,s.planning&&r++,s.worldBuilding&&r++,s.characters.length>0&&r++,s.episodePlans.length>0&&r++,r/m*100})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"ìµœì¢… ê²€í† "}),e.jsx("p",{className:"text-gray-400",children:"í”„ë¡œì íŠ¸ ì„¤ì •ì„ í™•ì¸í•˜ê³  ìƒì„±ì„ ì™„ë£Œí•˜ì„¸ìš”"})]}),e.jsxs(W,{className:"bg-gradient-to-r from-purple-500/10 to-pink-500/10 border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"í”„ë¡œì íŠ¸ ì™„ì„±ë„"}),e.jsxs("span",{className:"text-2xl font-bold text-purple-400",children:[Math.round(i),"%"]})]}),e.jsx(Ne,{value:i,color:"primary",size:"lg"})]}),e.jsxs(W,{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ğŸ“‹"})," ê¸°ë³¸ ì •ë³´"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì œëª©"}),e.jsx("p",{className:"text-white font-medium",children:s.title||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì¥ë¥´"}),e.jsxs("p",{className:"text-white font-medium",children:[s.genre||"-",s.subGenres.length>0&&e.jsxs("span",{className:"text-gray-400 text-sm ml-2",children:["(",s.subGenres.join(", "),")"]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì•„íŠ¸ ìŠ¤íƒ€ì¼"}),e.jsx("p",{className:"text-white font-medium",children:s.artStyle||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì˜ˆìƒ íšŒì°¨"}),e.jsxs("p",{className:"text-white font-medium",children:[s.episodeCount,"í™”"]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì»¨ì…‰"}),e.jsx("p",{className:"text-white",children:s.briefConcept||"-"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ë¶„ìœ„ê¸°"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:s.mood.map((r,m)=>e.jsx(le,{variant:"primary",children:r},m))})]})]}),s.planning&&e.jsxs(W,{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ğŸ’¡"})," ê¸°íšì˜ë„ì„œ"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì‹œë†‰ì‹œìŠ¤"}),e.jsx("p",{className:"text-white text-sm",children:s.planning.synopsis})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"í•µì‹¬ ë©”ì‹œì§€"}),e.jsx("p",{className:"text-white text-sm",children:s.planning.coreMessage})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"ì°¨ë³„í™” í¬ì¸íŠ¸"}),e.jsx("ul",{className:"text-white text-sm list-disc list-inside",children:s.planning.uniquePoints.map((r,m)=>e.jsx("li",{children:r},m))})]})]})]}),e.jsxs(W,{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ğŸ‘¥"})," ìºë¦­í„° (",s.characters.length,"ëª…)"]}),s.characters.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-3",children:s.characters.map((r,m)=>e.jsxs(k.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:m*.1},className:"bg-gray-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xl",children:r.gender==="female"?"ğŸ‘©":r.gender==="male"?"ğŸ‘¨":"ğŸ§‘"}),e.jsx("span",{className:"font-medium text-white",children:r.name})]}),e.jsx(le,{variant:r.role==="protagonist"?"warning":r.role==="antagonist"?"danger":"default",size:"sm",children:r.role==="protagonist"?"ì£¼ì¸ê³µ":r.role==="antagonist"?"ì ëŒ€ì":r.role==="supporting"?"ì¡°ì—°":"ë‹¨ì—­"})]},m))}):e.jsx("p",{className:"text-gray-400",children:"ìºë¦­í„°ê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."})]}),e.jsxs(W,{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ğŸ“"})," ì—í”¼ì†Œë“œ í”Œëœ (",s.episodePlans.length,"/",s.episodeCount,"í™”)"]}),s.episodePlans.length>0?e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[s.episodePlans.slice(0,10).map((r,m)=>e.jsxs("div",{className:"flex items-center gap-3 bg-gray-700/50 rounded-lg p-2",children:[e.jsx("span",{className:"text-lg font-bold text-purple-400 w-8",children:r.episodeNumber}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-white text-sm font-medium",children:r.title})}),e.jsx(le,{variant:"default",size:"sm",children:r.emotionalArc})]},m)),s.episodePlans.length>10&&e.jsxs("p",{className:"text-gray-400 text-center text-sm",children:["... ì™¸ ",s.episodePlans.length-10,"í™” ë”"]})]}):e.jsx("p",{className:"text-gray-400",children:"ì—í”¼ì†Œë“œ í”Œëœì´ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."})]}),e.jsxs(W,{className:"bg-gradient-to-r from-green-500/10 to-emerald-500/10 border-green-500/20",children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ğŸ’°"})," ì˜ˆìƒ ë¹„ìš©"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",(s.episodeCount*20*.003+s.episodeCount*.01).toFixed(2)]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"ì´ë¯¸ì§€ ìƒì„±"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-400",children:["$",(s.episodeCount*.005).toFixed(2)]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"í…ìŠ¤íŠ¸ ìƒì„±"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-400",children:["$",(s.episodeCount*20*.003+s.episodeCount*.015).toFixed(2)]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"ì´ ì˜ˆìƒ"})]})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-4 text-center",children:"* ìºì‹œ ì ìš© ì‹œ ì•½ 30-40% ì ˆê° ê°€ëŠ¥"})]}),i>=50?e.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-xl p-6 border border-purple-500/30 text-center",children:[e.jsx("span",{className:"text-4xl mb-4 block",children:"ğŸ‰"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"í”„ë¡œì íŠ¸ ìƒì„± ì¤€ë¹„ ì™„ë£Œ!"}),e.jsx("p",{className:"text-gray-400",children:'ì•„ë˜ "í”„ë¡œì íŠ¸ ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì›¹íˆ° ì œì‘ì„ ì‹œì‘í•˜ì„¸ìš”.'})]}):e.jsxs("div",{className:"bg-yellow-500/10 rounded-xl p-6 border border-yellow-500/30 text-center",children:[e.jsx("span",{className:"text-4xl mb-4 block",children:"âš ï¸"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"ì¶”ê°€ ì„¤ì • í•„ìš”"}),e.jsx("p",{className:"text-gray-400",children:"ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ìœ„í•´ ì´ì „ ë‹¨ê³„ì—ì„œ ëˆ„ë½ëœ í•­ëª©ì„ ì™„ì„±í•´ì£¼ì„¸ìš”."})]})]})},Re=({steps:s,currentStep:d,onStepClick:i})=>e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex items-center justify-between",children:s.map((r,m)=>{const l=m<d,a=m===d,h=m<=d&&i;return e.jsxs(ue.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(k.button,{onClick:()=>h&&i(m),disabled:!h,className:`
                    relative w-10 h-10 rounded-full flex items-center justify-center
                    font-medium text-sm transition-all duration-300
                    ${h?"cursor-pointer":"cursor-default"}
                    ${l?"bg-green-500 text-white":a?"bg-purple-600 text-white ring-4 ring-purple-500/30":"bg-gray-700 text-gray-400"}
                  `,whileHover:h?{scale:1.1}:void 0,whileTap:h?{scale:.95}:void 0,children:l?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):m+1}),e.jsx("span",{className:`
                    mt-2 text-xs font-medium whitespace-nowrap
                    ${a?"text-purple-400":l?"text-green-400":"text-gray-500"}
                  `,children:r.title})]}),m<s.length-1&&e.jsx("div",{className:"flex-1 mx-2 h-0.5 bg-gray-700 relative",children:e.jsx(k.div,{className:"absolute inset-y-0 left-0 bg-gradient-to-r from-green-500 to-purple-500",initial:{width:0},animate:{width:l?"100%":a?"50%":"0%"},transition:{duration:.3}})})]},r.id)})})}),re="webtoon_wizard_progress",K=[{id:"basic",title:"ê¸°ë³¸ ì •ë³´",component:we},{id:"genre",title:"ì¥ë¥´ & ìŠ¤íƒ€ì¼",component:Se},{id:"planning",title:"AI ê¸°íš",component:$e},{id:"world",title:"ì„¸ê³„ê´€",component:Pe},{id:"character",title:"ìºë¦­í„°",component:Ae},{id:"story",title:"ìŠ¤í† ë¦¬ êµ¬ì¡°",component:Te},{id:"episode",title:"ì—í”¼ì†Œë“œ",component:Me},{id:"review",title:"ìµœì¢… í™•ì¸",component:Be}],Le={title:"",briefConcept:"",targetAudience:"all",episodeCount:10,genre:"",subGenres:[],mood:[],artStyle:"korean-webtoon",characters:[],episodePlans:[]},ze=({editProjectId:s})=>{const[d,i]=f.useState(0),[r,m]=f.useState(Le),[l,a]=f.useState(!1);f.useEffect(()=>{a(!1)},[d]);const[h,o]=f.useState(null),[g,c]=f.useState(!1),[t,u]=f.useState(null),[b,x]=f.useState(!1),S=be(),{createProject:A,setCurrentProject:M}=D();f.useEffect(()=>{s&&(async()=>{var R;await M(s);const j=D.getState().currentProject;j&&(x(!0),m({title:j.title,briefConcept:j.briefConcept,targetAudience:j.targetAudience,episodeCount:j.episodeCount,genre:j.genre,subGenres:j.subGenres||[],mood:j.mood||[],artStyle:j.artStyle,planning:j.planning,worldBuilding:j.worldBuilding,characters:j.characters||[],storyStructure:j.storyStructure,episodePlans:((R=j.episodes)==null?void 0:R.map(C=>({episodeNumber:C.episodeNumber,title:C.title,summary:C.summary,openingHook:C.openingHook||"",endingHook:C.endingHook||"",keyScenes:C.keyScenes||[]})))||[],styleGuide:j.styleGuide}),i(6))})()},[s,M]),f.useEffect(()=>{if(s)return;const y=localStorage.getItem(re);if(y)try{const j=JSON.parse(y);j.data&&j.data.title&&(u(j),c(!0))}catch{}},[s]),f.useEffect(()=>{if(r.title){const y={step:d,data:r};localStorage.setItem(re,JSON.stringify(y))}},[d,r]);const n=()=>{t&&(m(t.data),i(t.step)),c(!1)},v=()=>{localStorage.removeItem(re),c(!1)},T=K[d].component,w=f.useCallback(y=>{m(j=>({...j,...y}))},[]),B=f.useCallback(()=>{d<K.length-1&&i(y=>y+1)},[d]),Z=f.useCallback(()=>{d>0&&i(y=>y-1)},[d]),Q=f.useCallback(y=>{(b||y<=d)&&i(y)},[d,b]),_=f.useCallback(async()=>{if(s)try{a(!0);const{updateProject:y,addEpisode:j,deleteEpisode:R}=D.getState(),C=D.getState().currentProject;if(await y(s,{planning:r.planning,worldBuilding:r.worldBuilding,subGenres:r.subGenres}),C!=null&&C.episodes)for(const N of C.episodes)await R(s,N.id);for(const N of r.episodePlans)await j(s,{episodeNumber:N.episodeNumber,title:N.title,summary:N.summary||"",status:"planning",panels:[],keyEvents:N.keyEvents||[],emotionalArc:N.emotionalArc||"exposition",endingHook:N.endingHook||"",characters:N.characters||[],locations:N.locations||[],wordCount:0,estimatedReadTime:0,translations:new Map});console.log(`[StepWizard] ì €ì¥ ì™„ë£Œ: ${r.episodePlans.length}ê°œ ì—í”¼ì†Œë“œ`),o({message:`${r.episodePlans.length}ê°œ ì—í”¼ì†Œë“œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`,type:"success"}),setTimeout(()=>{S(`/editor/${s}`)},500)}catch(y){console.error("Save failed:",y),o({message:"ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",type:"error"}),a(!1)}},[s,S,r]),P=f.useCallback(async()=>{var y,j,R,C,N,I,J,O,G,q,X;try{a(!0);const L=await A({title:r.title,genre:r.genre,targetAudience:r.targetAudience,mood:r.mood,briefConcept:r.briefConcept,artStyle:r.artStyle,episodeCount:r.episodeCount}),{updateProject:ee,addCharacter:ae,addEpisode:se}=D.getState();await ee(L.id,{planning:r.planning,worldBuilding:r.worldBuilding,subGenres:r.subGenres});for(const p of r.characters)await ae(L.id,{name:p.name||"",koreanName:p.koreanName||p.name||"",role:p.role||"supporting",age:p.age||20,gender:p.gender||"other",personality:p.personality||[],appearance:{height:((y=p.appearance)==null?void 0:y.height)||"",bodyType:((j=p.appearance)==null?void 0:j.bodyType)||"",skinTone:((R=p.appearance)==null?void 0:R.skinTone)||"",hairColor:((C=p.appearance)==null?void 0:C.hairColor)||"",hairStyle:((N=p.appearance)==null?void 0:N.hairStyle)||"",eyeColor:((I=p.appearance)==null?void 0:I.eyeColor)||"",eyeShape:((J=p.appearance)==null?void 0:J.eyeShape)||"",faceShape:((O=p.appearance)==null?void 0:O.faceShape)||"",distinguishingFeatures:((G=p.appearance)==null?void 0:G.distinguishingFeatures)||[],defaultOutfit:((q=p.appearance)==null?void 0:q.defaultOutfit)||"",accessories:((X=p.appearance)==null?void 0:X.accessories)||[]},backstory:p.backstory||p.background||"",motivation:p.motivation||"",arc:p.arc||"",relationships:p.relationships||[],speechPattern:p.speechPattern||{formality:"casual",vocabulary:[],speechHabits:[],emotionalTendency:""},visualPrompt:p.visualPrompt||"",referenceImages:p.referenceImages||[],expressions:p.expressions||[],poses:p.poses||[],outfits:p.outfits||[]});for(const p of r.episodePlans)await se(L.id,{episodeNumber:p.episodeNumber,title:p.title,summary:p.summary||"",status:"planning",panels:[],keyEvents:p.keyEvents||[],emotionalArc:p.emotionalArc||"exposition",endingHook:p.endingHook||"",characters:p.characters||[],locations:p.locations||[],wordCount:0,estimatedReadTime:0,translations:new Map});localStorage.removeItem(re),o({message:"í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!",type:"success"}),setTimeout(()=>{S(`/editor/${L.id}`)},1500)}catch(L){console.error("Project creation failed:",L),o({message:"í”„ë¡œì íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",type:"error"})}finally{a(!1)}},[r,A,S]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900",children:[g&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:e.jsxs(k.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-gray-800 rounded-2xl p-6 max-w-md mx-4 border border-gray-700",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"ì´ì „ ì‘ì—…ì´ ìˆìŠµë‹ˆë‹¤"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:['"',e.jsx("span",{className:"text-purple-400",children:t.data.title}),'" í”„ë¡œì íŠ¸ì˜',e.jsxs("span",{className:"text-white font-medium",children:[" ",K[t.step].title]})," ë‹¨ê³„ê¹Œì§€ ì‘ì—…í•˜ì…¨ìŠµë‹ˆë‹¤."]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-6",children:[t.data.characters.length>0&&e.jsxs("p",{children:["ìºë¦­í„° ",t.data.characters.length,"ëª… ìƒì„±ë¨"]}),t.data.episodePlans.length>0&&e.jsxs("p",{children:["ì—í”¼ì†Œë“œ ",t.data.episodePlans.length,"í™” ê³„íšë¨"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{variant:"ghost",onClick:v,className:"flex-1",children:"ìƒˆë¡œ ì‹œì‘"}),e.jsx(E,{variant:"primary",onClick:n,className:"flex-1",children:"ì´ì–´ì„œ ì‘ì—…"})]})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>b?_():S("/dashboard"),className:"flex items-center text-gray-400 hover:text-white transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),b?"ì—ë””í„°ë¡œ ëŒì•„ê°€ê¸°":"ëŒ€ì‹œë³´ë“œ"]}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:b?`${r.title} - í”„ë¡œì íŠ¸ ì„¤ì •`:"ìƒˆ ì›¹íˆ° í”„ë¡œì íŠ¸"}),b&&e.jsx(E,{variant:"primary",size:"sm",onClick:_,children:"ì—ë””í„°ë¡œ ì´ë™"}),!b&&e.jsx("div",{className:"w-24"})]}),e.jsx(Re,{steps:K,currentStep:d,onStepClick:Q}),e.jsx("div",{className:"mt-8 bg-gray-800/50 backdrop-blur-sm rounded-2xl p-8 border border-gray-700",children:e.jsx(ne,{mode:"wait",children:e.jsx(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(T,{data:r,updateData:w,onNext:B,isGenerating:l,setIsGenerating:a})},d)})}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx(E,{variant:"ghost",onClick:Z,disabled:d===0,children:"ì´ì „"}),e.jsx("div",{className:"flex gap-3",children:d<K.length-1?e.jsx(E,{variant:"primary",onClick:B,disabled:l,children:"ë‹¤ìŒ"}):e.jsx(E,{variant:"primary",onClick:P,disabled:l,loading:l,children:"í”„ë¡œì íŠ¸ ìƒì„±"})})]})]}),e.jsx(ne,{children:h&&e.jsx(fe,{message:h.message,type:h.type,onClose:()=>o(null)})})]})},Ke=()=>{const{projectId:s}=je();return e.jsx(ze,{editProjectId:s})};export{Ke as default};
