import{j as e,m as v}from"./ui-D_LkVF2r.js";import{u as W,r as h}from"./vendor-Vqvh67Lm.js";import{B as l}from"./Button-C3O7gUUW.js";import{a as V,d as A,i as O,I as d,b as E,s as H,S as B}from"./index-BpwwsN8i.js";import{S as L}from"./Slider-B58Hgk20.js";import{g as b,C as j}from"./GeminiService-CuSaiY5Y.js";import"./storage-BBQgdv-R.js";import"./ai-BpRkNtKl.js";const P=({checked:m,onChange:o,label:n,description:r,disabled:x=!1,size:u="md",className:N=""})=>{const y={sm:{track:"w-8 h-4",thumb:"w-3 h-3",translate:"translate-x-4"},md:{track:"w-11 h-6",thumb:"w-5 h-5",translate:"translate-x-5"},lg:{track:"w-14 h-7",thumb:"w-6 h-6",translate:"translate-x-7"}}[u];return e.jsxs("label",{className:`
        flex items-start gap-3 cursor-pointer
        ${x?"opacity-50 cursor-not-allowed":""}
        ${N}
      `,children:[e.jsx("button",{role:"switch","aria-checked":m,onClick:()=>!x&&o(!m),disabled:x,className:`
          relative inline-flex flex-shrink-0
          ${y.track}
          rounded-full transition-colors duration-200
          focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-900
          ${m?"bg-purple-600":"bg-gray-600"}
        `,children:e.jsx(v.span,{initial:!1,animate:{x:m?u==="sm"?16:u==="md"?20:28:0},transition:{type:"spring",stiffness:500,damping:30},className:`
            ${y.thumb}
            rounded-full bg-white shadow-lg
            absolute top-0.5 left-0.5
          `})}),(n||r)&&e.jsxs("div",{className:"flex flex-col",children:[n&&e.jsx("span",{className:"text-sm font-medium text-white",children:n}),r&&e.jsx("span",{className:"text-xs text-gray-400 mt-0.5",children:r})]})]})},Z=()=>{const m=W(),{settings:o,updateSettings:n}=V(),{user:r,isLoading:x,signInWithGoogle:u,signOut:N,initialize:w,checkConfiguration:y}=A(),[g,k]=h.useState(""),[C,a]=h.useState(null),[t,c]=h.useState({apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:""}),[z,F]=h.useState(!1),[S,f]=h.useState(!1),[p,I]=h.useState(!1);h.useEffect(()=>{const s=b.getApiKey();k(s||"••••••••••••••••••••••••••••••••••••••••"),F(O()),w();const i=localStorage.getItem("firebase_config");if(i)try{c(JSON.parse(i))}catch{}},[w]);const M=()=>{g.trim()?(b.setApiKey(g.trim()),a({message:"API 키가 저장되었습니다. 이제 AI 기능을 사용할 수 있습니다!",type:"success"})):a({message:"설정이 저장되었습니다",type:"success"})},K=()=>{if(!t.apiKey||!t.projectId){a({message:"API Key와 Project ID는 필수입니다.",type:"error"});return}H(t)?(F(!0),I(!1),y(),a({message:"Firebase 설정이 저장되었습니다.",type:"success"})):a({message:"Firebase 초기화에 실패했습니다. 설정을 확인해주세요.",type:"error"})},$=async()=>{await u(),A.getState().error?a({message:A.getState().error||"로그인 실패",type:"error"}):a({message:"로그인 성공!",type:"success"})},G=async()=>{await N(),a({message:"로그아웃되었습니다.",type:"success"})},D=async()=>{if(!r){a({message:"먼저 로그인해주세요.",type:"error"});return}f(!0);try{const i=await new B(r.uid).syncToCloud();i.errors.length>0?a({message:`${i.uploaded}개 업로드, ${i.errors.length}개 실패`,type:"error"}):a({message:`${i.uploaded}개 프로젝트가 클라우드에 저장되었습니다.`,type:"success"})}catch(s){a({message:s.message||"동기화 실패",type:"error"})}finally{f(!1)}},T=async()=>{if(!r){a({message:"먼저 로그인해주세요.",type:"error"});return}f(!0);try{const i=await new B(r.uid).syncFromCloud();i.errors.length>0?a({message:`${i.downloaded}개 다운로드, ${i.errors.length}개 실패`,type:"error"}):a({message:`${i.downloaded}개 프로젝트를 불러왔습니다. 페이지를 새로고침해주세요.`,type:"success"})}catch(s){a({message:s.message||"동기화 실패",type:"error"})}finally{f(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900/20 to-gray-900",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-3xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>m(-1),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"설정"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),"API 설정"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(d,{label:"Gemini API Key",type:"password",value:g,onChange:s=>k(s.target.value),placeholder:"AIza...",helperText:b.getApiKey()?"Google AI Studio (aistudio.google.com)에서 무료로 API 키를 발급받으세요":"✅ 기본 API 키 사용 중 (별도 설정 불필요)"}),e.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-400 font-medium mb-1",children:"API 키 발급 방법:"}),e.jsxs("ol",{className:"text-xs text-gray-400 list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Google AI Studio 접속 (aistudio.google.com)"}),e.jsx("li",{children:"Google 계정으로 로그인"}),e.jsx("li",{children:'"Get API Key" 클릭 후 키 생성'}),e.jsx("li",{children:"생성된 키를 위 입력란에 붙여넣기"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"API 키는 브라우저 로컬에만 저장되며 외부로 전송되지 않습니다."}),e.jsx(l,{variant:"primary",onClick:()=>{g.trim()&&!g.includes("•")?(b.setApiKey(g.trim()),a({message:"API 키가 저장되었습니다!",type:"success"})):a({message:"유효한 API 키를 입력해주세요.",type:"error"})},className:"mt-4",children:"API 키 저장"})]})]}),e.jsxs(j,{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-cyan-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})}),"클라우드 동기화"]}),z?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-700/50 rounded-lg",children:r?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r.photoURL&&e.jsx("img",{src:r.photoURL,alt:"Profile",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:r.displayName}),e.jsx("p",{className:"text-gray-400 text-sm",children:r.email})]})]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:G,children:"로그아웃"})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-400",children:"로그인하여 클라우드에 프로젝트를 저장하세요"}),e.jsx(l,{variant:"primary",size:"sm",onClick:$,disabled:x,loading:x,children:"Google 로그인"})]})}),r&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:D,disabled:S,className:"p-4 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors text-left disabled:opacity-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{className:"text-white font-medium",children:"클라우드에 업로드"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"로컬 프로젝트를 클라우드에 저장"})]}),e.jsxs("button",{onClick:T,disabled:S,className:"p-4 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors text-left disabled:opacity-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),e.jsx("span",{className:"text-white font-medium",children:"클라우드에서 가져오기"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"클라우드 프로젝트를 로컬로 복원"})]})]}),S&&e.jsxs("div",{className:"flex items-center justify-center gap-2 p-4",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-gray-400",children:"동기화 중..."})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-700",children:[e.jsxs("button",{onClick:()=>I(!p),className:"text-sm text-gray-500 hover:text-gray-400",children:["Firebase 설정 ",p?"닫기":"수정"]}),p&&e.jsxs(v.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4 space-y-3",children:[e.jsx(d,{label:"API Key",value:t.apiKey,onChange:s=>c({...t,apiKey:s.target.value})}),e.jsx(d,{label:"Project ID",value:t.projectId,onChange:s=>c({...t,projectId:s.target.value})}),e.jsx(l,{variant:"secondary",size:"sm",onClick:K,children:"설정 업데이트"})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg",children:[e.jsx("p",{className:"text-yellow-400 font-medium mb-2",children:"Firebase 설정 필요"}),e.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"클라우드 동기화를 사용하려면 Firebase 프로젝트가 필요합니다."}),e.jsx(l,{variant:"secondary",size:"sm",onClick:()=>I(!p),children:p?"Firebase 설정 닫기":"Firebase 설정하기"})]}),p&&e.jsxs(v.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg mb-4",children:[e.jsx("p",{className:"text-sm text-blue-400 font-medium mb-1",children:"Firebase 설정 방법:"}),e.jsxs("ol",{className:"text-xs text-gray-400 list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Firebase Console (console.firebase.google.com) 접속"}),e.jsx("li",{children:"새 프로젝트 생성 또는 기존 프로젝트 선택"}),e.jsx("li",{children:"프로젝트 설정 → 일반 → 내 앱에서 웹 앱 추가"}),e.jsx("li",{children:"firebaseConfig 값을 아래에 입력"}),e.jsx("li",{children:"Authentication에서 Google 로그인 활성화"}),e.jsx("li",{children:"Firestore Database 생성 (테스트 모드)"})]})]}),e.jsx(d,{label:"API Key",value:t.apiKey,onChange:s=>c({...t,apiKey:s.target.value}),placeholder:"AIzaSy..."}),e.jsx(d,{label:"Auth Domain",value:t.authDomain,onChange:s=>c({...t,authDomain:s.target.value}),placeholder:"your-app.firebaseapp.com"}),e.jsx(d,{label:"Project ID",value:t.projectId,onChange:s=>c({...t,projectId:s.target.value}),placeholder:"your-project-id"}),e.jsx(d,{label:"Storage Bucket",value:t.storageBucket,onChange:s=>c({...t,storageBucket:s.target.value}),placeholder:"your-app.appspot.com"}),e.jsx(d,{label:"Messaging Sender ID",value:t.messagingSenderId,onChange:s=>c({...t,messagingSenderId:s.target.value}),placeholder:"123456789"}),e.jsx(d,{label:"App ID",value:t.appId,onChange:s=>c({...t,appId:s.target.value}),placeholder:"1:123456789:web:abc123"}),e.jsx(l,{variant:"primary",onClick:K,children:"Firebase 설정 저장"})]})]})]}),e.jsxs(j,{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"비용 설정"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{label:"일일 비용 한도",value:o.dailyLimit,onChange:s=>n({dailyLimit:s}),min:1,max:20,step:.5,formatValue:s=>`$${s.toFixed(2)}`}),e.jsx(L,{label:"경고 임계값",value:o.warningThreshold*100,onChange:s=>n({warningThreshold:s/100}),min:50,max:95,step:5,formatValue:s=>`${s}%`})]})]}),e.jsxs(j,{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"최적화 설정"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(P,{label:"프로그레시브 이미지 생성",description:"저해상도 프리뷰를 먼저 생성하여 비용을 절감합니다",checked:o.enableProgressiveGeneration,onChange:s=>n({enableProgressiveGeneration:s})}),e.jsx(P,{label:"시맨틱 캐싱",description:"유사한 프롬프트의 결과를 캐싱하여 재사용합니다",checked:o.enableSemanticCache,onChange:s=>n({enableSemanticCache:s})}),e.jsx(P,{label:"배치 처리 우선",description:"여러 이미지를 한 번에 처리하여 효율을 높입니다",checked:o.preferBatchProcessing,onChange:s=>n({preferBatchProcessing:s})}),o.enableSemanticCache&&e.jsx(v.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},children:e.jsx(L,{label:"캐시 유사도 임계값",value:o.cacheThreshold*100,onChange:s=>n({cacheThreshold:s/100}),min:70,max:95,step:5,formatValue:s=>`${s}%`})})]})]}),e.jsxs(j,{children:[e.jsxs("h2",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),"데이터 관리"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"캐시 초기화"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"이미지와 텍스트 캐시를 모두 삭제합니다"})]}),e.jsx(l,{variant:"danger",size:"sm",children:"초기화"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"데이터 내보내기"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"모든 프로젝트를 JSON으로 내보냅니다"})]}),e.jsx(l,{variant:"secondary",size:"sm",children:"내보내기"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"데이터 가져오기"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"백업 파일에서 프로젝트를 복원합니다"})]}),e.jsx(l,{variant:"secondary",size:"sm",children:"가져오기"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(l,{variant:"ghost",onClick:()=>m(-1),children:"취소"}),e.jsx(l,{variant:"primary",onClick:M,children:"저장"})]})]}),C&&e.jsx(E,{message:C.message,type:C.type,onClose:()=>a(null)})]})})};export{Z as default};
