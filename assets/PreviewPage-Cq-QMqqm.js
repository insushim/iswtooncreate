import{j as e,A as g,m as j}from"./ui-D_LkVF2r.js";import{e as v,u as N,r as l}from"./vendor-Vqvh67Lm.js";import{B as x}from"./Button-C3O7gUUW.js";import{u as f,L as k}from"./index-D6VzHu7q.js";import"./storage-BBQgdv-R.js";const C=()=>{const{projectId:c,episodeId:m}=v(),h=N(),{currentProject:a,setCurrentProject:p}=f(),[u,b]=l.useState(!0),[n,o]=l.useState(0),[d,y]=l.useState(!1);if(l.useEffect(()=>{(async()=>{c&&(await p(c),b(!1))})()},[c,p]),l.useEffect(()=>{if(a&&m){const s=a.episodes.findIndex(i=>i.id===m);s>=0&&o(s)}},[a,m]),u)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx(k,{size:"lg"})});if(!a)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx(x,{variant:"primary",onClick:()=>h("/dashboard"),children:"ëŒ€ì‹œë³´ë“œë¡œ ì´ë™"})]})});const t=a.episodes[n];return e.jsxs("div",{className:`min-h-screen bg-gray-950 ${d?"fixed inset-0 z-50":""}`,children:[e.jsx("header",{className:"bg-gray-900/80 backdrop-blur-sm border-b border-gray-800 sticky top-0 z-10",children:e.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h(`/editor/${c}`),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white font-bold",children:a.title}),t&&e.jsxs("p",{className:"text-gray-400 text-sm",children:[t.episodeNumber,"í™” - ",t.title]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("select",{value:n,onChange:s=>o(Number(s.target.value)),className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white",children:a.episodes.map((s,i)=>e.jsxs("option",{value:i,children:[s.episodeNumber,"í™” - ",s.title]},s.id))}),e.jsx(x,{variant:"ghost",onClick:()=>y(!d),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:d?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V5H5v4h4zm6 0V5h4v4h-4zm-6 6v4H5v-4h4zm6 0v4h4v-4h-4z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4h4m8 0h4v4m0 8v4h-4m-8 0H4v-4"})}),children:d?"ë‚˜ê°€ê¸°":"ì „ì²´í™”ë©´"})]})]})}),e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-8",children:e.jsx(g,{mode:"wait",children:t?e.jsxs(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-1",children:[t.panels.sort((s,i)=>s.panelNumber-i.panelNumber).map((s,i)=>e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},className:"relative",children:[s.generatedImage?e.jsx("img",{src:s.generatedImage.imageData,alt:`Panel ${s.panelNumber}`,className:"w-full",loading:"lazy"}):e.jsx("div",{className:"w-full aspect-[3/4] bg-gray-800 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-4xl mb-2 block",children:"ğŸ¨"}),e.jsx("p",{className:"text-gray-400",children:"ì´ë¯¸ì§€ ìƒì„± í•„ìš”"}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["íŒ¨ë„ ",s.panelNumber]})]})}),s.dialogues.map(r=>e.jsx("div",{className:"absolute",style:{left:`${r.position.x}%`,top:`${r.position.y}%`,transform:"translate(-50%, -50%)"},children:e.jsx("div",{className:`
                            px-4 py-2 rounded-2xl max-w-xs
                            ${r.bubbleStyle==="thought"?"bg-white/80 rounded-full":"bg-white"}
                            ${r.bubbleStyle==="shout"?"border-2 border-red-500":""}
                          `,children:e.jsx("p",{className:`
                              text-gray-900
                              ${r.fontSize==="small"?"text-sm":r.fontSize==="large"?"text-lg":"text-base"}
                              ${r.bubbleStyle==="shout"?"font-bold":""}
                            `,children:r.text})})},r.id))]},s.id)),e.jsxs("div",{className:"py-12 text-center",children:[e.jsxs("p",{className:"text-gray-400 mb-4",children:["- ",t.episodeNumber,"í™” ë -"]}),t.endingHook&&e.jsx("p",{className:"text-purple-400 italic",children:t.endingHook}),e.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[e.jsx(x,{variant:"secondary",disabled:n===0,onClick:()=>o(n-1),children:"ì´ì „ í™”"}),e.jsx(x,{variant:"primary",disabled:n===a.episodes.length-1,onClick:()=>o(n+1),children:"ë‹¤ìŒ í™”"})]})]})]},t.id):e.jsxs("div",{className:"text-center py-20",children:[e.jsx("span",{className:"text-4xl mb-4 block",children:"ğŸ“š"}),e.jsx("p",{className:"text-gray-400",children:"ì—í”¼ì†Œë“œê°€ ì—†ìŠµë‹ˆë‹¤"})]})})})]})};export{C as default};
